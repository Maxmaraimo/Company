!function(){var e,t={9828:function(e,t,n){"use strict";var o=n(21796),i=n.n(o),r=n(76035),a=n(44679),s=n(98617),l=n(910);t.Z={mixins:[r.Z,a.Z,s.Z,l.Z],props:{theme:{type:String,default:""},url:{type:String,default:""},peaks:{type:String,default:""},duration:{type:Number,default:0},hasPlaybackTime:{type:Boolean,default:!0},height:{type:Number,default:null},place:{type:String,default:""},hasAutoplay:{type:[Boolean,String],default:!1}},data:function(){return{wavesurfer:null,peaksLocal:"",isPeaksReady:!1,isPlaying:!1,isLoading:!1,playbackTime:0,volumeValue:.8,volumeValueBeforeMuted:null,isControlVolumeHovered:!1,isVisible:!0}},computed:{loaderSelectors:function(){return["audio-wavesurfer__icon audio-wavesurfer__icon--loader",{"loading-spinner loading-spinner--no-filter":!this.theme}]},iconPlayPauseSrc:function(){var e="";return e+=this.isPlaying?"pause":"play",e+=this.theme?"-".concat(this.theme):"",this.cdnImageUrl("/icons/audio-".concat(e,".svg"))},totalDuration:function(){var e;if(this.duration)return this.millisecondsToTime(1e3*this.duration,!0);var t=null===(e=this.wavesurfer)||void 0===e?void 0:e.getDuration();return t?this.millisecondsToTime(1e3*t,!0):""}},created:function(){var e=this;this.$nextTick((function(){e.initWavesurfer()})),this.onBus("destroy-audio-wavesurfer",this.destroy),this.onBus("redraw-audio-wavesurfer-peaks",this.redrawPeaks),this.onBus("portfolio-stop-audio",this.portfolioStopAudio)},methods:{initWavesurfer:function(){var e=this;this.wavesurfer=i().create({container:this.$refs.wavesurfer,barGap:2,barMinHeight:2,barRadius:3,barWidth:2,cursorWidth:0,height:this.height||20,hideScrollbar:!0,progressColor:"#177DE5",responsive:!0,waveColor:"#FFF"}),this.wavesurfer.loaded=!1,this.peaks?this.drawPeaks(JSON.parse(this.peaks)):(this.wavesurfer.load(this.url),this.isLoading=!0),this.wavesurfer.setVolume(this.volumeValue),this.hasAutoplay&&this.playPause(),this.wavesurfer.on("ready",(function(){e.wavesurfer.loaded=!0,e.$emit("update-playback-ready-state",!0),e.wavesurfer.exportPCM(500,null,!0).then((function(t){e.drawPeaks(t)})),e.isLoading=!1})),this.wavesurfer.on("redraw",(function(){e.isVisible||(e.needPeaksRedraw=!0)})),this.wavesurfer.on("audioprocess",(function(t){e.playbackTime=e.millisecondsToTime(1e3*t,!0)})),this.wavesurfer.on("pause",(function(){e.isLoading=!1,e.isPlaying=!1,e.$emit("update-playback-state",!1)})),this.wavesurfer.on("play",(function(){e.isLoading&&(e.isLoading=!1),e.isPlaying=!0,window.bus.$emit("play-vue-audio"),window.bus.$emit("portfolio-stop-audio",e._uid)})),this.wavesurfer.on("error",(function(){setTimeout((function(){e.isLoading=!1}),200)})),this.wavesurfer.on("destroy",(function(){e.isLoading=!1,e.isPlaying=!1,e.wavesurfer=null}))},drawPeaks:function(e){this.wavesurfer.backend.peaks=e,this.wavesurfer.drawBuffer(),this.isPeaksReady=!0,this.peaksLocal=JSON.stringify(e)},playPause:function(){var e=this;this.isLoading||(this.wavesurfer.loaded||(this.wavesurfer.load(this.url,this.wavesurfer.backend.peaks),setTimeout((function(){e.isPlaying||(e.isLoading=!0)}),150)),this.wavesurfer.playPause(),this.$emit("update-playback-state",this.isPlaying))},setVolume:function(e){this.wavesurfer.setVolume(e)},onVolumeChange:function(e){this.setVolume(e.target.value),this.volumeValueBeforeMuted=null},toggleMute:function(){this.volumeValueBeforeMuted?(this.volumeValue=this.volumeValueBeforeMuted,this.setVolume(this.volumeValueBeforeMuted),this.volumeValueBeforeMuted=null):(this.volumeValueBeforeMuted=Math.round(100*this.wavesurfer.getVolume())/100,this.volumeValue=0,this.setVolume(0))},destroy:function(){var e;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")===this.place&&(null===(e=this.wavesurfer)||void 0===e||e.destroy())},pause:function(){var e,t=this;this.isLoading?this.wavesurfer.on("ready",(function(){t.wavesurfer.pause()})):this.isPlaying&&(null===(e=this.wavesurfer)||void 0===e||e.pause())},redrawPeaks:function(){this.wavesurfer&&(this.wavesurfer.drawer.containerWidth=this.wavesurfer.drawer.container.clientWidth,this.wavesurfer.drawBuffer(),this.$nextTick((function(){var e=document.querySelectorAll(".js-portfolio-view-audio");_.forOwn(e,(function(e){e.classList.remove("visibility-hidden")}))})))},setVisibilityState:function(e){var t=this.isVisible;this.isVisible=e,!t&&e&&this.needPeaksRedraw&&(this.needPeaksRedraw=!1,this.redrawPeaks())},portfolioStopAudio:function(e){var t;e!==this._uid&&(null===(t=this.wavesurfer)||void 0===t||t.pause())}}}},86458:function(e,t){"use strict";t.Z={props:{mode:{type:String,default:""}}}},36838:function(e,t,n){"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function r(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}n.r(t),n.d(t,{default:function(){return a}});var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rangyRe=new RegExp('<span id="selectionBoundary_\\d+_\\d+" class="rangySelectionBoundary".*?>[^<>]+?</span>',"gi"),this.keepedSelection,this.$element,this.html="",this.area=void 0}var t,n,o;return t=e,(n=[{key:"focusCaret",value:function(e){var t;void 0!==e&&(t=(null==e?void 0:e.length)>0?e:$(e));var n=t.siblings(".trumbowyg-editor")[0],o=window.getSelection(),i=document.createRange();i.setStart(n,n.childElementCount),i.setEnd(n,n.childElementCount),o.removeAllRanges(),o.addRange(i)}},{key:"beginEdit",value:function(){var e=null;try{e=rangySelectionSaveRestore.saveSelection(),this.keepedSelection=e}catch(e){}return e}},{key:"getHtml",value:function(e){this.$element=e;var t=e.siblings(".trumbowyg-editor")[0];this.area=$(t),this.html=this.area.html();var n=this.replaceRangyTags(this.html);return this.html=n.html,this.html=this.html.replace(/[\x00-\x1F\x7F-\x9F\uFEFF]/g,""),this.html=this.restoreRangyTags(this.html,n.boundaries),this.html}},{key:"endEdit",value:function(e){e!==this.html&&this.area.html(e),this.keepedSelection&&(this.restoreCaret(this.keepedSelection),this.html=this.area.html(),this.$element.val(this.html))}},{key:"restoreCaret",value:function(e){try{rangySelectionSaveRestore.restoreSelection(e)}catch(e){}}},{key:"replaceRangyTags",value:function(e){var t=e,n={};return{html:t=t.replace(this.rangyRe,(function(e,t){return n[t]=e,"##boundary_".concat(t,"##")})),boundaries:n}}},{key:"restoreRangyTags",value:function(e,t){return e.replace(/##boundary_([^#]+)##/gi,(function(e,n){return n in t?t[n]:""}))}},{key:"replaceLastHtml",value:function(e,t,n){var o=e,i=this.rangyRe.exec(o),r=o.replace(this.rangyRe,"");return r=window.emojiReplacements.preSubmitMessage(r),n&&r.trim().length>n&&(o=i?t.replace(this.rangyRe,i[0]):t.replace(this.rangyRe,"")),o}},{key:"focusCaretToEnd",value:function(e){this.focusCaret(e),this.beginEdit();var t,n=e.siblings(".trumbowyg-editor"),o=n.find(".rangySelectionBoundary");n.find("div:last").length?/br[^>]?\>$/.test(n.find("div:last").html())?n.find("div:last").find("br:last").before(o):n.find("div:last").append(o):n.append(o),t=this.getHtml(e),this.endEdit(t)}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.trumbowygCaret=new a},82780:function(e,t,n){var o,i;function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}o=function(){var e="object",t="function",n="undefined",o=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],i=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],a=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],s=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function l(n,o){var i=r(n[o]);return i==t||!(i!=e||!n[o])||"unknown"==i}function u(t,n){return!(r(t[n])!=e||!t[n])}function c(e,t){return r(e[t])!=n}function d(e){return function(t,n){for(var o=n.length;o--;)if(!e(t,n[o]))return!1;return!0}}var f=d(l),h=d(u),p=d(c);function m(e){return e&&f(e,s)&&p(e,a)}function v(e){return u(e,"body")?e.body:e.getElementsByTagName("body")[0]}var g,y,b=[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,o=e.length;n<o;++n)t(e[n],n)},w={},k=("undefined"==typeof window?"undefined":r(window))!=n&&("undefined"==typeof document?"undefined":r(document))!=n,C={isHostMethod:l,isHostObject:u,isHostProperty:c,areHostMethods:f,areHostObjects:h,areHostProperties:p,isTextRange:m,getBody:v,forEach:b},E={version:"1.3.0",initialized:!1,isBrowser:k,supported:!0,util:C,features:{},modules:w,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:("undefined"==typeof rangyAutoInitialize?"undefined":r(rangyAutoInitialize))==n||rangyAutoInitialize}};function O(e){("undefined"==typeof console?"undefined":r(console))!=n&&l(console,"log")&&console.log(e)}function T(e,t){k&&t?alert(e):O(e)}function P(e){E.initialized=!0,E.supported=!1,T("Rangy is not supported in this environment. Reason: "+e,E.config.alertOnFail)}function _(e){T("Rangy warning: "+e,E.config.alertOnWarn)}E.fail=P,E.warn=_,{}.hasOwnProperty?(C.extend=g=function(e,t,n){var o,i;for(var a in t)t.hasOwnProperty(a)&&(o=e[a],i=t[a],n&&null!==o&&"object"==r(o)&&null!==i&&"object"==r(i)&&g(o,i,!0),e[a]=i);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},C.createOptions=function(e,t){var n={};return g(n,t),e&&g(n,e),n}):P("hasOwnProperty not supported"),k||P("Rangy can only run in a browser"),function(){var e;if(k){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(e){}}e||(e=function(e){for(var t=[],n=0,o=e.length;n<o;++n)t[n]=e[n];return t}),C.toArray=e}(),k&&(l(document,"addEventListener")?y=function(e,t,n){e.addEventListener(t,n,!1)}:l(document,"attachEvent")?y=function(e,t,n){e.attachEvent("on"+t,n)}:P("Document does not have required addEventListener or attachEvent method"),C.addListener=y);var R=[];function S(e){return e.message||e.description||String(e)}function A(){if(k&&!E.initialized){var e,t=!1,n=!1;l(document,"createRange")&&(e=document.createRange(),f(e,i)&&p(e,o)&&(t=!0));var r=v(document);if(r&&"body"==r.nodeName.toLowerCase())if(r&&l(r,"createTextRange")&&m(e=r.createTextRange())&&(n=!0),t||n){var a;for(var s in E.initialized=!0,E.features={implementsDomRange:t,implementsTextRange:n},w)(a=w[s])instanceof N&&a.init(a,E);for(var u=0,c=R.length;u<c;++u)try{R[u](E)}catch(e){O("Rangy init listener threw an exception. Continuing. Detail: "+S(e))}}else P("Neither Range nor TextRange are available");else P("No body element found")}}function x(e,t,n){n&&(e+=" in module "+n.name),E.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function I(e,t,n,o){e[t]=function(){return x(t,n,o),e[n].apply(e,C.toArray(arguments))}}C.deprecationNotice=x,C.createAliasForDeprecatedMethod=I,E.init=A,E.addInitListener=function(e){E.initialized?e(E):R.push(e)};var D=[];function M(e){e=e||window,A();for(var t=0,n=D.length;t<n;++t)D[t](e)}function N(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function L(e,t,n){var o=new N(e,t,(function(t){if(!t.initialized){t.initialized=!0;try{n(E,t),t.supported=!0}catch(t){O("Module '"+e+"' failed to load: "+S(t)),t.stack&&O(t.stack)}}}));return w[e]=o,o}function j(){}function V(){}E.addShimListener=function(e){D.push(e)},k&&(E.shim=E.createMissingNativeApi=M,I(E,"createMissingNativeApi","shim")),N.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,i=n.length;o<i;++o){if(t=n[o],!((e=w[t])&&e instanceof N))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error(e)},warn:function(e){E.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){E.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},E.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var o=L(e,n,t);E.initialized&&E.supported&&o.init()},E.createCoreModule=function(e,t,n){L(e,t,n)},E.RangePrototype=j,E.rangePrototype=new j,E.selectionPrototype=new V,E.createCoreModule("DomUtil",[],(function(e,t){var n="undefined",o=e.util,i=o.getBody;o.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),o.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var a=document.createElement("div");o.areHostMethods(a,["insertBefore","appendChild","cloneNode"]||0)||t.fail("Incomplete Element implementation"),o.isHostProperty(a,"innerHTML")||t.fail("Element is missing innerHTML property");var s=document.createTextNode("test");o.areHostMethods(s,["splitText","deleteData","insertData","appendData","cloneNode"]||0)||t.fail("Incomplete Text Node implementation");var l=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};function u(e){var t;return r(e.namespaceURI)==n||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function c(e){var t=e.parentNode;return 1==t.nodeType?t:null}function d(e){for(var t=0;e=e.previousSibling;)++t;return t}function f(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function h(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(l(o,n))return n;return null}function p(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function m(e,t){return p(e,t,!0)}function v(e,t,n){for(var o,i=n?e:e.parentNode;i;){if((o=i.parentNode)===t)return i;i=o}return null}function g(e){var t=e.nodeType;return 3==t||4==t||8==t}function y(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function b(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function w(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),b(o,e),n)for(var i,r=0;i=n[r++];)i.node==e&&i.offset>t?(i.node=o,i.offset-=t):i.node==e.parentNode&&i.offset>d(e)&&++i.offset;return o}function k(e){if(9==e.nodeType)return e;if(r(e.ownerDocument)!=n)return e.ownerDocument;if(r(e.document)!=n)return e.document;if(e.parentNode)return k(e.parentNode);throw t.createError("getDocument: no document found for node")}function C(e){var o=k(e);if(r(o.defaultView)!=n)return o.defaultView;if(r(o.parentWindow)!=n)return o.parentWindow;throw t.createError("Cannot get a window object for node")}function E(e){if(r(e.contentDocument)!=n)return e.contentDocument;if(r(e.contentWindow)!=n)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function O(e){if(r(e.contentWindow)!=n)return e.contentWindow;if(r(e.contentDocument)!=n)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function T(e){return e&&o.isHostMethod(e,"setTimeout")&&o.isHostObject(e,"document")}function P(e,t,n){var i;if(e?o.isHostProperty(e,"nodeType")?i=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?E(e):k(e):T(e)&&(i=e.document):i=document,!i)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return i}function _(e){for(var t;t=e.parentNode;)e=t;return e}function R(e,n,o,i){var r,a,s,l,u;if(e==o)return n===i?0:n<i?-1:1;if(r=v(o,e,!0))return n<=d(r)?-1:1;if(r=v(e,o,!0))return d(r)<i?-1:1;if(!(a=h(e,o)))throw new Error("comparePoints error: nodes have no common ancestor");if((s=e===a?a:v(e,a,!0))===(l=o===a?a:v(o,a,!0)))throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(u=a.firstChild;u;){if(u===s)return-1;if(u===l)return 1;u=u.nextSibling}}var S,A=!1;function x(e){try{return e.parentNode,!1}catch(e){return!0}}function I(e){if(!e)return"[No node]";if(A&&x(e))return"[Broken node]";if(g(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+d(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function D(e){for(var t,n=k(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function M(e,t,n){var o=i(e),r=e.createElement("div");r.contentEditable=""+!!n,t&&(r.innerHTML=t);var a=o.firstChild;return a?o.insertBefore(r,a):o.appendChild(r),r}function N(e){return e.parentNode.removeChild(e)}function L(e){this.root=e,this._next=e}function j(e){return new L(e)}function V(e,t){this.node=e,this.offset=t}function B(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br />",A=x(n),e.features.crashyTextNodes=A}(),r(window.getComputedStyle)!=n?S=function(e,t){return C(e).getComputedStyle(e,null)[t]}:r(document.documentElement.currentStyle)!=n?S=function(e,t){return e.currentStyle?e.currentStyle[t]:""}:t.fail("No means of obtaining computed style properties found"),L.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},V.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+I(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},B.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},B.prototype.toString=function(){return this.message},e.dom={arrayContains:l,isHtmlNamespace:u,parentElement:c,getNodeIndex:d,getNodeLength:f,getCommonAncestor:h,isAncestorOf:p,isOrIsAncestorOf:m,getClosestAncestorIn:v,isCharacterDataNode:g,isTextOrCommentNode:y,insertAfter:b,splitDataNode:w,getDocument:k,getWindow:C,getIframeWindow:O,getIframeDocument:E,getBody:i,isWindow:T,getContentDocument:P,getRootContainer:_,comparePoints:R,isBrokenNode:x,inspectNode:I,getComputedStyleProperty:S,createTestElement:M,removeNode:N,fragmentFromNodeChildren:D,createIterator:j,DomPosition:V},e.DOMException=B})),E.createCoreModule("DomRange",["DomUtil"],(function(e,t){var n=e.dom,o=e.util,i=n.DomPosition,r=e.DOMException,a=n.isCharacterDataNode,s=n.getNodeIndex,l=n.isOrIsAncestorOf,u=n.getDocument,c=n.comparePoints,d=n.splitDataNode,f=n.getClosestAncestorIn,h=n.getNodeLength,p=n.arrayContains,m=n.getRootContainer,v=e.features.crashyTextNodes,g=n.removeNode;function y(e,t){return 3!=e.nodeType&&(l(e,t.startContainer)||l(e,t.endContainer))}function b(e){return e.document||u(e.startContainer)}function w(e){return m(e.startContainer)}function k(e){return new i(e.parentNode,s(e))}function C(e){return new i(e.parentNode,s(e)+1)}function E(e,t,o){var i=11==e.nodeType?e.firstChild:e;return a(t)?o==t.length?n.insertAfter(e,t):t.parentNode.insertBefore(e,0==o?t:d(t,o)):o>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[o]),i}function O(e,t,n){if(Z(e),Z(t),b(t)!=b(e))throw new r("WRONG_DOCUMENT_ERR");var o=c(e.startContainer,e.startOffset,t.endContainer,t.endOffset),i=c(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?o<=0&&i>=0:o<0&&i>0}function T(e){for(var t,n,o,i=b(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(o=e.getSubtreeIterator(),n.appendChild(T(o)),o.detach()),10==n.nodeType)throw new r("HIERARCHY_REQUEST_ERR");i.appendChild(n)}return i}function P(e,t,o){var i,r,a,s;for(o=o||{stop:!1};a=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(a))return void(o.stop=!0);if(P(s=e.getSubtreeIterator(),t,o),s.detach(),o.stop)return}else for(i=n.createIterator(a);r=i.next();)if(!1===t(r))return void(o.stop=!0)}function _(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(_(t=e.getSubtreeIterator()),t.detach()):e.remove()}function R(e){for(var t,n,o=b(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(R(n)),n.detach()):e.remove(),10==t.nodeType)throw new r("HIERARCHY_REQUEST_ERR");o.appendChild(t)}return o}function S(e,t,n){var o,i=!(!t||!t.length),r=!!n;i&&(o=new RegExp("^("+t.join("|")+")$"));var s=[];return P(new x(e,!1),(function(t){if((!i||o.test(t.nodeType))&&(!r||n(t))){var l=e.startContainer;if(t!=l||!a(l)||e.startOffset!=l.length){var u=e.endContainer;t==u&&a(u)&&0==e.endOffset||s.push(t)}}})),s}function A(e){return"["+(void 0===e.getName?"Range":e.getName())+"("+n.inspectNode(e.startContainer)+":"+e.startOffset+", "+n.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function x(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&a(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||a(this.sc)?f(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||a(this.ec)?f(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}x.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,a(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!a(n)||n!==this.sc&&n!==this.ec?n.parentNode&&g(n):(e=n===this.sc?this.so:0)!=(t=n===this.ec?this.eo:n.length)&&n.deleteData(e,t-e)},isPartiallySelectedSubtree:function(){return y(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)(e=this.range.cloneRange()).collapse(!1);else{e=new ve(b(this.range));var t=this._current,n=t,o=0,i=t,r=h(t);l(t,this.sc)&&(n=this.sc,o=this.so),l(t,this.ec)&&(i=this.ec,r=this.eo),me(e,n,o,i,r)}return new x(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var I=[1,3,4,5,7,8,10],D=[2,9,11],M=[5,6,10,12],N=[1,3,4,5,7,8,10,11],L=[1,3,4,5,7,8];function j(e){return function(t,n){for(var o,i=n?t:t.parentNode;i;){if(o=i.nodeType,p(e,o))return i;i=i.parentNode}return null}}var V=j([9,11]),B=j(M),F=j([6,10,12]);function U(e,t){if(F(e,t))throw new r("INVALID_NODE_TYPE_ERR")}function H(e,t){if(!p(t,e.nodeType))throw new r("INVALID_NODE_TYPE_ERR")}function W(e,t){if(t<0||t>(a(e)?e.length:e.childNodes.length))throw new r("INDEX_SIZE_ERR")}function $(e,t){if(V(e,!0)!==V(t,!0))throw new r("WRONG_DOCUMENT_ERR")}function z(e){if(B(e,!0))throw new r("NO_MODIFICATION_ALLOWED_ERR")}function Y(e,t){if(!e)throw new r(t)}function q(e,t){return t<=(a(e)?e.length:e.childNodes.length)}function G(e){return!!e.startContainer&&!!e.endContainer&&!(v&&(n.isBrokenNode(e.startContainer)||n.isBrokenNode(e.endContainer)))&&m(e.startContainer)==m(e.endContainer)&&q(e.startContainer,e.startOffset)&&q(e.endContainer,e.endOffset)}function Z(e){if(!G(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}var J=document.createElement("style"),K=!1;try{J.innerHTML="<b>x</b>",K=3==J.firstChild.nodeType}catch(e){}e.features.htmlParsingConforms=K;var X=K?function(e){var t=this.startContainer,o=u(t);if(!t)throw new r("INVALID_STATE_ERR");var i=null;return 1==t.nodeType?i=t:a(t)&&(i=n.parentElement(t)),(i=null===i||"HTML"==i.nodeName&&n.isHtmlNamespace(u(i).documentElement)&&n.isHtmlNamespace(i)?o.createElement("body"):i.cloneNode(!1)).innerHTML=e,n.fragmentFromNodeChildren(i)}:function(e){var t=b(this).createElement("body");return t.innerHTML=e,n.fragmentFromNodeChildren(t)};function Q(e,t){Z(e);var n=e.startContainer,o=e.startOffset,i=e.endContainer,r=e.endOffset,l=n===i;a(i)&&r>0&&r<i.length&&d(i,r,t),a(n)&&o>0&&o<n.length&&(n=d(n,o,t),l?(r-=o,i=n):i==n.parentNode&&r>=s(n)&&r++,o=0),e.setStartAndEnd(n,o,i,r)}function ee(e){Z(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}var te=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ne=0,oe=1,ie=2,re=3,ae=0,se=1,le=2,ue=3;function ce(e){e.START_TO_START=ne,e.START_TO_END=oe,e.END_TO_END=ie,e.END_TO_START=re,e.NODE_BEFORE=ae,e.NODE_AFTER=se,e.NODE_BEFORE_AND_AFTER=le,e.NODE_INSIDE=ue}function de(e){ce(e),ce(e.prototype)}function fe(e,t){return function(){Z(this);var n,o=this.startContainer,i=this.startOffset,r=this.commonAncestorContainer,a=new x(this,!0);o!==r&&(o=(n=C(f(o,r,!0))).node,i=n.offset),P(a,z),a.reset();var s=e(a);return a.detach(),t(this,o,i,o,i),s}}function he(t,n){function i(e,t){return function(n){H(n,I),H(m(n),D);var o=(e?k:C)(n);(t?r:l)(this,o.node,o.offset)}}function r(e,t,o){var i=e.endContainer,r=e.endOffset;t===e.startContainer&&o===e.startOffset||(m(t)==m(i)&&1!=c(t,o,i,r)||(i=t,r=o),n(e,t,o,i,r))}function l(e,t,o){var i=e.startContainer,r=e.startOffset;t===e.endContainer&&o===e.endOffset||(m(t)==m(i)&&-1!=c(t,o,i,r)||(i=t,r=o),n(e,i,r,t,o))}var u=function(){};u.prototype=e.rangePrototype,t.prototype=new u,o.extend(t.prototype,{setStart:function(e,t){U(e,!0),W(e,t),r(this,e,t)},setEnd:function(e,t){U(e,!0),W(e,t),l(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],o=e[1],i=t,r=o;switch(e.length){case 3:r=e[2];break;case 4:i=e[2],r=e[3]}n(this,t,o,i,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:i(!0,!0),setStartAfter:i(!1,!0),setEndBefore:i(!0,!1),setEndAfter:i(!1,!1),collapse:function(e){Z(this),e?n(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):n(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){U(e,!0),n(this,e,0,e,h(e))},selectNode:function(e){U(e,!1),H(e,I);var t=k(e),o=C(e);n(this,t.node,t.offset,o.node,o.offset)},extractContents:fe(R,n),deleteContents:fe(_,n),canSurroundContents:function(){Z(this),z(this.startContainer),z(this.endContainer);var e=new x(this,!0),t=e._first&&y(e._first,this)||e._last&&y(e._last,this);return e.detach(),!t},splitBoundaries:function(){Q(this)},splitBoundariesPreservingPositions:function(e){Q(this,e)},normalizeBoundaries:function(){Z(this);var e,t=this.startContainer,o=this.startOffset,i=this.endContainer,r=this.endOffset,l=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(i=e,r=e.length,e.appendData(t.data),g(t))},u=function(e){var n=e.previousSibling;if(n&&n.nodeType==e.nodeType){t=e;var a=e.length;if(o=n.length,e.insertData(0,n.data),g(n),t==i)r+=o,i=t;else if(i==e.parentNode){var l=s(e);r==l?(i=e,r=a):r>l&&r--}}},c=!0;if(a(i))r==i.length?l(i):0==r&&(e=i.previousSibling)&&e.nodeType==i.nodeType&&(r=e.length,t==i&&(c=!1),e.appendData(i.data),g(i),i=e);else{if(r>0){var d=i.childNodes[r-1];d&&a(d)&&l(d)}c=!this.collapsed}if(c){if(a(t))0==o?u(t):o==t.length&&(e=t.nextSibling)&&e.nodeType==t.nodeType&&(i==e&&(i=t,r+=t.length),t.appendData(e.data),g(e));else if(o<t.childNodes.length){var f=t.childNodes[o];f&&a(f)&&u(f)}}else t=i,o=r;n(this,t,o,i,r)},collapseToPoint:function(e,t){U(e,!0),W(e,t),this.setStartAndEnd(e,t)}}),de(t)}function pe(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:n.getCommonAncestor(e.startContainer,e.endContainer)}function me(e,t,o,i,r){e.startContainer=t,e.startOffset=o,e.endContainer=i,e.endOffset=r,e.document=n.getDocument(t),pe(e)}function ve(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,pe(this)}o.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){var n,o,i,r;Z(this),$(this.startContainer,t.startContainer);var a=e==re||e==ne?"start":"end",s=e==oe||e==ne?"start":"end";return n=this[a+"Container"],o=this[a+"Offset"],i=t[s+"Container"],r=t[s+"Offset"],c(n,o,i,r)},insertNode:function(e){if(Z(this),H(e,N),z(this.startContainer),l(e,this.startContainer))throw new r("HIERARCHY_REQUEST_ERR");var t=E(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){var e,t;if(Z(this),this.collapsed)return b(this).createDocumentFragment();if(this.startContainer===this.endContainer&&a(this.startContainer))return(e=this.startContainer.cloneNode(!0)).data=e.data.slice(this.startOffset,this.endOffset),(t=b(this).createDocumentFragment()).appendChild(e),t;var n=new x(this,!0);return e=T(n),n.detach(),e},canSurroundContents:function(){Z(this),z(this.startContainer),z(this.endContainer);var e=new x(this,!0),t=e._first&&y(e._first,this)||e._last&&y(e._last,this);return e.detach(),!t},surroundContents:function(e){if(H(e,L),!this.canSurroundContents())throw new r("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);E(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){Z(this);for(var e,t=new ve(b(this)),n=te.length;n--;)t[e=te[n]]=this[e];return t},toString:function(){Z(this);var e=this.startContainer;if(e===this.endContainer&&a(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new x(this,!0);return P(n,(function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)})),n.detach(),t.join("")},compareNode:function(e){Z(this);var t=e.parentNode,n=s(e);if(!t)throw new r("NOT_FOUND_ERR");var o=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return o<0?i>0?le:ae:i>0?se:ue},comparePoint:function(e,t){return Z(this),Y(e,"HIERARCHY_REQUEST_ERR"),$(e,this.startContainer),c(e,t,this.startContainer,this.startOffset)<0?-1:c(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:X,toHtml:function(){return ee(this)},intersectsNode:function(e,t){if(Z(this),m(e)!=w(this))return!1;var n=e.parentNode,o=s(e);if(!n)return!0;var i=c(n,o,this.endContainer,this.endOffset),r=c(n,o+1,this.startContainer,this.startOffset);return t?i<=0&&r>=0:i<0&&r>0},isPointInRange:function(e,t){return Z(this),Y(e,"HIERARCHY_REQUEST_ERR"),$(e,this.startContainer),c(e,t,this.startContainer,this.startOffset)>=0&&c(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return O(this,e,!1)},intersectsOrTouchesRange:function(e){return O(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=c(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=c(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==c(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==c(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new r("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ue},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,h(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return Z(this),S(this,e,t)},getDocument:function(){return b(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var o=b(this),i=e.createRange(o);t=t||n.getBody(o),i.selectNodeContents(t);var r=this.intersection(i),a=0,s=0;return r&&(i.setEnd(r.startContainer,r.startOffset),s=(a=i.toString().length)+r.toString().length),{start:a,end:s,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,i,r,a,s=[t],l=!1,u=!1;!u&&(o=s.pop());)if(3==o.nodeType)i=n+o.length,!l&&e.start>=n&&e.start<=i&&(this.setStart(o,e.start-n),l=!0),l&&e.end>=n&&e.end<=i&&(this.setEnd(o,e.end-n),u=!0),n=i;else for(r=(a=o.childNodes).length;r--;)s.push(a[r])},getName:function(){return"DomRange"},equals:function(e){return ve.rangesEqual(this,e)},isValid:function(){return G(this)},inspect:function(){return A(this)},detach:function(){}}),he(ve,me),o.extend(ve,{rangeProperties:te,RangeIterator:x,copyComparisonConstants:de,createPrototypeRange:he,inspect:A,toHtml:ee,getRangeDocument:b,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=ve})),E.createCoreModule("WrappedRange",["DomRange"],(function(e,t){var n,o,i=e.dom,r=e.util,a=i.DomPosition,s=e.DomRange,l=i.getBody,u=i.getContentDocument,c=i.isCharacterDataNode;if(e.features.implementsDomRange&&function(){var o,a,c=s.rangeProperties;function d(e){for(var t,n=c.length;n--;)e[t=c[n]]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function f(e,t,n,o,i){var r=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==o||e.endOffset!=i,s=!e.equals(e.nativeRange);(r||a||s)&&(e.setEnd(o,i),e.setStart(t,n))}n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,d(this)},s.createPrototypeRange(n,f),(o=n.prototype).selectNode=function(e){this.nativeRange.selectNode(e),d(this)},o.cloneContents=function(){return this.nativeRange.cloneContents()},o.surroundContents=function(e){this.nativeRange.surroundContents(e),d(this)},o.collapse=function(e){this.nativeRange.collapse(e),d(this)},o.cloneRange=function(){return new n(this.nativeRange.cloneRange())},o.refresh=function(){d(this)},o.toString=function(){return this.nativeRange.toString()};var h=document.createTextNode("test");l(document).appendChild(h);var p=document.createRange();p.setStart(h,0),p.setEnd(h,0);try{p.setStart(h,1),o.setStart=function(e,t){this.nativeRange.setStart(e,t),d(this)},o.setEnd=function(e,t){this.nativeRange.setEnd(e,t),d(this)},a=function(e){return function(t){this.nativeRange[e](t),d(this)}}}catch(e){o.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}d(this)},o.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}d(this)},a=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(o){this.nativeRange[t](n),this.nativeRange[e](n)}d(this)}}}o.setStartBefore=a("setStartBefore","setEndBefore"),o.setStartAfter=a("setStartAfter","setEndAfter"),o.setEndBefore=a("setEndBefore","setStartBefore"),o.setEndAfter=a("setEndAfter","setStartAfter"),o.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},p.selectNodeContents(h),p.setEnd(h,3);var m=document.createRange();m.selectNodeContents(h),m.setEnd(h,4),m.setStart(h,2),-1==p.compareBoundaryPoints(p.START_TO_END,m)&&1==p.compareBoundaryPoints(p.END_TO_START,m)?o.compareBoundaryPoints=function(e,t){return e==(t=t.nativeRange||t).START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:o.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var v=document.createElement("div");v.innerHTML="123";var g=v.firstChild,y=l(document);y.appendChild(v),p.setStart(g,1),p.setEnd(g,2),p.deleteContents(),"13"==g.data&&(o.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},o.extractContents=function(){var e=this.nativeRange.extractContents();return d(this),e}),y.removeChild(v),y=null,r.isHostMethod(p,"createContextualFragment")&&(o.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(h),o.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return(e=u(e,t,"createNativeRange")).createRange()}}(),e.features.implementsTextRange){var d=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();(n=e.duplicate()).collapse(!1);var r=n.parentElement(),a=o==r?o:i.getCommonAncestor(o,r);return a==t?a:i.getCommonAncestor(t,a)},f=function(e){return 0==e.compareEndPoints("StartToEnd",e)},h=function(e,t,n,o,r){var s=e.duplicate();s.collapse(n);var l=s.parentElement();if(i.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var u=new a(l.parentNode,i.getNodeIndex(l));return{boundaryPosition:u,nodeInfo:{nodeIndex:u.offset,containerElement:u.node}}}var d=i.getDocument(l).createElement("span");d.parentNode&&i.removeNode(d);for(var f,h,p,m,v,g=n?"StartToStart":"StartToEnd",y=r&&r.containerElement==l?r.nodeIndex:0,b=l.childNodes.length,w=b,k=w;k==b?l.appendChild(d):l.insertBefore(d,l.childNodes[k]),s.moveToElementText(d),0!=(f=s.compareEndPoints(g,e))&&y!=w;){if(-1==f){if(w==y+1)break;y=k}else w=w==y+1?y:k;k=Math.floor((y+w)/2),l.removeChild(d)}if(v=d.nextSibling,-1==f&&v&&c(v)){var C;if(s.setEndPoint(n?"EndToStart":"EndToEnd",e),/[\r\n]/.test(v.data)){var E=s.duplicate(),O=E.text.replace(/\r\n/g,"\r").length;for(C=E.moveStart("character",O);-1==(f=E.compareEndPoints("StartToEnd",E));)C++,E.moveStart("character",1)}else C=s.text.length;m=new a(v,C)}else h=(o||!n)&&d.previousSibling,m=(p=(o||n)&&d.nextSibling)&&c(p)?new a(p,0):h&&c(h)?new a(h,h.data.length):new a(l,i.getNodeIndex(d));return i.removeNode(d),{boundaryPosition:m,nodeInfo:{nodeIndex:k,containerElement:l}}},p=function(e,t){var n,o,r,a,s=e.offset,u=i.getDocument(e.node),d=l(u).createTextRange(),f=c(e.node);return f?o=(n=e.node).parentNode:(n=s<(a=e.node.childNodes).length?a[s]:null,o=e.node),(r=u.createElement("span")).innerHTML="&#feff;",n?o.insertBefore(r,n):o.appendChild(r),d.moveToElementText(r),d.collapse(!t),o.removeChild(r),f&&d[t?"moveStart":"moveEnd"]("character",s),d};(o=function(e){this.textRange=e,this.refresh()}).prototype=new s(document),o.prototype.refresh=function(){var e,t,n,o=d(this.textRange);f(this.textRange)?t=e=h(this.textRange,o,!0,!0).boundaryPosition:(e=(n=h(this.textRange,o,!0,!1)).boundaryPosition,t=h(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},o.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(o);var m=function(e){if(e.collapsed)return p(new a(e.startContainer,e.startOffset),!0);var t=p(new a(e.startContainer,e.startOffset),!0),n=p(new a(e.endContainer,e.endOffset),!1),o=l(s.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o};if(o.rangeToTextRange=m,o.prototype.toTextRange=function(){return m(this)},e.WrappedTextRange=o,!e.features.implementsDomRange||e.config.preferTextRange){var v=Function("return this;")();void 0===v.Range&&(v.Range=o),e.createNativeRange=function(e){return e=u(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=o}}e.createRange=function(n){return n=u(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=u(e,t,"createRangyRange"),new s(e)},r.createAliasForDeprecatedMethod(e,"createIframeRange","createRange"),r.createAliasForDeprecatedMethod(e,"createIframeRangyRange","createRangyRange"),e.addShimListener((function(t){var n=t.document;void 0===n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null}))})),E.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],(function(e,t){e.config.checkSelectionRanges=!0;var n,o,i="boolean",a="number",s=e.dom,l=e.util,u=l.isHostMethod,c=e.DomRange,d=e.WrappedRange,f=e.DOMException,h=s.DomPosition,p=e.features,m="Control",v=s.getDocument,g=s.getBody,y=c.rangesEqual;function b(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function w(e,n){if(e){if(s.isWindow(e))return e;if(e instanceof Z)return e.win;var o=s.getContentDocument(e,t,n);return s.getWindow(o)}return window}function k(e){return w(e,"getWinSelection").getSelection()}function C(e){return w(e,"getDocSelection").document.selection}function E(e){var t=!1;return e.anchorNode&&(t=1==s.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}var O=u(window,"getSelection"),T=l.isHostObject(document,"selection");p.implementsWinGetSelection=O,p.implementsDocSelection=T;var P=T&&(!O||e.config.preferTextRange);if(P)n=C,e.isSelectionValid=function(e){var t=w(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||v(n.createRange().parentElement())==t};else{if(!O)return t.fail("Neither document.selection or window.getSelection() detected."),!1;n=k,e.isSelectionValid=function(){return!0}}e.getNativeSelection=n;var _=n();if(!_)return t.fail("Native selection was null (possibly issue 138?)"),!1;var R=e.createNativeRange(document),S=g(document),A=l.areHostProperties(_,["anchorNode","focusNode","anchorOffset","focusOffset"]);p.selectionHasAnchorAndFocus=A;var x=u(_,"extend");p.selectionHasExtend=x;var I=r(_.rangeCount)==a;p.selectionHasRangeCount=I;var D=!1,M=!0,N=x?function(t,n){var o=c.getRangeDocument(n),i=e.createRange(o);i.collapseToPoint(n.endContainer,n.endOffset),t.addRange(H(i)),t.extend(n.startContainer,n.startOffset)}:null;l.areHostMethods(_,["addRange","getRangeAt","removeAllRanges"])&&r(_.rangeCount)==a&&p.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,o=n>1,i=[],r=E(t),a=0;a<n;++a)i[a]=t.getRangeAt(a);var l=s.createTestElement(document,"",!1),u=l.appendChild(document.createTextNode("   ")),c=document.createRange();if(c.setStart(u,1),c.collapse(!0),t.removeAllRanges(),t.addRange(c),M=1==t.rangeCount,t.removeAllRanges(),!o){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&parseInt(d[1])>=36)D=!1;else{var f=c.cloneRange();c.setStart(u,0),f.setEnd(u,3),f.setStart(u,2),t.addRange(c),t.addRange(f),D=2==t.rangeCount}}for(s.removeNode(l),t.removeAllRanges(),a=0;a<n;++a)0==a&&r?N?N(t,i[a]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[a])):t.addRange(i[a])}}(),p.selectionSupportsMultipleRanges=D,p.collapsedNonEditableSelectionsSupported=M;var L,j,V=!1;function B(e,t,n){var o=n?"end":"start",i=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function F(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function U(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function H(t){var n;return t instanceof c?((n=e.createNativeRange(t.getDocument())).setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof d?n=t.nativeRange:p.implementsDomRange&&t instanceof s.getWindow(t.startContainer).Range&&(n=t),n}function W(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!s.isAncestorOf(e[0],e[t]))return!1;return!0}function $(e){var n=e.getNodes();if(!W(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function z(e){return!!e&&void 0!==e.text}function Y(e,t){var n=new d(t);e._ranges=[n],B(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function q(t){if(t._ranges.length=0,"None"==t.docSelection.type)U(t);else{var n=t.docSelection.createRange();if(z(n))Y(t,n);else{t.rangeCount=n.length;for(var o,i=v(n.item(0)),r=0;r<t.rangeCount;++r)(o=e.createRange(i)).selectNode(n.item(r)),t._ranges.push(o);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,B(t,t._ranges[t.rangeCount-1],!1)}}}function G(e,n){for(var o=e.docSelection.createRange(),i=$(n),r=v(o.item(0)),a=g(r).createControlRange(),s=0,l=o.length;s<l;++s)a.add(o.item(s));try{a.add(i)}catch(e){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),q(e)}function Z(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function J(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}S&&u(S,"createControlRange")&&(L=S.createControlRange(),l.areHostProperties(L,["item","add"])&&(V=!0)),p.implementsControlRange=V,o=A?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed},u(_,"getRangeAt")?j=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}}:A&&(j=function(t){var n=v(t.anchorNode),o=e.createRange(n);return o.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),o}),Z.prototype=e.selectionPrototype;var K=[];function X(e,t){for(var n,o,i=K.length;i--;)if(o=(n=K[i]).selection,"deleteAll"==t)J(o);else if(n.win==e)return"delete"==t?(K.splice(i,1),!0):o;return"deleteAll"==t&&(K.length=0),null}var Q=function(e){if(e&&e instanceof Z)return e.refresh(),e;var t=X(e=w(e,"getNativeSelection")),o=n(e),i=T?C(e):null;return t?(t.nativeSelection=o,t.docSelection=i,t.refresh()):(t=new Z(o,i,e),K.push({win:e,selection:t})),t};e.getSelection=Q,l.createAliasForDeprecatedMethod(e,"getIframeSelection","getSelection");var ee,te=Z.prototype;function ne(e,n){for(var o,i=v(n[0].startContainer),r=g(i).createControlRange(),a=0,s=n.length;a<s;++a){o=$(n[a]);try{r.add(o)}catch(e){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),q(e)}if(!P&&A&&l.areHostMethods(_,["removeAllRanges","addRange"])){te.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),U(this)};var oe=function(e,t){N(e.nativeSelection,t),e.refresh()};te.addRange=I?function(t,n){if(V&&T&&this.docSelection.type==m)G(this,t);else if(b(n)&&x)oe(this,t);else{var i;D?i=this.rangeCount:(this.removeAllRanges(),i=0);var r=H(t).cloneRange();try{this.nativeSelection.addRange(r)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var a=j(this.nativeSelection,this.rangeCount-1);a&&!y(a,t)&&(t=new d(a))}this._ranges[this.rangeCount-1]=t,B(this,t,ie(this.nativeSelection)),this.isCollapsed=o(this)}else this.refresh()}}:function(e,t){b(t)&&x?oe(this,e):(this.nativeSelection.addRange(H(e)),this.refresh())},te.setRanges=function(e){if(V&&T&&e.length>1)ne(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(u(_,"empty")&&u(R,"select")&&V&&P))return t.fail("No means of selecting a Range or TextRange was found"),!1;te.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=v(this.anchorNode);else if(this.docSelection.type==m){var t=this.docSelection.createRange();t.length&&(e=v(t.item(0)))}e&&(g(e).createTextRange().select(),this.docSelection.empty())}}catch(e){}U(this)},te.addRange=function(t){this.docSelection.type==m?G(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,B(this,t,!1))},te.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?ne(this,e):t&&this.addRange(e[0])}}if(te.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new f("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()},P)ee=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=g(t.win.document).createTextRange()).collapse(!0),t.docSelection.type==m?q(t):z(n)?Y(t,n):U(t)};else if(u(_,"getRangeAt")&&r(_.rangeCount)==a)ee=function(t){if(V&&T&&t.docSelection.type==m)q(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,i=t.rangeCount;n<i;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));B(t,t._ranges[t.rangeCount-1],ie(t.nativeSelection)),t.isCollapsed=o(t)}else U(t)};else{if(!A||r(_.isCollapsed)!=i||r(R.collapsed)!=i||!p.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;ee=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=j(n,0),e._ranges=[t],e.rangeCount=1,F(e),e.isCollapsed=o(e)):U(e)}}te.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(ee(this),e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;i--;)if(!y(t[i],this._ranges[i]))return!0;return!1}};var ie,re=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,i=n.length;o<i;++o)y(t,n[o])||e.addRange(n[o]);e.rangeCount||U(e)};function ae(e,t){if(e.win.document!=v(t))throw new f("WRONG_DOCUMENT_ERR")}function se(t){return function(n,o){var i;this.rangeCount?(i=this.getRangeAt(0))["set"+(t?"Start":"End")](n,o):(i=e.createRange(this.win.document)).setStartAndEnd(n,o),this.setSingleRange(i,this.isBackward())}}function le(e){var t=[],n=new h(e.anchorNode,e.anchorOffset),o=new h(e.focusNode,e.focusOffset),i="function"==typeof e.getName?e.getName():"Selection";if(void 0!==e.rangeCount)for(var r=0,a=e.rangeCount;r<a;++r)t[r]=c.inspect(e.getRangeAt(r));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}te.removeRange=V&&T?function(e){if(this.docSelection.type==m){for(var t=this.docSelection.createRange(),n=$(e),o=v(t.item(0)),i=g(o).createControlRange(),r=!1,a=0,s=t.length;a<s;++a)t.item(a)!==n||r?i.add(t.item(a)):r=!0;i.select(),q(this)}else re(this,e)}:function(e){re(this,e)},!P&&A&&p.implementsDomRange?(ie=E,te.isBackward=function(){return ie(this)}):ie=te.isBackward=function(){return!1},te.isBackwards=te.isBackward,te.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},te.collapse=function(t,n){ae(this,t);var o=e.createRange(t);o.collapseToPoint(t,n),this.setSingleRange(o),this.isCollapsed=!0},te.collapseToStart=function(){if(!this.rangeCount)throw new f("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},te.collapseToEnd=function(){if(!this.rangeCount)throw new f("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},te.selectAllChildren=function(t){ae(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},te.deleteFromDocument=function(){if(V&&T&&this.docSelection.type==m){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),s.removeNode(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,i=n.length;o<i;++o)n[o].deleteContents();this.addRange(n[i-1])}}},te.eachRange=function(e,t){for(var n=0,o=this._ranges.length;n<o;++n)if(e(this.getRangeAt(n)))return t},te.getAllRanges=function(){var e=[];return this.eachRange((function(t){e.push(t)})),e},te.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},te.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange((function(o){n.push(o[e].apply(o,t||[]))})),n},te.setStart=se(!0),te.setEnd=se(!1),e.rangePrototype.select=function(e){Q(this.getDocument()).setSingleRange(this,e)},te.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange((function(n){e(n),t.push(n)})),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},te.containsNode=function(e,t){return this.eachRange((function(n){return n.containsNode(e,t)}),!0)||!1},te.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},te.moveToBookmark=function(t){for(var n,o,i=[],r=0;n=t.rangeBookmarks[r++];)(o=e.createRange(this.win)).moveToBookmark(n),i.push(o);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},te.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},te.restoreRanges=function(e){this.removeAllRanges();for(var t,n=0;t=e.ranges[n];++n)this.addRange(t,e.backward&&0==n)},te.toHtml=function(){var e=[];return this.eachRange((function(t){e.push(c.toHtml(t))})),e.join("")},p.implementsTextRange&&(te.getNativeTextRange=function(){var n;if(n=this.docSelection){var o=n.createRange();if(z(o))return o;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),te.getName=function(){return"WrappedSelection"},te.inspect=function(){return le(this)},te.detach=function(){X(this.win,"delete"),J(this)},Z.detachAll=function(){X(null,"deleteAll")},Z.inspect=le,Z.isDirectionBackward=b,e.Selection=Z,e.selectionPrototype=te,e.addShimListener((function(e){void 0===e.getSelection&&(e.getSelection=function(){return Q(e)}),e=null}))}));var B=!1,F=function(e){B||(B=!0,!E.initialized&&E.config.autoInitialize&&A())};return k&&("complete"==document.readyState?F():(l(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",F,!1),y(window,"load",F))),E},void 0===(i="function"==typeof o?o.call(t,n,t,e):o)||(e.exports=i)},42647:function(e,t,n){var o,i,r;i=[n(82780)],o=function(e){return e.createModule("SaveRestore",["WrappedRange"],(function(e,t){var n=e.dom,o=n.removeNode,i=e.Selection.isDirectionBackward,r="\ufeff";function a(e,t){return(t||document).getElementById(e)}function s(e,t){var o,i="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),a=n.getDocument(e.startContainer),s=e.cloneRange();return s.collapse(t),(o=a.createElement("span")).id=i,o.style.lineHeight="0",o.style.display="none",o.className="rangySelectionBoundary",o.appendChild(a.createTextNode(r)),s.insertNode(o),o}function l(e,n,i,r){var s=a(i,e);s?(n[r?"setStartBefore":"setEndBefore"](s),o(s)):t.warn("Marker element has been removed. Cannot restore selection.")}function u(e,t){return t.compareBoundaryPoints(e.START_TO_START,e)}function c(t,n){var o,r=e.DomRange.getRangeDocument(t),a=t.toString(),l=i(n);return t.collapsed?{document:r,markerId:(o=s(t,!1)).id,collapsed:!0}:(o=s(t,!1),{document:r,startMarkerId:s(t,!0).id,endMarkerId:o.id,collapsed:!1,backward:l,toString:function(){return"original text: '"+a+"', new text: '"+t.toString()+"'"}})}function d(n,i){var r=n.document;void 0===i&&(i=!0);var s=e.createRange(r);if(n.collapsed){var u=a(n.markerId,r);if(u){u.style.display="inline";var c=u.previousSibling;c&&3==c.nodeType?(o(u),s.collapseToPoint(c,c.length)):(s.collapseBefore(u),o(u))}else t.warn("Marker element has been removed. Cannot restore selection.")}else l(r,s,n.startMarkerId,!0),l(r,s,n.endMarkerId,!1);return i&&s.normalizeBoundaries(),s}function f(t,n){var o,r,s=[],l=i(n);(t=t.slice(0)).sort(u);for(var d=0,f=t.length;d<f;++d)s[d]=c(t[d],l);for(d=f-1;d>=0;--d)o=t[d],r=e.DomRange.getRangeDocument(o),o.collapsed?o.collapseAfter(a(s[d].markerId,r)):(o.setEndBefore(a(s[d].endMarkerId,r)),o.setStartAfter(a(s[d].startMarkerId,r)));return s}function h(n){if(!e.isSelectionValid(n))return t.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var o=e.getSelection(n),i=o.getAllRanges(),r=1===i.length&&o.isBackward(),a=f(i,r);return isTouchDevice()||(r?o.setSingleRange(i[0],r):o.setRanges(i)),{win:n,rangeInfos:a,restored:!1}}function p(e){for(var t=[],n=e.length-1;n>=0;n--)t[n]=d(e[n],!0);return t}function m(t,n){if(!t.restored){var o=t.rangeInfos,i=e.getSelection(t.win),r=p(o),a=i.getAllRanges(),s=o.length,l=!1;isTouchDevice()&&(l=v(r,a)),l||(1===s&&n&&e.features.selectionHasExtend&&o[0].backward?(i.removeAllRanges(),i.addRange(r[0],!0)):i.setRanges(r)),t.restored=!0}}function v(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!==t.length)return!1;var n=!1;return _.forEach(e,(function(e,o){if(!g(e,t[o]))return n=!0,!1})),!n}function g(e,t){if(e.startContainer===t.startContainer&&e.endContainer===t.endContainer&&e.startOffset===t.startOffset&&e.endOffset===t.endOffset)return!0;if(0===e.startOffset&&0===t.startOffset&&0===e.endOffset&&0===t.endOffset&&e.startContainer===e.endContainer&&t.startContainer===t.endContainer){if(e.startContainer.nodeType===Node.TEXT_NODE&&$(e.startContainer).parent()[0]===t.startContainer)return!0;if(t.startContainer.nodeType===Node.TEXT_NODE&&$(t.startContainer).parent()[0]===e.startContainer)return!0}return!1}function y(e,t){var n=a(t,e);n&&o(n)}function b(e){for(var t,n=e.rangeInfos,o=0,i=n.length;o<i;++o)(t=n[o]).collapsed?y(e.doc,t.markerId):(y(e.doc,t.startMarkerId),y(e.doc,t.endMarkerId))}e.util.extend(e,{saveRange:c,restoreRange:d,saveRanges:f,restoreRanges:p,saveSelection:h,restoreSelection:m,removeMarkerElement:y,removeMarkers:b})})),e},void 0===(r="function"==typeof o?o.apply(t,i):o)||(e.exports=r)},21702:function(e,t){"use strict";t.Z={props:{childPopup:!1,name:{type:String,default:""},useOutOfFocus:{type:Boolean,default:!0}},data:function(){return{modalName:"",isModalOpened:!1,isApiRequestSended:!1,apiRequestName:"",externalData:{},childPopupLocal:!1,typeFile:""}},computed:{openEvent:function(){return"open-modal-".concat(this.actualModalName)},closeEvent:function(){return"close-modal-".concat(this.actualModalName)},buttonLoading:function(){return this.isApiRequestSended?"kw-button--loading":""},buttonWaiting:function(){return this.isApiRequestSended?"kw-button--waiting":""},actualModalName:function(){return this.name||this.modalName}},created:function(){this.actualModalName&&(window.bus.$on(this.openEvent,this.openModal),window.bus.$on(this.closeEvent,this.closeModal))},beforeDestroy:function(){this.actualModalName&&(window.bus.$off(this.openEvent,this.openModal),window.bus.$off(this.closeEvent,this.closeModal))},methods:{openModal:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&t.data&&_.forEach(t.data,(function(t,n){e.$set(e.externalData,n,t)})),this.modalOpenHandler&&this.modalOpenHandler(),this.apiRequestName="",this.isApiRequestSended=!1,this.isModalOpened=!0,this.childPopupLocal=this.externalData.childPopupLocal||!1,this.typeFile=this.externalData.typeFile||""},closeModal:function(){this.isModalOpened=!1,this.isApiRequestSended=!1,this.apiRequestName="",this.$emit("close"),this.useOutOfFocus&&this.outOfFocus(),this.modalCloseHandler&&this.modalCloseHandler()},apiRequest:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isApiRequestSended||(this.isApiRequestSended=!0,t&&(this.apiRequestName=e),"string"==typeof e?this[e]():"function"==typeof e&&e())},outOfFocus:function(){var e=$("#message_body1");e.length>0&&((e=e.siblings(".trumbowyg-editor")).focus(),e.blur())}}}},83412:function(e,t,n){window.rangy=n(39008),window.rangySelectionSaveRestore=n(42647),n(36838),Vue.component("pdf-view",n(57323).Z),_.forEach(document.querySelectorAll(".app-pdf-view"),(function(e){new Vue({el:e})})),Vue.component("portfolio-upload-modal-confirm",n(52968).Z),Vue.component("portfolio-delete-modal-confirm",n(39988).Z),document.getElementById("portfolio-upload-modal-confirm")&&(window.portfolioUploadModalConfirmApp=new Vue({el:"#portfolio-upload-modal-confirm"})),document.getElementById("portfolio-delete-modal-confirm")&&(window.portfolioUploadModalConfirmApp=new Vue({el:"#portfolio-delete-modal-confirm"})),Vue.component("audio-wavesurfer",n(48527).Z),_.forOwn(document.querySelectorAll(".js-portfolio-view-audio"),(function(e){new Vue({el:e})}))},76035:function(e,t){"use strict";t.Z={data:function(){return{registredBusEvents:[]}},beforeDestroy:function(){var e=this;_.forEachRight(this.registredBusEvents,(function(t){e.offBus(t.event,t.callback)}))},methods:{onBus:function(e,t){this.registredBusEvents.push({event:e,callback:t}),window.bus.$on(e,t)},offBus:function(e,t){var n=_.findIndex(this.registredBusEvents,{event:e,callback:t});n>=0&&this.registredBusEvents.splice(n,1),window.bus.$off(e,t)},emitGlobalEvent:function(e){var t;if(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(t=window.bus).$emit.apply(t,[e].concat(o))}}}}},44679:function(e,t){"use strict";t.Z={methods:{cdnBaseUrl:function(e){return Utils.cdnBaseUrl(e)},cdnImageUrl:function(e){return Utils.cdnImageUrl(e)},cdnAdminUrl:function(e){return Utils.cdnAdminUrl(e)},cdnPortfolioUrl:function(e){return Utils.cdnPortfolioUrl(e)},cdnCatCoverUrl:function(e){return Utils.cdnCatCoverUrl(e)}}}},98617:function(e,t,n){"use strict";var o=n(99490);t.Z={data:function(){var e;return{timezone:window.actorTimezone||(null===(e=window.stateData)||void 0===e?void 0:e.actorTimezone)||"UTC+3",oneDay:86400,oneHour:3600,oneMinute:60}},methods:{getByPattern:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e;return e||(i=+(i=new o.ou(this.timezone).toSeconds())),("sql"===n?new o.ou.fromSQL(i):new o.ou.fromSeconds(+i)).setZone(this.timezone).setLocale(this.locale).toFormat(t)},getDate:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.isDefaultLang?_.upperFirst(this.getByPattern(e,"d MMMM".concat(t?" yyyy":""))):t?this.getByPattern(e,"L/d/yyyy"):this.getByPattern(e,"MMMM d")},getDateShortFormat:function(e){return this.isDefaultLang?this.getByPattern(e,"dd.MM.yyyy"):this.isEs||this.isFr?this.getByPattern(e,"dd/MM/yyyy"):this.getByPattern(e,"L/d/yyyy")},getYear:function(e){return new o.ou.fromSeconds(parseInt(e)).setZone(this.timezone).year},getTime:function(e){return this.isDefaultLang?this.getByPattern(e,"HH:mm"):this.meridiemFormat(this.getByPattern(e,"h:mm a").toLowerCase())},getCurrentYear:function(){return new o.ou(this.timezone).year},isCurrentYear:function(e){return this.getYear(e)===this.getCurrentYear()},getMonthById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"long";return _.upperFirst(o.kI.months(t,{locale:this.locale})[e-1])},getDateWithoutYear:function(e){var t=new o.ou.fromSeconds(parseInt(e)).setZone(this.timezone).setLocale(this.locale);return new o.ou.fromSeconds((new Date).getTime()/1e3).setZone(this.timezone).year===t.year?_.upperFirst(this.isDefaultLang?t.toFormat("d MMMM"):t.toFormat("MMMM d")+this.ordinal(t.day)):this.isDefaultLang?t.toFormat("dd.LL.yyyy"):t.toFormat("L/d/yyyy")},getDateWithTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return"";var i,r=new Date;r.setHours(23),r.setMinutes(59),r.setSeconds(59),r.setMilliseconds(999);var a=new o.ou.fromSeconds(parseInt(e)).setZone(this.timezone),s=new o.ou.fromSeconds((new Date).getTime()/1e3).setZone(this.timezone),u=new o.ou.fromSeconds(r.getTime()/1e3).setZone(this.timezone),c=s.ts-a.ts,d=u.ts-a.ts,f=Math.floor(r.getTime()/1e3);return!t&&c<144e5?i=this.isDefaultLang?a.toFormat("HH:mm"):this.meridiemFormat(a.toFormat("h:mm a").toLowerCase()):d<864e5||d<1728e5?i=f-e<86400?l("todayCapitalLetter","time"):f-e<172800?l("yesterdayCapitalLetter","time"):_.upperFirst(a.setLocale(this.locale).toRelativeCalendar()):s.year===a.year?(i=this.getDateWithoutYear(e),n&&(i=this.addTimeToString(a,i))):(i=this.isDefaultLang?a.toFormat("dd.LL.yy"):a.toFormat("L/d/yyyy"),n&&(i=this.addTimeToString(a,i))),i},getMonthText:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{1:lp("january","time",t),2:lp("february","time",t),3:lp("march","time",t),4:lp("april","time",t),5:lp("may","time",t),6:lp("june","time",t),7:lp("july","time",t),8:lp("august","time",t),9:lp("september","time",t),10:lp("october","time",t),11:lp("november","time",t),12:lp("december","time",t)}[e]},getDaysText:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?l("dayCountShort","time",[e]):lp("dayCount","time",e,[e])},getHoursText:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?l("hourCountShort","time",[e]):lp("hourCount","time",e,[e])},getMinutesText:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?l("minuteCountShort","time",[e]):lp("minuteCount","time",e,[e])},getSecondsText:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?l("secondCountShort","time",[e]):lp("secondCount","time",e,[e])},getCountdownString:function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Utils.getServerTime():0;if(e>i){var r=o.ou.fromSeconds(e),a=o.ou.fromSeconds(i),s=r.diff(a,["days","hours","minutes","seconds"]).toObject(),l="";return s.days>0?(l=this.getDaysText(s.days,n),s.hours>0&&!t&&(l+=" "+this.getHoursText(s.hours,n))):t?l=this.getDaysText(1,n):s.hours>0?(l=this.getHoursText(s.hours,n),s.minutes>0&&(l+=" "+this.getMinutesText(s.minutes,n))):s.minutes>0?l=this.getMinutesText(s.minutes,n):s.seconds>0&&(l=this.getSecondsText(s.seconds,n)),l.trim()}return""},meridiemFormat:function(e){return e.replace(/\s(am|pm)$/i,(function(e,t){return" ".concat(t.split("").join("."),".")}))},ordinal:function(e){if(e>20||e<10)switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},addTimeToString:function(e,t){var n=this.isDefaultLang?e.toFormat("HH:mm"):this.meridiemFormat(e.toFormat("h:mm a").toLowerCase());return"".concat(t,", ").concat(n)},millisecondsToTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";var n=_.floor(e/1e3%60),o=_.floor(e/6e4%60);return t&&(0===o?o="00":o<10&&(o="0"+o)),o+":"+(n=n<10?"0"+n:n)},getDateTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.ou.fromSeconds(e).setZone(t||this.timezone).setLocale(this.locale)},dateToLocaleString:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this.getDateTime(e,n).toLocaleString(t)}}}},17040:function(e,t){"use strict";t.Z={data:function(){return{locale:document.documentElement.lang||"ru",defaultLocale:"ru",enLocale:"en",actorLang:window.actor_lang||document.documentElement.lang||"ru"}},computed:{l:function(){return window.l},lp:function(){return window.lp},siteLang:function(){return document.documentElement.lang},isDefaultLang:function(){return this.siteLang===this.defaultLocale},isEn:function(){return this.siteLang===this.enLocale},isEs:function(){return"es"===this.siteLang},isFr:function(){return"fr"===this.siteLang}},methods:{forceLocale:function(e){this.locale=e}}}},910:function(e,t){"use strict";t.Z={data:function(){return{isTouchDevice:!1,mobileVersion:!1,tabletVersion:!1,windowInnerWidth:window.innerWidth}},created:function(){var e="ontouchstart"in window||window.navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints>0;this.isTouchDevice=e,window.addEventListener("resize",this.updateMobileStatus),e&&window.addEventListener("orientationchange",this.updateMobileStatus),this.updateMobileStatus()},beforeDestroy:function(){window.removeEventListener("resize",this.updateMobileStatus),this.isTouchDevice&&window.removeEventListener("orientationchange",this.updateMobileStatus)},methods:{updateMobileStatus:function(){this.windowInnerWidth=window.innerWidth,this.mobileVersion=this.windowInnerWidth<768,this.tabletVersion=this.windowInnerWidth<1024}}}},99490:function(e,t){"use strict";function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function s(e,t,n){return s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&a(i,n.prototype),i},s.apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return s(e,arguments,r(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),a(o,e)},l(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function c(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}var d=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l(Error)),f=function(e){function t(t){return e.call(this,"Invalid DateTime: "+t.toMessage())||this}return i(t,e),t}(d),h=function(e){function t(t){return e.call(this,"Invalid Interval: "+t.toMessage())||this}return i(t,e),t}(d),p=function(e){function t(t){return e.call(this,"Invalid Duration: "+t.toMessage())||this}return i(t,e),t}(d),m=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(d),v=function(e){function t(t){return e.call(this,"Invalid unit "+t)||this}return i(t,e),t}(d),g=function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(d),y=function(e){function t(){return e.call(this,"Zone is an abstract class")||this}return i(t,e),t}(d),b="numeric",w="short",k="long",C={year:b,month:b,day:b},E={year:b,month:w,day:b},O={year:b,month:w,day:b,weekday:w},T={year:b,month:k,day:b},P={year:b,month:k,day:b,weekday:k},_={hour:b,minute:b},R={hour:b,minute:b,second:b},S={hour:b,minute:b,second:b,timeZoneName:w},A={hour:b,minute:b,second:b,timeZoneName:k},x={hour:b,minute:b,hour12:!1},I={hour:b,minute:b,second:b,hour12:!1},D={hour:b,minute:b,second:b,hour12:!1,timeZoneName:w},M={hour:b,minute:b,second:b,hour12:!1,timeZoneName:k},N={year:b,month:b,day:b,hour:b,minute:b},L={year:b,month:b,day:b,hour:b,minute:b,second:b},j={year:b,month:w,day:b,hour:b,minute:b},V={year:b,month:w,day:b,hour:b,minute:b,second:b},B={year:b,month:w,day:b,weekday:w,hour:b,minute:b},F={year:b,month:k,day:b,hour:b,minute:b,timeZoneName:w},U={year:b,month:k,day:b,hour:b,minute:b,second:b,timeZoneName:w},H={year:b,month:k,day:b,weekday:k,hour:b,minute:b,timeZoneName:k},W={year:b,month:k,day:b,weekday:k,hour:b,minute:b,second:b,timeZoneName:k};function $(e){return void 0===e}function z(e){return"number"==typeof e}function Y(e){return"number"==typeof e&&e%1==0}function q(){try{return"undefined"!=typeof Intl&&Intl.DateTimeFormat}catch(e){return!1}}function G(){return!$(Intl.DateTimeFormat.prototype.formatToParts)}function Z(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function J(e,t,n){if(0!==e.length)return e.reduce((function(e,o){var i=[t(o),o];return e&&n(e[0],i[0])===e[0]?e:i}),null)[1]}function K(e,t){return t.reduce((function(t,n){return t[n]=e[n],t}),{})}function X(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Q(e,t,n){return Y(e)&&e>=t&&e<=n}function ee(e,t){void 0===t&&(t=2);var n=e<0?"-":"",o=n?-1*e:e;return""+n+(o.toString().length<t?("0".repeat(t)+o).slice(-t):o.toString())}function te(e){return $(e)||null===e||""===e?void 0:parseInt(e,10)}function ne(e){if(!$(e)&&null!==e&&""!==e){var t=1e3*parseFloat("0."+e);return Math.floor(t)}}function oe(e,t,n){void 0===n&&(n=!1);var o=Math.pow(10,t);return(n?Math.trunc:Math.round)(e*o)/o}function ie(e){return e%4==0&&(e%100!=0||e%400==0)}function re(e){return ie(e)?366:365}function ae(e,t){var n=function(e,t){return e-t*Math.floor(e/t)}(t-1,12)+1;return 2===n?ie(e+(t-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function se(e){var t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t)).setUTCFullYear(t.getUTCFullYear()-1900),+t}function le(e){var t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,n=e-1,o=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return 4===t||3===o?53:52}function ue(e){return e>99?e:e>60?1900+e:2e3+e}function ce(e,t,n,o){void 0===o&&(o=null);var i=new Date(e),r={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};o&&(r.timeZone=o);var a=Object.assign({timeZoneName:t},r),s=q();if(s&&G()){var l=new Intl.DateTimeFormat(n,a).formatToParts(i).find((function(e){return"timezonename"===e.type.toLowerCase()}));return l?l.value:null}if(s){var u=new Intl.DateTimeFormat(n,r).format(i);return new Intl.DateTimeFormat(n,a).format(i).substring(u.length).replace(/^[, \u200e]+/,"")}return null}function de(e,t){var n=parseInt(e,10);Number.isNaN(n)&&(n=0);var o=parseInt(t,10)||0;return 60*n+(n<0||Object.is(n,-0)?-o:o)}function fe(e){var t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new g("Invalid unit value "+e);return t}function he(e,t,n){var o={};for(var i in e)if(X(e,i)){if(n.indexOf(i)>=0)continue;var r=e[i];if(null==r)continue;o[t(i)]=fe(r)}return o}function pe(e,t){var n=Math.trunc(Math.abs(e/60)),o=Math.trunc(Math.abs(e%60)),i=e>=0?"+":"-";switch(t){case"short":return""+i+ee(n,2)+":"+ee(o,2);case"narrow":return""+i+n+(o>0?":"+o:"");case"techie":return""+i+ee(n,2)+ee(o,2);default:throw new RangeError("Value format "+t+" is out of range for property format")}}function me(e){return K(e,["hour","minute","second","millisecond"])}var ve=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/;function ge(e){return JSON.stringify(e,Object.keys(e).sort())}var ye=["January","February","March","April","May","June","July","August","September","October","November","December"],be=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],we=["J","F","M","A","M","J","J","A","S","O","N","D"];function ke(e){switch(e){case"narrow":return[].concat(we);case"short":return[].concat(be);case"long":return[].concat(ye);case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var Ce=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ee=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Oe=["M","T","W","T","F","S","S"];function Te(e){switch(e){case"narrow":return[].concat(Oe);case"short":return[].concat(Ee);case"long":return[].concat(Ce);case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var Pe=["AM","PM"],_e=["Before Christ","Anno Domini"],Re=["BC","AD"],Se=["B","A"];function Ae(e){switch(e){case"narrow":return[].concat(Se);case"short":return[].concat(Re);case"long":return[].concat(_e);default:return null}}function xe(e,t){for(var n,o="",i=c(e);!(n=i()).done;){var r=n.value;r.literal?o+=r.val:o+=t(r.val)}return o}var Ie={D:C,DD:E,DDD:T,DDDD:P,t:_,tt:R,ttt:S,tttt:A,T:x,TT:I,TTT:D,TTTT:M,f:N,ff:j,fff:F,ffff:H,F:L,FF:V,FFF:U,FFFF:W},De=function(){function e(e,t){this.opts=t,this.loc=e,this.systemLoc=null}e.create=function(t,n){return void 0===n&&(n={}),new e(t,n)},e.parseFormat=function(e){for(var t=null,n="",o=!1,i=[],r=0;r<e.length;r++){var a=e.charAt(r);"'"===a?(n.length>0&&i.push({literal:o,val:n}),t=null,n="",o=!o):o||a===t?n+=a:(n.length>0&&i.push({literal:!1,val:n}),n=a,t=a)}return n.length>0&&i.push({literal:o,val:n}),i},e.macroTokenToFormatOpts=function(e){return Ie[e]};var t=e.prototype;return t.formatWithSystemDefault=function(e,t){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTime=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTimeParts=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).formatToParts()},t.resolvedOptions=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).resolvedOptions()},t.num=function(e,t){if(void 0===t&&(t=0),this.opts.forceSimple)return ee(e,t);var n=Object.assign({},this.opts);return t>0&&(n.padTo=t),this.loc.numberFormatter(n).format(e)},t.formatDateTimeFromString=function(t,n){var o=this,i="en"===this.loc.listingMode(),r=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar&&G(),a=function(e,n){return o.loc.extract(t,e,n)},s=function(e){return t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):""},l=function(){return i?function(e){return Pe[e.hour<12?0:1]}(t):a({hour:"numeric",hour12:!0},"dayperiod")},u=function(e,n){return i?function(e,t){return ke(t)[e.month-1]}(t,e):a(n?{month:e}:{month:e,day:"numeric"},"month")},c=function(e,n){return i?function(e,t){return Te(t)[e.weekday-1]}(t,e):a(n?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday")},d=function(e){return i?function(e,t){return Ae(t)[e.year<0?0:1]}(t,e):a({era:e},"era")};return xe(e.parseFormat(n),(function(n){switch(n){case"S":return o.num(t.millisecond);case"u":case"SSS":return o.num(t.millisecond,3);case"s":return o.num(t.second);case"ss":return o.num(t.second,2);case"m":return o.num(t.minute);case"mm":return o.num(t.minute,2);case"h":return o.num(t.hour%12==0?12:t.hour%12);case"hh":return o.num(t.hour%12==0?12:t.hour%12,2);case"H":return o.num(t.hour);case"HH":return o.num(t.hour,2);case"Z":return s({format:"narrow",allowZ:o.opts.allowZ});case"ZZ":return s({format:"short",allowZ:o.opts.allowZ});case"ZZZ":return s({format:"techie",allowZ:o.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:o.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:o.loc.locale});case"z":return t.zoneName;case"a":return l();case"d":return r?a({day:"numeric"},"day"):o.num(t.day);case"dd":return r?a({day:"2-digit"},"day"):o.num(t.day,2);case"c":case"E":return o.num(t.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return r?a({month:"numeric",day:"numeric"},"month"):o.num(t.month);case"LL":return r?a({month:"2-digit",day:"numeric"},"month"):o.num(t.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return r?a({month:"numeric"},"month"):o.num(t.month);case"MM":return r?a({month:"2-digit"},"month"):o.num(t.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return r?a({year:"numeric"},"year"):o.num(t.year);case"yy":return r?a({year:"2-digit"},"year"):o.num(t.year.toString().slice(-2),2);case"yyyy":return r?a({year:"numeric"},"year"):o.num(t.year,4);case"yyyyyy":return r?a({year:"numeric"},"year"):o.num(t.year,6);case"G":return d("short");case"GG":return d("long");case"GGGGG":return d("narrow");case"kk":return o.num(t.weekYear.toString().slice(-2),2);case"kkkk":return o.num(t.weekYear,4);case"W":return o.num(t.weekNumber);case"WW":return o.num(t.weekNumber,2);case"o":return o.num(t.ordinal);case"ooo":return o.num(t.ordinal,3);case"q":return o.num(t.quarter);case"qq":return o.num(t.quarter,2);case"X":return o.num(Math.floor(t.ts/1e3));case"x":return o.num(t.ts);default:return function(n){var i=e.macroTokenToFormatOpts(n);return i?o.formatWithSystemDefault(t,i):n}(n)}}))},t.formatDurationFromString=function(t,n){var o,i=this,r=function(e){switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},a=e.parseFormat(n),s=a.reduce((function(e,t){var n=t.literal,o=t.val;return n?e:e.concat(o)}),[]),l=t.shiftTo.apply(t,s.map(r).filter((function(e){return e})));return xe(a,(o=l,function(e){var t=r(e);return t?i.num(o.get(t),e.length):e}))},e}(),Me=function(){function e(e,t){this.reason=e,this.explanation=t}return e.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},e}(),Ne=function(){function e(){}var t=e.prototype;return t.offsetName=function(e,t){throw new y},t.formatOffset=function(e,t){throw new y},t.offset=function(e){throw new y},t.equals=function(e){throw new y},o(e,[{key:"type",get:function(){throw new y}},{key:"name",get:function(){throw new y}},{key:"universal",get:function(){throw new y}},{key:"isValid",get:function(){throw new y}}]),e}(),Le=null,je=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.offsetName=function(e,t){return ce(e,t.format,t.locale)},n.formatOffset=function(e,t){return pe(this.offset(e),t)},n.offset=function(e){return-new Date(e).getTimezoneOffset()},n.equals=function(e){return"local"===e.type},o(t,[{key:"type",get:function(){return"local"}},{key:"name",get:function(){return q()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return null===Le&&(Le=new t),Le}}]),t}(Ne),Ve=RegExp("^"+ve.source+"$"),Be={};var Fe={year:0,month:1,day:2,hour:3,minute:4,second:5};var Ue={},He=function(e){function t(n){var o;return(o=e.call(this)||this).zoneName=n,o.valid=t.isValidZone(n),o}i(t,e),t.create=function(e){return Ue[e]||(Ue[e]=new t(e)),Ue[e]},t.resetCache=function(){Ue={},Be={}},t.isValidSpecifier=function(e){return!(!e||!e.match(Ve))},t.isValidZone=function(e){try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(e){return!1}},t.parseGMTOffset=function(e){if(e){var t=e.match(/^Etc\/GMT(0|[+-]\d{1,2})$/i);if(t)return-60*parseInt(t[1])}return null};var n=t.prototype;return n.offsetName=function(e,t){return ce(e,t.format,t.locale,this.name)},n.formatOffset=function(e,t){return pe(this.offset(e),t)},n.offset=function(e){var t=new Date(e);if(isNaN(t))return NaN;var n,o=(n=this.name,Be[n]||(Be[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),Be[n]),i=o.formatToParts?function(e,t){for(var n=e.formatToParts(t),o=[],i=0;i<n.length;i++){var r=n[i],a=r.type,s=r.value,l=Fe[a];$(l)||(o[l]=parseInt(s,10))}return o}(o,t):function(e,t){var n=e.format(t).replace(/\u200E/g,""),o=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n),i=o[1],r=o[2];return[o[3],i,r,o[4],o[5],o[6]]}(o,t),r=i[0],a=i[1],s=i[2],l=i[3],u=+t,c=u%1e3;return(se({year:r,month:a,day:s,hour:24===l?0:l,minute:i[4],second:i[5],millisecond:0})-(u-=c>=0?c:1e3+c))/6e4},n.equals=function(e){return"iana"===e.type&&e.name===this.name},o(t,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),t}(Ne),We=null,$e=function(e){function t(t){var n;return(n=e.call(this)||this).fixed=t,n}i(t,e),t.instance=function(e){return 0===e?t.utcInstance:new t(e)},t.parseSpecifier=function(e){if(e){var n=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new t(de(n[1],n[2]))}return null},o(t,null,[{key:"utcInstance",get:function(){return null===We&&(We=new t(0)),We}}]);var n=t.prototype;return n.offsetName=function(){return this.name},n.formatOffset=function(e,t){return pe(this.fixed,t)},n.offset=function(){return this.fixed},n.equals=function(e){return"fixed"===e.type&&e.fixed===this.fixed},o(t,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+pe(this.fixed,"narrow")}},{key:"universal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}]),t}(Ne),ze=function(e){function t(t){var n;return(n=e.call(this)||this).zoneName=t,n}i(t,e);var n=t.prototype;return n.offsetName=function(){return null},n.formatOffset=function(){return""},n.offset=function(){return NaN},n.equals=function(){return!1},o(t,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),t}(Ne);function Ye(e,t){var n;if($(e)||null===e)return t;if(e instanceof Ne)return e;if("string"==typeof e){var o=e.toLowerCase();return"local"===o?t:"utc"===o||"gmt"===o?$e.utcInstance:null!=(n=He.parseGMTOffset(e))?$e.instance(n):He.isValidSpecifier(o)?He.create(e):$e.parseSpecifier(o)||new ze(e)}return z(e)?$e.instance(e):"object"==typeof e&&e.offset&&"number"==typeof e.offset?e:new ze(e)}var qe=function(){return Date.now()},Ge=null,Ze=null,Je=null,Ke=null,Xe=!1,Qe=function(){function e(){}return e.resetCaches=function(){ct.resetCache(),He.resetCache()},o(e,null,[{key:"now",get:function(){return qe},set:function(e){qe=e}},{key:"defaultZoneName",get:function(){return e.defaultZone.name},set:function(e){Ge=e?Ye(e):null}},{key:"defaultZone",get:function(){return Ge||je.instance}},{key:"defaultLocale",get:function(){return Ze},set:function(e){Ze=e}},{key:"defaultNumberingSystem",get:function(){return Je},set:function(e){Je=e}},{key:"defaultOutputCalendar",get:function(){return Ke},set:function(e){Ke=e}},{key:"throwOnInvalid",get:function(){return Xe},set:function(e){Xe=e}}]),e}(),et={};function tt(e,t){void 0===t&&(t={});var n=JSON.stringify([e,t]),o=et[n];return o||(o=new Intl.DateTimeFormat(e,t),et[n]=o),o}var nt={};var ot={};function it(e,t){void 0===t&&(t={});var n=t,o=(n.base,function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(n,["base"])),i=JSON.stringify([e,o]),r=ot[i];return r||(r=new Intl.RelativeTimeFormat(e,t),ot[i]=r),r}var rt=null;function at(e,t,n,o,i){var r=e.listingMode(n);return"error"===r?null:"en"===r?o(t):i(t)}var st=function(){function e(e,t,n){if(this.padTo=n.padTo||0,this.floor=n.floor||!1,!t&&q()){var o={useGrouping:!1};n.padTo>0&&(o.minimumIntegerDigits=n.padTo),this.inf=function(e,t){void 0===t&&(t={});var n=JSON.stringify([e,t]),o=nt[n];return o||(o=new Intl.NumberFormat(e,t),nt[n]=o),o}(e,o)}}return e.prototype.format=function(e){if(this.inf){var t=this.floor?Math.floor(e):e;return this.inf.format(t)}return ee(this.floor?Math.floor(e):oe(e,3),this.padTo)},e}(),lt=function(){function e(e,t,n){var o;if(this.opts=n,this.hasIntl=q(),e.zone.universal&&this.hasIntl){var i=e.offset/60*-1,r=i>=0?"Etc/GMT+"+i:"Etc/GMT"+i,a=He.isValidZone(r);0!==e.offset&&a?(o=r,this.dt=e):(o="UTC",n.timeZoneName?this.dt=e:this.dt=0===e.offset?e:po.fromMillis(e.ts+60*e.offset*1e3))}else"local"===e.zone.type?this.dt=e:(this.dt=e,o=e.zone.name);if(this.hasIntl){var s=Object.assign({},this.opts);o&&(s.timeZone=o),this.dtf=tt(t,s)}}var t=e.prototype;return t.format=function(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());var e=function(e){var t="EEEE, LLLL d, yyyy, h:mm a";switch(ge(K(e,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case ge(C):return"M/d/yyyy";case ge(E):return"LLL d, yyyy";case ge(O):return"EEE, LLL d, yyyy";case ge(T):return"LLLL d, yyyy";case ge(P):return"EEEE, LLLL d, yyyy";case ge(_):return"h:mm a";case ge(R):return"h:mm:ss a";case ge(S):case ge(A):return"h:mm a";case ge(x):return"HH:mm";case ge(I):return"HH:mm:ss";case ge(D):case ge(M):return"HH:mm";case ge(N):return"M/d/yyyy, h:mm a";case ge(j):return"LLL d, yyyy, h:mm a";case ge(F):return"LLLL d, yyyy, h:mm a";case ge(H):return t;case ge(L):return"M/d/yyyy, h:mm:ss a";case ge(V):return"LLL d, yyyy, h:mm:ss a";case ge(B):return"EEE, d LLL yyyy, h:mm a";case ge(U):return"LLLL d, yyyy, h:mm:ss a";case ge(W):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return t}}(this.opts),t=ct.create("en-US");return De.create(t).formatDateTimeFromString(this.dt,e)},t.formatToParts=function(){return this.hasIntl&&G()?this.dtf.formatToParts(this.dt.toJSDate()):[]},t.resolvedOptions=function(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}},e}(),ut=function(){function e(e,t,n){this.opts=Object.assign({style:"long"},n),!t&&Z()&&(this.rtf=it(e,n))}var t=e.prototype;return t.format=function(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,n,o){void 0===n&&(n="always"),void 0===o&&(o=!1);var i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},r=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===n&&r){var a="days"===e;switch(t){case 1:return a?"tomorrow":"next "+i[e][0];case-1:return a?"yesterday":"last "+i[e][0];case 0:return a?"today":"this "+i[e][0]}}var s=Object.is(t,-0)||t<0,l=Math.abs(t),u=1===l,c=i[e],d=o?u?c[1]:c[2]||c[1]:u?i[e][0]:e;return s?l+" "+d+" ago":"in "+l+" "+d}(t,e,this.opts.numeric,"long"!==this.opts.style)},t.formatToParts=function(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]},e}(),ct=function(){function e(e,t,n,o){var i=function(e){var t=e.indexOf("-u-");if(-1===t)return[e];var n,o=e.substring(0,t);try{n=tt(e).resolvedOptions()}catch(e){n=tt(o).resolvedOptions()}var i=n;return[o,i.numberingSystem,i.calendar]}(e),r=i[0],a=i[1],s=i[2];this.locale=r,this.numberingSystem=t||a||null,this.outputCalendar=n||s||null,this.intl=function(e,t,n){return q()?n||t?(e+="-u",n&&(e+="-ca-"+n),t&&(e+="-nu-"+t),e):e:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=o,this.fastNumbersCached=null}e.fromOpts=function(t){return e.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)},e.create=function(t,n,o,i){void 0===i&&(i=!1);var r=t||Qe.defaultLocale;return new e(r||(i?"en-US":function(){if(rt)return rt;if(q()){var e=(new Intl.DateTimeFormat).resolvedOptions().locale;return rt=e&&"und"!==e?e:"en-US"}return rt="en-US"}()),n||Qe.defaultNumberingSystem,o||Qe.defaultOutputCalendar,r)},e.resetCache=function(){rt=null,et={},nt={},ot={}},e.fromObject=function(t){var n=void 0===t?{}:t,o=n.locale,i=n.numberingSystem,r=n.outputCalendar;return e.create(o,i,r)};var t=e.prototype;return t.listingMode=function(e){void 0===e&&(e=!0);var t=q()&&G(),n=this.isEnglish(),o=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return t||n&&o||e?!t||n&&o?"en":"intl":"error"},t.clone=function(t){return t&&0!==Object.getOwnPropertyNames(t).length?e.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this},t.redefaultToEN=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!0}))},t.redefaultToSystem=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!1}))},t.months=function(e,t,n){var o=this;return void 0===t&&(t=!1),void 0===n&&(n=!0),at(this,e,n,ke,(function(){var n=t?{month:e,day:"numeric"}:{month:e},i=t?"format":"standalone";return o.monthsCache[i][e]||(o.monthsCache[i][e]=function(e){for(var t=[],n=1;n<=12;n++){var o=po.utc(2016,n,1);t.push(e(o))}return t}((function(e){return o.extract(e,n,"month")}))),o.monthsCache[i][e]}))},t.weekdays=function(e,t,n){var o=this;return void 0===t&&(t=!1),void 0===n&&(n=!0),at(this,e,n,Te,(function(){var n=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=t?"format":"standalone";return o.weekdaysCache[i][e]||(o.weekdaysCache[i][e]=function(e){for(var t=[],n=1;n<=7;n++){var o=po.utc(2016,11,13+n);t.push(e(o))}return t}((function(e){return o.extract(e,n,"weekday")}))),o.weekdaysCache[i][e]}))},t.meridiems=function(e){var t=this;return void 0===e&&(e=!0),at(this,void 0,e,(function(){return Pe}),(function(){if(!t.meridiemCache){var e={hour:"numeric",hour12:!0};t.meridiemCache=[po.utc(2016,11,13,9),po.utc(2016,11,13,19)].map((function(n){return t.extract(n,e,"dayperiod")}))}return t.meridiemCache}))},t.eras=function(e,t){var n=this;return void 0===t&&(t=!0),at(this,e,t,Ae,(function(){var t={era:e};return n.eraCache[e]||(n.eraCache[e]=[po.utc(-40,1,1),po.utc(2017,1,1)].map((function(e){return n.extract(e,t,"era")}))),n.eraCache[e]}))},t.extract=function(e,t,n){var o=this.dtFormatter(e,t).formatToParts().find((function(e){return e.type.toLowerCase()===n}));return o?o.value:null},t.numberFormatter=function(e){return void 0===e&&(e={}),new st(this.intl,e.forceSimple||this.fastNumbers,e)},t.dtFormatter=function(e,t){return void 0===t&&(t={}),new lt(e,this.intl,t)},t.relFormatter=function(e){return void 0===e&&(e={}),new ut(this.intl,this.isEnglish(),e)},t.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||q()&&new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},t.equals=function(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar},o(e,[{key:"fastNumbers",get:function(){var e;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(e=this).numberingSystem||"latn"===e.numberingSystem)&&("latn"===e.numberingSystem||!e.locale||e.locale.startsWith("en")||q()&&"latn"===new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),e}();function dt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t.reduce((function(e,t){return e+t.source}),"");return RegExp("^"+o+"$")}function ft(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){var o=t[0],i=t[1],r=t[2],a=n(e,r),s=a[0],l=a[1],u=a[2];return[Object.assign(o,s),i||l,u]}),[{},null,1]).slice(0,2)}}function ht(e){if(null==e)return[null,null];for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];for(var i=0,r=n;i<r.length;i++){var a=r[i],s=a[0],l=a[1],u=s.exec(e);if(u)return l(u)}return[null,null]}function pt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n){var o,i={};for(o=0;o<t.length;o++)i[t[o]]=te(e[n+o]);return[i,null,n+o]}}var mt=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,vt=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,gt=RegExp(""+vt.source+mt.source+"?"),yt=RegExp("(?:T"+gt.source+")?"),bt=pt("weekYear","weekNumber","weekDay"),wt=pt("year","ordinal"),kt=RegExp(vt.source+" ?(?:"+mt.source+"|("+ve.source+"))?"),Ct=RegExp("(?: "+kt.source+")?");function Et(e,t,n){var o=e[t];return $(o)?n:te(o)}function Ot(e,t){return[{year:Et(e,t),month:Et(e,t+1,1),day:Et(e,t+2,1)},null,t+3]}function Tt(e,t){return[{hours:Et(e,t,0),minutes:Et(e,t+1,0),seconds:Et(e,t+2,0),milliseconds:ne(e[t+3])},null,t+4]}function Pt(e,t){var n=!e[t]&&!e[t+1],o=de(e[t+1],e[t+2]);return[{},n?null:$e.instance(o),t+3]}function _t(e,t){return[{},e[t]?He.create(e[t]):null,t+1]}var Rt=RegExp("^T?"+vt.source+"$"),St=/^-?P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,9}))?S)?)?)$/;function At(e){var t=e[0],n=e[1],o=e[2],i=e[3],r=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c="-"===t[0],d=l&&"-"===l[0],f=function(e,t){return void 0===t&&(t=!1),void 0!==e&&(t||e&&c)?-e:e};return[{years:f(te(n)),months:f(te(o)),weeks:f(te(i)),days:f(te(r)),hours:f(te(a)),minutes:f(te(s)),seconds:f(te(l),"-0"===l),milliseconds:f(ne(u),d)}]}var xt={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function It(e,t,n,o,i,r,a){var s={year:2===t.length?ue(te(t)):te(t),month:be.indexOf(n)+1,day:te(o),hour:te(i),minute:te(r)};return a&&(s.second=te(a)),e&&(s.weekday=e.length>3?Ce.indexOf(e)+1:Ee.indexOf(e)+1),s}var Dt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Mt(e){var t,n=e[1],o=e[2],i=e[3],r=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],d=e[10],f=e[11],h=It(n,r,i,o,a,s,l);return t=u?xt[u]:c?0:de(d,f),[h,new $e(t)]}var Nt=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Lt=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,jt=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Vt(e){var t=e[1],n=e[2],o=e[3];return[It(t,e[4],o,n,e[5],e[6],e[7]),$e.utcInstance]}function Bt(e){var t=e[1],n=e[2],o=e[3],i=e[4],r=e[5],a=e[6];return[It(t,e[7],n,o,i,r,a),$e.utcInstance]}var Ft=dt(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,yt),Ut=dt(/(\d{4})-?W(\d\d)(?:-?(\d))?/,yt),Ht=dt(/(\d{4})-?(\d{3})/,yt),Wt=dt(gt),$t=ft(Ot,Tt,Pt),zt=ft(bt,Tt,Pt),Yt=ft(wt,Tt,Pt),qt=ft(Tt,Pt);var Gt=ft(Tt);var Zt=dt(/(\d{4})-(\d\d)-(\d\d)/,Ct),Jt=dt(kt),Kt=ft(Ot,Tt,Pt,_t),Xt=ft(Tt,Pt,_t);var Qt={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},en=Object.assign({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},Qt),tn=365.2425,nn=30.436875,on=Object.assign({years:{quarters:4,months:12,weeks:52.1775,days:tn,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:nn,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},Qt),rn=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],an=rn.slice(0).reverse();function sn(e,t,n){void 0===n&&(n=!1);var o={values:n?t.values:Object.assign({},e.values,t.values||{}),loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy};return new un(o)}function ln(e,t,n,o,i){var r=e[i][n],a=t[n]/r,s=!(Math.sign(a)===Math.sign(o[i]))&&0!==o[i]&&Math.abs(a)<=1?function(e){return e<0?Math.floor(e):Math.ceil(e)}(a):Math.trunc(a);o[i]+=s,t[n]-=s*r}var un=function(){function e(e){var t="longterm"===e.conversionAccuracy||!1;this.values=e.values,this.loc=e.loc||ct.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=t?on:en,this.isLuxonDuration=!0}e.fromMillis=function(t,n){return e.fromObject(Object.assign({milliseconds:t},n))},e.fromObject=function(t){if(null==t||"object"!=typeof t)throw new g("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new e({values:he(t,e.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:ct.fromObject(t),conversionAccuracy:t.conversionAccuracy})},e.fromISO=function(t,n){var o=function(e){return ht(e,[St,At])}(t),i=o[0];if(i){var r=Object.assign(i,n);return e.fromObject(r)}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.fromISOTime=function(t,n){var o=function(e){return ht(e,[Rt,Gt])}(t),i=o[0];if(i){var r=Object.assign(i,n);return e.fromObject(r)}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.invalid=function(t,n){if(void 0===n&&(n=null),!t)throw new g("need to specify a reason the Duration is invalid");var o=t instanceof Me?t:new Me(t,n);if(Qe.throwOnInvalid)throw new p(o);return new e({invalid:o})},e.normalizeUnit=function(e){var t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new v(e);return t},e.isDuration=function(e){return e&&e.isLuxonDuration||!1};var t=e.prototype;return t.toFormat=function(e,t){void 0===t&&(t={});var n=Object.assign({},t,{floor:!1!==t.round&&!1!==t.floor});return this.isValid?De.create(this.loc,n).formatDurationFromString(this,e):"Invalid Duration"},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.values);return e.includeConfig&&(t.conversionAccuracy=this.conversionAccuracy,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toISO=function(){if(!this.isValid)return null;var e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=oe(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e},t.toISOTime=function(e){if(void 0===e&&(e={}),!this.isValid)return null;var t=this.toMillis();if(t<0||t>=864e5)return null;e=Object.assign({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},e);var n=this.shiftTo("hours","minutes","seconds","milliseconds"),o="basic"===e.format?"hhmm":"hh:mm";e.suppressSeconds&&0===n.seconds&&0===n.milliseconds||(o+="basic"===e.format?"ss":":ss",e.suppressMilliseconds&&0===n.milliseconds||(o+=".SSS"));var i=n.toFormat(o);return e.includePrefix&&(i="T"+i),i},t.toJSON=function(){return this.toISO()},t.toString=function(){return this.toISO()},t.toMillis=function(){return this.as("milliseconds")},t.valueOf=function(){return this.toMillis()},t.plus=function(e){if(!this.isValid)return this;for(var t,n=cn(e),o={},i=c(rn);!(t=i()).done;){var r=t.value;(X(n.values,r)||X(this.values,r))&&(o[r]=n.get(r)+this.get(r))}return sn(this,{values:o},!0)},t.minus=function(e){if(!this.isValid)return this;var t=cn(e);return this.plus(t.negate())},t.mapUnits=function(e){if(!this.isValid)return this;for(var t={},n=0,o=Object.keys(this.values);n<o.length;n++){var i=o[n];t[i]=fe(e(this.values[i],i))}return sn(this,{values:t},!0)},t.get=function(t){return this[e.normalizeUnit(t)]},t.set=function(t){return this.isValid?sn(this,{values:Object.assign(this.values,he(t,e.normalizeUnit,[]))}):this},t.reconfigure=function(e){var t=void 0===e?{}:e,n=t.locale,o=t.numberingSystem,i=t.conversionAccuracy,r={loc:this.loc.clone({locale:n,numberingSystem:o})};return i&&(r.conversionAccuracy=i),sn(this,r)},t.as=function(e){return this.isValid?this.shiftTo(e).get(e):NaN},t.normalize=function(){if(!this.isValid)return this;var e=this.toObject();return function(e,t){an.reduce((function(n,o){return $(t[o])?n:(n&&ln(e,t,n,t,o),o)}),null)}(this.matrix,e),sn(this,{values:e},!0)},t.shiftTo=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];if(!this.isValid)return this;if(0===n.length)return this;n=n.map((function(t){return e.normalizeUnit(t)}));for(var i,r,a={},s={},l=this.toObject(),u=c(rn);!(r=u()).done;){var d=r.value;if(n.indexOf(d)>=0){i=d;var f=0;for(var h in s)f+=this.matrix[h][d]*s[h],s[h]=0;z(l[d])&&(f+=l[d]);var p=Math.trunc(f);for(var m in a[d]=p,s[d]=f-p,l)rn.indexOf(m)>rn.indexOf(d)&&ln(this.matrix,l,m,a,d)}else z(l[d])&&(s[d]=l[d])}for(var v in s)0!==s[v]&&(a[i]+=v===i?s[v]:s[v]/this.matrix[i][v]);return sn(this,{values:a},!0).normalize()},t.negate=function(){if(!this.isValid)return this;for(var e={},t=0,n=Object.keys(this.values);t<n.length;t++){var o=n[t];e[o]=-this.values[o]}return sn(this,{values:e},!0)},t.equals=function(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(var t,n=c(rn);!(t=n()).done;){var o=t.value;if(i=this.values[o],r=e.values[o],!(void 0===i||0===i?void 0===r||0===r:i===r))return!1}var i,r;return!0},o(e,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}();function cn(e){if(z(e))return un.fromMillis(e);if(un.isDuration(e))return e;if("object"==typeof e)return un.fromObject(e);throw new g("Unknown duration argument "+e+" of type "+typeof e)}var dn="Invalid Interval";function fn(e,t){return e&&e.isValid?t&&t.isValid?t<e?hn.invalid("end before start","The end of an interval must be after its start, but you had start="+e.toISO()+" and end="+t.toISO()):null:hn.invalid("missing or invalid end"):hn.invalid("missing or invalid start")}var hn=function(){function e(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}e.invalid=function(t,n){if(void 0===n&&(n=null),!t)throw new g("need to specify a reason the Interval is invalid");var o=t instanceof Me?t:new Me(t,n);if(Qe.throwOnInvalid)throw new h(o);return new e({invalid:o})},e.fromDateTimes=function(t,n){var o=mo(t),i=mo(n),r=fn(o,i);return null==r?new e({start:o,end:i}):r},e.after=function(t,n){var o=cn(n),i=mo(t);return e.fromDateTimes(i,i.plus(o))},e.before=function(t,n){var o=cn(n),i=mo(t);return e.fromDateTimes(i.minus(o),i)},e.fromISO=function(t,n){var o=(t||"").split("/",2),i=o[0],r=o[1];if(i&&r){var a,s,l,u;try{s=(a=po.fromISO(i,n)).isValid}catch(r){s=!1}try{u=(l=po.fromISO(r,n)).isValid}catch(r){u=!1}if(s&&u)return e.fromDateTimes(a,l);if(s){var c=un.fromISO(r,n);if(c.isValid)return e.after(a,c)}else if(u){var d=un.fromISO(i,n);if(d.isValid)return e.before(l,d)}}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.isInterval=function(e){return e&&e.isLuxonInterval||!1};var t=e.prototype;return t.length=function(e){return void 0===e&&(e="milliseconds"),this.isValid?this.toDuration.apply(this,[e]).get(e):NaN},t.count=function(e){if(void 0===e&&(e="milliseconds"),!this.isValid)return NaN;var t=this.start.startOf(e),n=this.end.startOf(e);return Math.floor(n.diff(t,e).get(e))+1},t.hasSame=function(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))},t.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},t.isAfter=function(e){return!!this.isValid&&this.s>e},t.isBefore=function(e){return!!this.isValid&&this.e<=e},t.contains=function(e){return!!this.isValid&&(this.s<=e&&this.e>e)},t.set=function(t){var n=void 0===t?{}:t,o=n.start,i=n.end;return this.isValid?e.fromDateTimes(o||this.s,i||this.e):this},t.splitAt=function(){var t=this;if(!this.isValid)return[];for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];for(var r=o.map(mo).filter((function(e){return t.contains(e)})).sort(),a=[],s=this.s,l=0;s<this.e;){var u=r[l]||this.e,c=+u>+this.e?this.e:u;a.push(e.fromDateTimes(s,c)),s=c,l+=1}return a},t.splitBy=function(t){var n=cn(t);if(!this.isValid||!n.isValid||0===n.as("milliseconds"))return[];for(var o,i=this.s,r=1,a=[];i<this.e;){var s=this.start.plus(n.mapUnits((function(e){return e*r})));o=+s>+this.e?this.e:s,a.push(e.fromDateTimes(i,o)),i=o,r+=1}return a},t.divideEqually=function(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]},t.overlaps=function(e){return this.e>e.s&&this.s<e.e},t.abutsStart=function(e){return!!this.isValid&&+this.e==+e.s},t.abutsEnd=function(e){return!!this.isValid&&+e.e==+this.s},t.engulfs=function(e){return!!this.isValid&&(this.s<=e.s&&this.e>=e.e)},t.equals=function(e){return!(!this.isValid||!e.isValid)&&(this.s.equals(e.s)&&this.e.equals(e.e))},t.intersection=function(t){if(!this.isValid)return this;var n=this.s>t.s?this.s:t.s,o=this.e<t.e?this.e:t.e;return n>=o?null:e.fromDateTimes(n,o)},t.union=function(t){if(!this.isValid)return this;var n=this.s<t.s?this.s:t.s,o=this.e>t.e?this.e:t.e;return e.fromDateTimes(n,o)},e.merge=function(e){var t=e.sort((function(e,t){return e.s-t.s})).reduce((function(e,t){var n=e[0],o=e[1];return o?o.overlaps(t)||o.abutsStart(t)?[n,o.union(t)]:[n.concat([o]),t]:[n,t]}),[[],null]),n=t[0],o=t[1];return o&&n.push(o),n},e.xor=function(t){for(var n,o,i=null,r=0,a=[],s=t.map((function(e){return[{time:e.s,type:"s"},{time:e.e,type:"e"}]})),l=c((n=Array.prototype).concat.apply(n,s).sort((function(e,t){return e.time-t.time})));!(o=l()).done;){var u=o.value;1===(r+="s"===u.type?1:-1)?i=u.time:(i&&+i!=+u.time&&a.push(e.fromDateTimes(i,u.time)),i=null)}return e.merge(a)},t.difference=function(){for(var t=this,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e.xor([this].concat(o)).map((function(e){return t.intersection(e)})).filter((function(e){return e&&!e.isEmpty()}))},t.toString=function(){return this.isValid?"["+this.s.toISO()+" – "+this.e.toISO()+")":dn},t.toISO=function(e){return this.isValid?this.s.toISO(e)+"/"+this.e.toISO(e):dn},t.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():dn},t.toISOTime=function(e){return this.isValid?this.s.toISOTime(e)+"/"+this.e.toISOTime(e):dn},t.toFormat=function(e,t){var n=(void 0===t?{}:t).separator,o=void 0===n?" – ":n;return this.isValid?""+this.s.toFormat(e)+o+this.e.toFormat(e):dn},t.toDuration=function(e,t){return this.isValid?this.e.diff(this.s,e,t):un.invalid(this.invalidReason)},t.mapEndpoints=function(t){return e.fromDateTimes(t(this.s),t(this.e))},o(e,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}(),pn=function(){function e(){}return e.hasDST=function(e){void 0===e&&(e=Qe.defaultZone);var t=po.now().setZone(e).set({month:12});return!e.universal&&t.offset!==t.set({month:6}).offset},e.isValidIANAZone=function(e){return He.isValidSpecifier(e)&&He.isValidZone(e)},e.normalizeZone=function(e){return Ye(e,Qe.defaultZone)},e.months=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,o=n.locale,i=void 0===o?null:o,r=n.numberingSystem,a=void 0===r?null:r,s=n.locObj,l=void 0===s?null:s,u=n.outputCalendar,c=void 0===u?"gregory":u;return(l||ct.create(i,a,c)).months(e)},e.monthsFormat=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,o=n.locale,i=void 0===o?null:o,r=n.numberingSystem,a=void 0===r?null:r,s=n.locObj,l=void 0===s?null:s,u=n.outputCalendar,c=void 0===u?"gregory":u;return(l||ct.create(i,a,c)).months(e,!0)},e.weekdays=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,o=n.locale,i=void 0===o?null:o,r=n.numberingSystem,a=void 0===r?null:r,s=n.locObj;return((void 0===s?null:s)||ct.create(i,a,null)).weekdays(e)},e.weekdaysFormat=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,o=n.locale,i=void 0===o?null:o,r=n.numberingSystem,a=void 0===r?null:r,s=n.locObj;return((void 0===s?null:s)||ct.create(i,a,null)).weekdays(e,!0)},e.meridiems=function(e){var t=(void 0===e?{}:e).locale,n=void 0===t?null:t;return ct.create(n).meridiems()},e.eras=function(e,t){void 0===e&&(e="short");var n=(void 0===t?{}:t).locale,o=void 0===n?null:n;return ct.create(o,null,"gregory").eras(e)},e.features=function(){var e=!1,t=!1,n=!1,o=!1;if(q()){e=!0,t=G(),o=Z();try{n="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(e){n=!1}}return{intl:e,intlTokens:t,zones:n,relative:o}},e}();function mn(e,t){var n=function(e){return e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()},o=n(t)-n(e);return Math.floor(un.fromMillis(o).as("days"))}function vn(e,t,n,o){var i=function(e,t,n){for(var o,i,r={},a=0,s=[["years",function(e,t){return t.year-e.year}],["quarters",function(e,t){return t.quarter-e.quarter}],["months",function(e,t){return t.month-e.month+12*(t.year-e.year)}],["weeks",function(e,t){var n=mn(e,t);return(n-n%7)/7}],["days",mn]];a<s.length;a++){var l=s[a],u=l[0],c=l[1];if(n.indexOf(u)>=0){var d;o=u;var f,h=c(e,t);(i=e.plus(((d={})[u]=h,d)))>t?(e=e.plus(((f={})[u]=h-1,f)),h-=1):e=i,r[u]=h}}return[e,r,i,o]}(e,t,n),r=i[0],a=i[1],s=i[2],l=i[3],u=t-r,c=n.filter((function(e){return["hours","minutes","seconds","milliseconds"].indexOf(e)>=0}));if(0===c.length){var d;if(s<t)s=r.plus(((d={})[l]=1,d));s!==r&&(a[l]=(a[l]||0)+u/(s-r))}var f,h=un.fromObject(Object.assign(a,o));return c.length>0?(f=un.fromMillis(u,o)).shiftTo.apply(f,c).plus(h):h}var gn={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},yn={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},bn=gn.hanidec.replace(/[\[|\]]/g,"").split("");function wn(e,t){var n=e.numberingSystem;return void 0===t&&(t=""),new RegExp(""+gn[n||"latn"]+t)}var kn="missing Intl.DateTimeFormat.formatToParts support";function Cn(e,t){return void 0===t&&(t=function(e){return e}),{regex:e,deser:function(e){var n=e[0];return t(function(e){var t=parseInt(e,10);if(isNaN(t)){t="";for(var n=0;n<e.length;n++){var o=e.charCodeAt(n);if(-1!==e[n].search(gn.hanidec))t+=bn.indexOf(e[n]);else for(var i in yn){var r=yn[i],a=r[0],s=r[1];o>=a&&o<=s&&(t+=o-a)}}return parseInt(t,10)}return t}(n))}}}var En="( |"+String.fromCharCode(160)+")",On=new RegExp(En,"g");function Tn(e){return e.replace(/\./g,"\\.?").replace(On,En)}function Pn(e){return e.replace(/\./g,"").replace(On," ").toLowerCase()}function _n(e,t){return null===e?null:{regex:RegExp(e.map(Tn).join("|")),deser:function(n){var o=n[0];return e.findIndex((function(e){return Pn(o)===Pn(e)}))+t}}}function Rn(e,t){return{regex:e,deser:function(e){return de(e[1],e[2])},groups:t}}function Sn(e){return{regex:e,deser:function(e){return e[0]}}}var An={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}};var xn=null;function In(e,t){if(e.literal)return e;var n=De.macroTokenToFormatOpts(e.val);if(!n)return e;var o=De.create(t,n).formatDateTimeParts((xn||(xn=po.fromMillis(1555555555555)),xn)).map((function(e){return function(e,t,n){var o=e.type,i=e.value;if("literal"===o)return{literal:!0,val:i};var r=n[o],a=An[o];return"object"==typeof a&&(a=a[r]),a?{literal:!1,val:a}:void 0}(e,0,n)}));return o.includes(void 0)?e:o}function Dn(e,t,n){var o=function(e,t){var n;return(n=Array.prototype).concat.apply(n,e.map((function(e){return In(e,t)})))}(De.parseFormat(n),e),i=o.map((function(t){return n=t,i=wn(o=e),r=wn(o,"{2}"),a=wn(o,"{3}"),s=wn(o,"{4}"),l=wn(o,"{6}"),u=wn(o,"{1,2}"),c=wn(o,"{1,3}"),d=wn(o,"{1,6}"),f=wn(o,"{1,9}"),h=wn(o,"{2,4}"),p=wn(o,"{4,6}"),m=function(e){return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:function(e){return e[0]},literal:!0};var t},v=function(e){if(n.literal)return m(e);switch(e.val){case"G":return _n(o.eras("short",!1),0);case"GG":return _n(o.eras("long",!1),0);case"y":return Cn(d);case"yy":case"kk":return Cn(h,ue);case"yyyy":case"kkkk":return Cn(s);case"yyyyy":return Cn(p);case"yyyyyy":return Cn(l);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return Cn(u);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return Cn(r);case"MMM":return _n(o.months("short",!0,!1),1);case"MMMM":return _n(o.months("long",!0,!1),1);case"LLL":return _n(o.months("short",!1,!1),1);case"LLLL":return _n(o.months("long",!1,!1),1);case"o":case"S":return Cn(c);case"ooo":case"SSS":return Cn(a);case"u":return Sn(f);case"a":return _n(o.meridiems(),0);case"E":case"c":return Cn(i);case"EEE":return _n(o.weekdays("short",!1,!1),1);case"EEEE":return _n(o.weekdays("long",!1,!1),1);case"ccc":return _n(o.weekdays("short",!0,!1),1);case"cccc":return _n(o.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Rn(new RegExp("([+-]"+u.source+")(?::("+r.source+"))?"),2);case"ZZZ":return Rn(new RegExp("([+-]"+u.source+")("+r.source+")?"),2);case"z":return Sn(/[a-z_+-/]{1,256}?/i);default:return m(e)}}(n)||{invalidReason:kn},v.token=n,v;var n,o,i,r,a,s,l,u,c,d,f,h,p,m,v})),r=i.find((function(e){return e.invalidReason}));if(r)return{input:t,tokens:o,invalidReason:r.invalidReason};var a=function(e){return["^"+e.map((function(e){return e.regex})).reduce((function(e,t){return e+"("+t.source+")"}),"")+"$",e]}(i),s=a[0],l=a[1],u=RegExp(s,"i"),c=function(e,t,n){var o=e.match(t);if(o){var i={},r=1;for(var a in n)if(X(n,a)){var s=n[a],l=s.groups?s.groups+1:1;!s.literal&&s.token&&(i[s.token.val[0]]=s.deser(o.slice(r,r+l))),r+=l}return[o,i]}return[o,{}]}(t,u,l),d=c[0],f=c[1],h=f?function(e){var t;return t=$(e.Z)?$(e.z)?null:He.create(e.z):new $e(e.Z),$(e.q)||(e.M=3*(e.q-1)+1),$(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),$(e.u)||(e.S=ne(e.u)),[Object.keys(e).reduce((function(t,n){var o=function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(n);return o&&(t[o]=e[n]),t}),{}),t]}(f):[null,null],p=h[0],v=h[1];if(X(f,"a")&&X(f,"H"))throw new m("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:o,regex:u,rawMatches:d,matches:f,result:p,zone:v}}var Mn=[0,31,59,90,120,151,181,212,243,273,304,334],Nn=[0,31,60,91,121,152,182,213,244,274,305,335];function Ln(e,t){return new Me("unit out of range","you specified "+t+" (of type "+typeof t+") as a "+e+", which is invalid")}function jn(e,t,n){var o=new Date(Date.UTC(e,t-1,n)).getUTCDay();return 0===o?7:o}function Vn(e,t,n){return n+(ie(e)?Nn:Mn)[t-1]}function Bn(e,t){var n=ie(e)?Nn:Mn,o=n.findIndex((function(e){return e<t}));return{month:o+1,day:t-n[o]}}function Fn(e){var t,n=e.year,o=e.month,i=e.day,r=Vn(n,o,i),a=jn(n,o,i),s=Math.floor((r-a+10)/7);return s<1?s=le(t=n-1):s>le(n)?(t=n+1,s=1):t=n,Object.assign({weekYear:t,weekNumber:s,weekday:a},me(e))}function Un(e){var t,n=e.weekYear,o=e.weekNumber,i=e.weekday,r=jn(n,1,4),a=re(n),s=7*o+i-r-3;s<1?s+=re(t=n-1):s>a?(t=n+1,s-=re(n)):t=n;var l=Bn(t,s),u=l.month,c=l.day;return Object.assign({year:t,month:u,day:c},me(e))}function Hn(e){var t=e.year,n=Vn(t,e.month,e.day);return Object.assign({year:t,ordinal:n},me(e))}function Wn(e){var t=e.year,n=Bn(t,e.ordinal),o=n.month,i=n.day;return Object.assign({year:t,month:o,day:i},me(e))}function $n(e){var t=Y(e.year),n=Q(e.month,1,12),o=Q(e.day,1,ae(e.year,e.month));return t?n?!o&&Ln("day",e.day):Ln("month",e.month):Ln("year",e.year)}function zn(e){var t=e.hour,n=e.minute,o=e.second,i=e.millisecond,r=Q(t,0,23)||24===t&&0===n&&0===o&&0===i,a=Q(n,0,59),s=Q(o,0,59),l=Q(i,0,999);return r?a?s?!l&&Ln("millisecond",i):Ln("second",o):Ln("minute",n):Ln("hour",t)}var Yn="Invalid DateTime",qn=864e13;function Gn(e){return new Me("unsupported zone",'the zone "'+e.name+'" is not supported')}function Zn(e){return null===e.weekData&&(e.weekData=Fn(e.c)),e.weekData}function Jn(e,t){var n={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new po(Object.assign({},n,t,{old:n}))}function Kn(e,t,n){var o=e-60*t*1e3,i=n.offset(o);if(t===i)return[o,t];o-=60*(i-t)*1e3;var r=n.offset(o);return i===r?[o,i]:[e-60*Math.min(i,r)*1e3,Math.max(i,r)]}function Xn(e,t){var n=new Date(e+=60*t*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function Qn(e,t,n){return Kn(se(e),t,n)}function eo(e,t){var n=e.o,o=e.c.year+Math.trunc(t.years),i=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),r=Object.assign({},e.c,{year:o,month:i,day:Math.min(e.c.day,ae(o,i))+Math.trunc(t.days)+7*Math.trunc(t.weeks)}),a=un.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),s=Kn(se(r),n,e.zone),l=s[0],u=s[1];return 0!==a&&(l+=a,u=e.zone.offset(l)),{ts:l,o:u}}function to(e,t,n,o,i){var r=n.setZone,a=n.zone;if(e&&0!==Object.keys(e).length){var s=t||a,l=po.fromObject(Object.assign(e,n,{zone:s,setZone:void 0}));return r?l:l.setZone(a)}return po.invalid(new Me("unparsable",'the input "'+i+"\" can't be parsed as "+o))}function no(e,t,n){return void 0===n&&(n=!0),e.isValid?De.create(ct.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(e,t):null}function oo(e,t){var n=t.suppressSeconds,o=void 0!==n&&n,i=t.suppressMilliseconds,r=void 0!==i&&i,a=t.includeOffset,s=t.includePrefix,l=void 0!==s&&s,u=t.includeZone,c=void 0!==u&&u,d=t.spaceZone,f=void 0!==d&&d,h=t.format,p=void 0===h?"extended":h,m="basic"===p?"HHmm":"HH:mm";o&&0===e.second&&0===e.millisecond||(m+="basic"===p?"ss":":ss",r&&0===e.millisecond||(m+=".SSS")),(c||a)&&f&&(m+=" "),c?m+="z":a&&(m+="basic"===p?"ZZZ":"ZZ");var v=no(e,m);return l&&(v="T"+v),v}var io={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},ro={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},ao={ordinal:1,hour:0,minute:0,second:0,millisecond:0},so=["year","month","day","hour","minute","second","millisecond"],lo=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],uo=["year","ordinal","hour","minute","second","millisecond"];function co(e){var t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new v(e);return t}function fo(e,t){for(var n,o=c(so);!(n=o()).done;){var i=n.value;$(e[i])&&(e[i]=io[i])}var r=$n(e)||zn(e);if(r)return po.invalid(r);var a=Qe.now(),s=Qn(e,t.offset(a),t),l=s[0],u=s[1];return new po({ts:l,zone:t,o:u})}function ho(e,t,n){var o=!!$(n.round)||n.round,i=function(e,i){return e=oe(e,o||n.calendary?0:2,!0),t.loc.clone(n).relFormatter(n).format(e,i)},r=function(o){return n.calendary?t.hasSame(e,o)?0:t.startOf(o).diff(e.startOf(o),o).get(o):t.diff(e,o).get(o)};if(n.unit)return i(r(n.unit),n.unit);for(var a,s=c(n.units);!(a=s()).done;){var l=a.value,u=r(l);if(Math.abs(u)>=1)return i(u,l)}return i(e>t?-0:0,n.units[n.units.length-1])}var po=function(){function e(e){var t=e.zone||Qe.defaultZone,n=e.invalid||(Number.isNaN(e.ts)?new Me("invalid input"):null)||(t.isValid?null:Gn(t));this.ts=$(e.ts)?Qe.now():e.ts;var o=null,i=null;if(!n)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t)){var r=[e.old.c,e.old.o];o=r[0],i=r[1]}else{var a=t.offset(this.ts);o=Xn(this.ts,a),o=(n=Number.isNaN(o.year)?new Me("invalid input"):null)?null:o,i=n?null:a}this._zone=t,this.loc=e.loc||ct.create(),this.invalid=n,this.weekData=null,this.c=o,this.o=i,this.isLuxonDateTime=!0}e.now=function(){return new e({})},e.local=function(t,n,o,i,r,a,s){return $(t)?e.now():fo({year:t,month:n,day:o,hour:i,minute:r,second:a,millisecond:s},Qe.defaultZone)},e.utc=function(t,n,o,i,r,a,s){return $(t)?new e({ts:Qe.now(),zone:$e.utcInstance}):fo({year:t,month:n,day:o,hour:i,minute:r,second:a,millisecond:s},$e.utcInstance)},e.fromJSDate=function(t,n){void 0===n&&(n={});var o,i=(o=t,"[object Date]"===Object.prototype.toString.call(o)?t.valueOf():NaN);if(Number.isNaN(i))return e.invalid("invalid input");var r=Ye(n.zone,Qe.defaultZone);return r.isValid?new e({ts:i,zone:r,loc:ct.fromObject(n)}):e.invalid(Gn(r))},e.fromMillis=function(t,n){if(void 0===n&&(n={}),z(t))return t<-qn||t>qn?e.invalid("Timestamp out of range"):new e({ts:t,zone:Ye(n.zone,Qe.defaultZone),loc:ct.fromObject(n)});throw new g("fromMillis requires a numerical input, but received a "+typeof t+" with value "+t)},e.fromSeconds=function(t,n){if(void 0===n&&(n={}),z(t))return new e({ts:1e3*t,zone:Ye(n.zone,Qe.defaultZone),loc:ct.fromObject(n)});throw new g("fromSeconds requires a numerical input")},e.fromObject=function(t){var n=Ye(t.zone,Qe.defaultZone);if(!n.isValid)return e.invalid(Gn(n));var o=Qe.now(),i=n.offset(o),r=he(t,co,["zone","locale","outputCalendar","numberingSystem"]),a=!$(r.ordinal),s=!$(r.year),l=!$(r.month)||!$(r.day),u=s||l,d=r.weekYear||r.weekNumber,f=ct.fromObject(t);if((u||a)&&d)throw new m("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&a)throw new m("Can't mix ordinal dates with month/day");var h,p,v=d||r.weekday&&!u,g=Xn(o,i);v?(h=lo,p=ro,g=Fn(g)):a?(h=uo,p=ao,g=Hn(g)):(h=so,p=io);for(var y,b=!1,w=c(h);!(y=w()).done;){var k=y.value;$(r[k])?r[k]=b?p[k]:g[k]:b=!0}var C=v?function(e){var t=Y(e.weekYear),n=Q(e.weekNumber,1,le(e.weekYear)),o=Q(e.weekday,1,7);return t?n?!o&&Ln("weekday",e.weekday):Ln("week",e.week):Ln("weekYear",e.weekYear)}(r):a?function(e){var t=Y(e.year),n=Q(e.ordinal,1,re(e.year));return t?!n&&Ln("ordinal",e.ordinal):Ln("year",e.year)}(r):$n(r),E=C||zn(r);if(E)return e.invalid(E);var O=Qn(v?Un(r):a?Wn(r):r,i,n),T=new e({ts:O[0],zone:n,o:O[1],loc:f});return r.weekday&&u&&t.weekday!==T.weekday?e.invalid("mismatched weekday","you can't specify both a weekday of "+r.weekday+" and a date of "+T.toISO()):T},e.fromISO=function(e,t){void 0===t&&(t={});var n=function(e){return ht(e,[Ft,$t],[Ut,zt],[Ht,Yt],[Wt,qt])}(e);return to(n[0],n[1],t,"ISO 8601",e)},e.fromRFC2822=function(e,t){void 0===t&&(t={});var n=function(e){return ht(function(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[Dt,Mt])}(e);return to(n[0],n[1],t,"RFC 2822",e)},e.fromHTTP=function(e,t){void 0===t&&(t={});var n=function(e){return ht(e,[Nt,Vt],[Lt,Vt],[jt,Bt])}(e);return to(n[0],n[1],t,"HTTP",t)},e.fromFormat=function(t,n,o){if(void 0===o&&(o={}),$(t)||$(n))throw new g("fromFormat requires an input string and a format");var i=o,r=i.locale,a=void 0===r?null:r,s=i.numberingSystem,l=void 0===s?null:s,u=function(e,t,n){var o=Dn(e,t,n);return[o.result,o.zone,o.invalidReason]}(ct.fromOpts({locale:a,numberingSystem:l,defaultToEN:!0}),t,n),c=u[0],d=u[1],f=u[2];return f?e.invalid(f):to(c,d,o,"format "+n,t)},e.fromString=function(t,n,o){return void 0===o&&(o={}),e.fromFormat(t,n,o)},e.fromSQL=function(e,t){void 0===t&&(t={});var n=function(e){return ht(e,[Zt,Kt],[Jt,Xt])}(e);return to(n[0],n[1],t,"SQL",e)},e.invalid=function(t,n){if(void 0===n&&(n=null),!t)throw new g("need to specify a reason the DateTime is invalid");var o=t instanceof Me?t:new Me(t,n);if(Qe.throwOnInvalid)throw new f(o);return new e({invalid:o})},e.isDateTime=function(e){return e&&e.isLuxonDateTime||!1};var t=e.prototype;return t.get=function(e){return this[e]},t.resolvedLocaleOpts=function(e){void 0===e&&(e={});var t=De.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t.locale,numberingSystem:t.numberingSystem,outputCalendar:t.calendar}},t.toUTC=function(e,t){return void 0===e&&(e=0),void 0===t&&(t={}),this.setZone($e.instance(e),t)},t.toLocal=function(){return this.setZone(Qe.defaultZone)},t.setZone=function(t,n){var o=void 0===n?{}:n,i=o.keepLocalTime,r=void 0!==i&&i,a=o.keepCalendarTime,s=void 0!==a&&a;if((t=Ye(t,Qe.defaultZone)).equals(this.zone))return this;if(t.isValid){var l=this.ts;if(r||s){var u=t.offset(this.ts);l=Qn(this.toObject(),u,t)[0]}return Jn(this,{ts:l,zone:t})}return e.invalid(Gn(t))},t.reconfigure=function(e){var t=void 0===e?{}:e,n=t.locale,o=t.numberingSystem,i=t.outputCalendar;return Jn(this,{loc:this.loc.clone({locale:n,numberingSystem:o,outputCalendar:i})})},t.setLocale=function(e){return this.reconfigure({locale:e})},t.set=function(e){if(!this.isValid)return this;var t,n=he(e,co,[]),o=!$(n.weekYear)||!$(n.weekNumber)||!$(n.weekday),i=!$(n.ordinal),r=!$(n.year),a=!$(n.month)||!$(n.day),s=r||a,l=n.weekYear||n.weekNumber;if((s||i)&&l)throw new m("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&i)throw new m("Can't mix ordinal dates with month/day");o?t=Un(Object.assign(Fn(this.c),n)):$(n.ordinal)?(t=Object.assign(this.toObject(),n),$(n.day)&&(t.day=Math.min(ae(t.year,t.month),t.day))):t=Wn(Object.assign(Hn(this.c),n));var u=Qn(t,this.o,this.zone);return Jn(this,{ts:u[0],o:u[1]})},t.plus=function(e){return this.isValid?Jn(this,eo(this,cn(e))):this},t.minus=function(e){return this.isValid?Jn(this,eo(this,cn(e).negate())):this},t.startOf=function(e){if(!this.isValid)return this;var t={},n=un.normalizeUnit(e);switch(n){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===n&&(t.weekday=1),"quarters"===n){var o=Math.ceil(this.month/3);t.month=3*(o-1)+1}return this.set(t)},t.endOf=function(e){var t;return this.isValid?this.plus((t={},t[e]=1,t)).startOf(e).minus(1):this},t.toFormat=function(e,t){return void 0===t&&(t={}),this.isValid?De.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):Yn},t.toLocaleString=function(e){return void 0===e&&(e=C),this.isValid?De.create(this.loc.clone(e),e).formatDateTime(this):Yn},t.toLocaleParts=function(e){return void 0===e&&(e={}),this.isValid?De.create(this.loc.clone(e),e).formatDateTimeParts(this):[]},t.toISO=function(e){return void 0===e&&(e={}),this.isValid?this.toISODate(e)+"T"+this.toISOTime(e):null},t.toISODate=function(e){var t=(void 0===e?{}:e).format,n="basic"===(void 0===t?"extended":t)?"yyyyMMdd":"yyyy-MM-dd";return this.year>9999&&(n="+"+n),no(this,n)},t.toISOWeekDate=function(){return no(this,"kkkk-'W'WW-c")},t.toISOTime=function(e){var t=void 0===e?{}:e,n=t.suppressMilliseconds,o=void 0!==n&&n,i=t.suppressSeconds,r=void 0!==i&&i,a=t.includeOffset,s=void 0===a||a,l=t.includePrefix,u=void 0!==l&&l,c=t.format;return oo(this,{suppressSeconds:r,suppressMilliseconds:o,includeOffset:s,includePrefix:u,format:void 0===c?"extended":c})},t.toRFC2822=function(){return no(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)},t.toHTTP=function(){return no(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},t.toSQLDate=function(){return no(this,"yyyy-MM-dd")},t.toSQLTime=function(e){var t=void 0===e?{}:e,n=t.includeOffset,o=void 0===n||n,i=t.includeZone;return oo(this,{includeOffset:o,includeZone:void 0!==i&&i,spaceZone:!0})},t.toSQL=function(e){return void 0===e&&(e={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(e):null},t.toString=function(){return this.isValid?this.toISO():Yn},t.valueOf=function(){return this.toMillis()},t.toMillis=function(){return this.isValid?this.ts:NaN},t.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},t.toJSON=function(){return this.toISO()},t.toBSON=function(){return this.toJSDate()},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.c);return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},t.diff=function(e,t,n){if(void 0===t&&(t="milliseconds"),void 0===n&&(n={}),!this.isValid||!e.isValid)return un.invalid(this.invalid||e.invalid,"created by diffing an invalid DateTime");var o,i=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},n),r=(o=t,Array.isArray(o)?o:[o]).map(un.normalizeUnit),a=e.valueOf()>this.valueOf(),s=vn(a?this:e,a?e:this,r,i);return a?s.negate():s},t.diffNow=function(t,n){return void 0===t&&(t="milliseconds"),void 0===n&&(n={}),this.diff(e.now(),t,n)},t.until=function(e){return this.isValid?hn.fromDateTimes(this,e):this},t.hasSame=function(e,t){if(!this.isValid)return!1;var n=e.valueOf(),o=this.setZone(e.zone,{keepLocalTime:!0});return o.startOf(t)<=n&&n<=o.endOf(t)},t.equals=function(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)},t.toRelative=function(t){if(void 0===t&&(t={}),!this.isValid)return null;var n=t.base||e.fromObject({zone:this.zone}),o=t.padding?this<n?-t.padding:t.padding:0,i=["years","months","days","hours","minutes","seconds"],r=t.unit;return Array.isArray(t.unit)&&(i=t.unit,r=void 0),ho(n,this.plus(o),Object.assign(t,{numeric:"always",units:i,unit:r}))},t.toRelativeCalendar=function(t){return void 0===t&&(t={}),this.isValid?ho(t.base||e.fromObject({zone:this.zone}),this,Object.assign(t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},e.min=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];if(!n.every(e.isDateTime))throw new g("min requires all arguments be DateTimes");return J(n,(function(e){return e.valueOf()}),Math.min)},e.max=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];if(!n.every(e.isDateTime))throw new g("max requires all arguments be DateTimes");return J(n,(function(e){return e.valueOf()}),Math.max)},e.fromFormatExplain=function(e,t,n){void 0===n&&(n={});var o=n,i=o.locale,r=void 0===i?null:i,a=o.numberingSystem,s=void 0===a?null:a;return Dn(ct.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),e,t)},e.fromStringExplain=function(t,n,o){return void 0===o&&(o={}),e.fromFormatExplain(t,n,o)},o(e,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?Zn(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?Zn(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?Zn(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?Hn(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?pn.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?pn.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?pn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?pn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.universal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return ie(this.year)}},{key:"daysInMonth",get:function(){return ae(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?re(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?le(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return C}},{key:"DATE_MED",get:function(){return E}},{key:"DATE_MED_WITH_WEEKDAY",get:function(){return O}},{key:"DATE_FULL",get:function(){return T}},{key:"DATE_HUGE",get:function(){return P}},{key:"TIME_SIMPLE",get:function(){return _}},{key:"TIME_WITH_SECONDS",get:function(){return R}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return S}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return A}},{key:"TIME_24_SIMPLE",get:function(){return x}},{key:"TIME_24_WITH_SECONDS",get:function(){return I}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return D}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return M}},{key:"DATETIME_SHORT",get:function(){return N}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return L}},{key:"DATETIME_MED",get:function(){return j}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return V}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return B}},{key:"DATETIME_FULL",get:function(){return F}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return U}},{key:"DATETIME_HUGE",get:function(){return H}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return W}}]),e}();function mo(e){if(po.isDateTime(e))return e;if(e&&e.valueOf&&z(e.valueOf()))return po.fromJSDate(e);if(e&&"object"==typeof e)return po.fromObject(e);throw new g("Unknown datetime argument: "+e+", of type "+typeof e)}t.ou=po,t.kI=pn},39008:function(e,t,n){var o,i;o=function(){var e="object",t="function",n="undefined",o=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],i=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],r=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],a=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function s(n,o){var i=typeof n[o];return i==t||!(i!=e||!n[o])||"unknown"==i}function l(t,n){return!(typeof t[n]!=e||!t[n])}function u(e,t){return typeof e[t]!=n}function c(e){return function(t,n){for(var o=n.length;o--;)if(!e(t,n[o]))return!1;return!0}}var d=c(s),f=c(l),h=c(u);function p(e){return e&&d(e,a)&&h(e,r)}function m(e){return l(e,"body")?e.body:e.getElementsByTagName("body")[0]}var v,g,y={},b=typeof window!=n&&typeof document!=n,w={isHostMethod:s,isHostObject:l,isHostProperty:u,areHostMethods:d,areHostObjects:f,areHostProperties:h,isTextRange:p,getBody:m,forEach:[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,o=e.length;n<o;++n)t(e[n],n)}},k={version:"1.3.1",initialized:!1,isBrowser:b,supported:!0,util:w,features:{},modules:y,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==n||rangyAutoInitialize}};function C(e){typeof console!=n&&s(console,"log")&&console.log(e)}function E(e,t){b&&t?alert(e):C(e)}function O(e){k.initialized=!0,k.supported=!1,E("Rangy is not supported in this environment. Reason: "+e,k.config.alertOnFail)}function T(e){E("Rangy warning: "+e,k.config.alertOnWarn)}k.fail=O,k.warn=T,{}.hasOwnProperty?(w.extend=v=function(e,t,n){var o,i;for(var r in t)t.hasOwnProperty(r)&&(o=e[r],i=t[r],n&&null!==o&&"object"==typeof o&&null!==i&&"object"==typeof i&&v(o,i,!0),e[r]=i);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},w.createOptions=function(e,t){var n={};return v(n,t),e&&v(n,e),n}):O("hasOwnProperty not supported"),b||O("Rangy can only run in a browser"),function(){var e;if(b){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(e){}}e||(e=function(e){for(var t=[],n=0,o=e.length;n<o;++n)t[n]=e[n];return t}),w.toArray=e}(),b&&(s(document,"addEventListener")?g=function(e,t,n){e.addEventListener(t,n,!1)}:s(document,"attachEvent")?g=function(e,t,n){e.attachEvent("on"+t,n)}:O("Document does not have required addEventListener or attachEvent method"),w.addListener=g);var P=[];function _(e){return e.message||e.description||String(e)}function R(){if(b&&!k.initialized){var e,t=!1,n=!1;s(document,"createRange")&&(e=document.createRange(),d(e,i)&&h(e,o)&&(t=!0));var r=m(document);if(r&&"body"==r.nodeName.toLowerCase())if(r&&s(r,"createTextRange")&&p(e=r.createTextRange())&&(n=!0),t||n){var a;for(var l in k.initialized=!0,k.features={implementsDomRange:t,implementsTextRange:n},y)(a=y[l])instanceof D&&a.init(a,k);for(var u=0,c=P.length;u<c;++u)try{P[u](k)}catch(e){C("Rangy init listener threw an exception. Continuing. Detail: "+_(e))}}else O("Neither Range nor TextRange are available");else O("No body element found")}}function S(e,t,n){n&&(e+=" in module "+n.name),k.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function A(e,t,n,o){e[t]=function(){return S(t,n,o),e[n].apply(e,w.toArray(arguments))}}w.deprecationNotice=S,w.createAliasForDeprecatedMethod=A,k.init=R,k.addInitListener=function(e){k.initialized?e(k):P.push(e)};var x=[];function I(e){e=e||window,R();for(var t=0,n=x.length;t<n;++t)x[t](e)}function D(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function M(e,t,n){var o=new D(e,t,(function(t){if(!t.initialized){t.initialized=!0;try{n(k,t),t.supported=!0}catch(t){C("Module '"+e+"' failed to load: "+_(t)),t.stack&&C(t.stack)}}}));return y[e]=o,o}function N(){}function L(){}k.addShimListener=function(e){x.push(e)},b&&(k.shim=k.createMissingNativeApi=I,A(k,"createMissingNativeApi","shim")),D.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,i=n.length;o<i;++o){if(t=n[o],!((e=y[t])&&e instanceof D))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error(e)},warn:function(e){k.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){k.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},k.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var o=M(e,n,t);k.initialized&&k.supported&&o.init()},k.createCoreModule=function(e,t,n){M(e,t,n)},k.RangePrototype=N,k.rangePrototype=new N,k.selectionPrototype=new L,k.createCoreModule("DomUtil",[],(function(e,t){var n="undefined",o=e.util,i=o.getBody;o.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),o.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var r=document.createElement("div");o.areHostMethods(r,["insertBefore","appendChild","cloneNode"]||0)||t.fail("Incomplete Element implementation"),o.isHostProperty(r,"innerHTML")||t.fail("Element is missing innerHTML property");var a=document.createTextNode("test");o.areHostMethods(a,["splitText","deleteData","insertData","appendData","cloneNode"]||0)||t.fail("Incomplete Text Node implementation");var s=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};function l(e){var t;return typeof e.namespaceURI==n||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function u(e){var t=e.parentNode;return 1==t.nodeType?t:null}function c(e){for(var t=0;e=e.previousSibling;)++t;return t}function d(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function f(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(s(o,n))return n;return null}function h(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function p(e,t){return h(e,t,!0)}function m(e,t,n){for(var o,i=n?e:e.parentNode;i;){if((o=i.parentNode)===t)return i;i=o}return null}function v(e){var t=e.nodeType;return 3==t||4==t||8==t}function g(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function y(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function b(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),y(o,e),n)for(var i,r=0;i=n[r++];)i.node==e&&i.offset>t?(i.node=o,i.offset-=t):i.node==e.parentNode&&i.offset>c(e)&&++i.offset;return o}function w(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=n)return e.ownerDocument;if(typeof e.document!=n)return e.document;if(e.parentNode)return w(e.parentNode);throw t.createError("getDocument: no document found for node")}function k(e){var o=w(e);if(typeof o.defaultView!=n)return o.defaultView;if(typeof o.parentWindow!=n)return o.parentWindow;throw t.createError("Cannot get a window object for node")}function C(e){if(typeof e.contentDocument!=n)return e.contentDocument;if(typeof e.contentWindow!=n)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function E(e){if(typeof e.contentWindow!=n)return e.contentWindow;if(typeof e.contentDocument!=n)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function O(e){return e&&o.isHostMethod(e,"setTimeout")&&o.isHostObject(e,"document")}function T(e,t,n){var i;if(e?o.isHostProperty(e,"nodeType")?i=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?C(e):w(e):O(e)&&(i=e.document):i=document,!i)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return i}function P(e){for(var t;t=e.parentNode;)e=t;return e}function _(e,n,o,i){var r,a,s,l,u;if(e==o)return n===i?0:n<i?-1:1;if(r=m(o,e,!0))return n<=c(r)?-1:1;if(r=m(e,o,!0))return c(r)<i?-1:1;if(!(a=f(e,o)))throw new Error("comparePoints error: nodes have no common ancestor");if((s=e===a?a:m(e,a,!0))===(l=o===a?a:m(o,a,!0)))throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(u=a.firstChild;u;){if(u===s)return-1;if(u===l)return 1;u=u.nextSibling}}var R,S=!1;function A(e){try{return e.parentNode,!1}catch(e){return!0}}function x(e){if(!e)return"[No node]";if(S&&A(e))return"[Broken node]";if(v(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+c(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function I(e){for(var t,n=w(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function D(e,t,n){var o=i(e),r=e.createElement("div");r.contentEditable=""+!!n,t&&(r.innerHTML=t);var a=o.firstChild;return a?o.insertBefore(r,a):o.appendChild(r),r}function M(e){return e.parentNode.removeChild(e)}function N(e){this.root=e,this._next=e}function L(e){return new N(e)}function j(e,t){this.node=e,this.offset=t}function V(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br />",S=A(n),e.features.crashyTextNodes=S}(),typeof window.getComputedStyle!=n?R=function(e,t){return k(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=n?R=function(e,t){return e.currentStyle?e.currentStyle[t]:""}:t.fail("No means of obtaining computed style properties found"),N.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},j.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},V.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},V.prototype.toString=function(){return this.message},e.dom={arrayContains:s,isHtmlNamespace:l,parentElement:u,getNodeIndex:c,getNodeLength:d,getCommonAncestor:f,isAncestorOf:h,isOrIsAncestorOf:p,getClosestAncestorIn:m,isCharacterDataNode:v,isTextOrCommentNode:g,insertAfter:y,splitDataNode:b,getDocument:w,getWindow:k,getIframeWindow:E,getIframeDocument:C,getBody:i,isWindow:O,getContentDocument:T,getRootContainer:P,comparePoints:_,isBrokenNode:A,inspectNode:x,getComputedStyleProperty:R,createTestElement:D,removeNode:M,fragmentFromNodeChildren:I,createIterator:L,DomPosition:j},e.DOMException=V})),k.createCoreModule("DomRange",["DomUtil"],(function(e,t){var n=e.dom,o=e.util,i=n.DomPosition,r=e.DOMException,a=n.isCharacterDataNode,s=n.getNodeIndex,l=n.isOrIsAncestorOf,u=n.getDocument,c=n.comparePoints,d=n.splitDataNode,f=n.getClosestAncestorIn,h=n.getNodeLength,p=n.arrayContains,m=n.getRootContainer,v=e.features.crashyTextNodes,g=n.removeNode;function y(e,t){return 3!=e.nodeType&&(l(e,t.startContainer)||l(e,t.endContainer))}function b(e){return e.document||u(e.startContainer)}function w(e){return m(e.startContainer)}function k(e){return new i(e.parentNode,s(e))}function C(e){return new i(e.parentNode,s(e)+1)}function E(e,t,o){var i=11==e.nodeType?e.firstChild:e;return a(t)?o==t.length?n.insertAfter(e,t):t.parentNode.insertBefore(e,0==o?t:d(t,o)):o>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[o]),i}function O(e,t,n){if(J(e),J(t),b(t)!=b(e))throw new r("WRONG_DOCUMENT_ERR");var o=c(e.startContainer,e.startOffset,t.endContainer,t.endOffset),i=c(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?o<=0&&i>=0:o<0&&i>0}function T(e){for(var t,n,o,i=b(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(o=e.getSubtreeIterator(),n.appendChild(T(o)),o.detach()),10==n.nodeType)throw new r("HIERARCHY_REQUEST_ERR");i.appendChild(n)}return i}function P(e,t,o){var i,r,a,s;for(o=o||{stop:!1};a=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(a))return void(o.stop=!0);if(P(s=e.getSubtreeIterator(),t,o),s.detach(),o.stop)return}else for(i=n.createIterator(a);r=i.next();)if(!1===t(r))return void(o.stop=!0)}function _(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(_(t=e.getSubtreeIterator()),t.detach()):e.remove()}function R(e){for(var t,n,o=b(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(R(n)),n.detach()):e.remove(),10==t.nodeType)throw new r("HIERARCHY_REQUEST_ERR");o.appendChild(t)}return o}function S(e,t,n){var o,i=!(!t||!t.length),r=!!n;i&&(o=new RegExp("^("+t.join("|")+")$"));var s=[];return P(new x(e,!1),(function(t){if((!i||o.test(t.nodeType))&&(!r||n(t))){var l=e.startContainer;if(t!=l||!a(l)||e.startOffset!=l.length){var u=e.endContainer;t==u&&a(u)&&0==e.endOffset||s.push(t)}}})),s}function A(e){return"["+(void 0===e.getName?"Range":e.getName())+"("+n.inspectNode(e.startContainer)+":"+e.startOffset+", "+n.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function x(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&a(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||a(this.sc)?f(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||a(this.ec)?f(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}x.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,a(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!a(n)||n!==this.sc&&n!==this.ec?n.parentNode&&g(n):(e=n===this.sc?this.so:0)!=(t=n===this.ec?this.eo:n.length)&&n.deleteData(e,t-e)},isPartiallySelectedSubtree:function(){return y(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)(e=this.range.cloneRange()).collapse(!1);else{e=new ge(b(this.range));var t=this._current,n=t,o=0,i=t,r=h(t);l(t,this.sc)&&(n=this.sc,o=this.so),l(t,this.ec)&&(i=this.ec,r=this.eo),ve(e,n,o,i,r)}return new x(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var I=[1,3,4,5,7,8,10],D=[2,9,11],M=[5,6,10,12],N=[1,3,4,5,7,8,10,11],L=[1,3,4,5,7,8];function j(e){return function(t,n){for(var o,i=n?t:t.parentNode;i;){if(o=i.nodeType,p(e,o))return i;i=i.parentNode}return null}}var V=j([9,11]),B=j(M),F=j([6,10,12]),U=j([1]);function H(e,t){if(F(e,t))throw new r("INVALID_NODE_TYPE_ERR")}function W(e,t){if(!p(t,e.nodeType))throw new r("INVALID_NODE_TYPE_ERR")}function $(e,t){if(t<0||t>(a(e)?e.length:e.childNodes.length))throw new r("INDEX_SIZE_ERR")}function z(e,t){if(V(e,!0)!==V(t,!0))throw new r("WRONG_DOCUMENT_ERR")}function Y(e){if(B(e,!0))throw new r("NO_MODIFICATION_ALLOWED_ERR")}function q(e,t){if(!e)throw new r(t)}function G(e,t){return t<=(a(e)?e.length:e.childNodes.length)}function Z(e){return!!e.startContainer&&!!e.endContainer&&!(v&&(n.isBrokenNode(e.startContainer)||n.isBrokenNode(e.endContainer)))&&m(e.startContainer)==m(e.endContainer)&&G(e.startContainer,e.startOffset)&&G(e.endContainer,e.endOffset)}function J(e){if(!Z(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}var K=document.createElement("style"),X=!1;try{K.innerHTML="<b>x</b>",X=3==K.firstChild.nodeType}catch(e){}e.features.htmlParsingConforms=X;var Q=X?function(e){var t=this.startContainer,o=u(t);if(!t)throw new r("INVALID_STATE_ERR");var i=null;return 1==t.nodeType?i=t:a(t)&&(i=n.parentElement(t)),(i=null===i||"HTML"==i.nodeName&&n.isHtmlNamespace(u(i).documentElement)&&n.isHtmlNamespace(i)?o.createElement("body"):i.cloneNode(!1)).innerHTML=e,n.fragmentFromNodeChildren(i)}:function(e){var t=b(this).createElement("body");return t.innerHTML=e,n.fragmentFromNodeChildren(t)};function ee(e,t){J(e);var n=e.startContainer,o=e.startOffset,i=e.endContainer,r=e.endOffset,l=n===i;a(i)&&r>0&&r<i.length&&d(i,r,t),a(n)&&o>0&&o<n.length&&(n=d(n,o,t),l?(r-=o,i=n):i==n.parentNode&&r>=s(n)&&r++,o=0),e.setStartAndEnd(n,o,i,r)}function te(e){J(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}var ne=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],oe=0,ie=1,re=2,ae=3,se=0,le=1,ue=2,ce=3;function de(e){e.START_TO_START=oe,e.START_TO_END=ie,e.END_TO_END=re,e.END_TO_START=ae,e.NODE_BEFORE=se,e.NODE_AFTER=le,e.NODE_BEFORE_AND_AFTER=ue,e.NODE_INSIDE=ce}function fe(e){de(e),de(e.prototype)}function he(e,t){return function(){J(this);var n,o=this.startContainer,i=this.startOffset,r=this.commonAncestorContainer,a=new x(this,!0);o!==r&&(o=(n=C(f(o,r,!0))).node,i=n.offset),P(a,Y),a.reset();var s=e(a);return a.detach(),t(this,o,i,o,i),s}}function pe(t,n){function i(e,t){return function(n){W(n,I),W(m(n),D);var o=(e?k:C)(n);(t?r:l)(this,o.node,o.offset)}}function r(e,t,o){var i=e.endContainer,r=e.endOffset;t===e.startContainer&&o===e.startOffset||(m(t)==m(i)&&1!=c(t,o,i,r)||(i=t,r=o),n(e,t,o,i,r))}function l(e,t,o){var i=e.startContainer,r=e.startOffset;t===e.endContainer&&o===e.endOffset||(m(t)==m(i)&&-1!=c(t,o,i,r)||(i=t,r=o),n(e,i,r,t,o))}var u=function(){};u.prototype=e.rangePrototype,t.prototype=new u,o.extend(t.prototype,{setStart:function(e,t){H(e,!0),$(e,t),r(this,e,t)},setEnd:function(e,t){H(e,!0),$(e,t),l(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],o=e[1],i=t,r=o;switch(e.length){case 3:r=e[2];break;case 4:i=e[2],r=e[3]}H(t,!0),$(t,o),H(i,!0),$(i,r),n(this,t,o,i,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:i(!0,!0),setStartAfter:i(!1,!0),setEndBefore:i(!0,!1),setEndAfter:i(!1,!1),collapse:function(e){J(this),e?n(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):n(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){H(e,!0),n(this,e,0,e,h(e))},selectNode:function(e){H(e,!1),W(e,I);var t=k(e),o=C(e);n(this,t.node,t.offset,o.node,o.offset)},extractContents:he(R,n),deleteContents:he(_,n),canSurroundContents:function(){J(this),Y(this.startContainer),Y(this.endContainer);var e=new x(this,!0),t=e._first&&y(e._first,this)||e._last&&y(e._last,this);return e.detach(),!t},splitBoundaries:function(){ee(this)},splitBoundariesPreservingPositions:function(e){ee(this,e)},normalizeBoundaries:function(){J(this);var e,t=this.startContainer,o=this.startOffset,i=this.endContainer,r=this.endOffset,l=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(i=e,r=e.length,e.appendData(t.data),g(t))},u=function(e){var n=e.previousSibling;if(n&&n.nodeType==e.nodeType){t=e;var a=e.length;if(o=n.length,e.insertData(0,n.data),g(n),t==i)r+=o,i=t;else if(i==e.parentNode){var l=s(e);r==l?(i=e,r=a):r>l&&r--}}},c=!0;if(a(i))r==i.length?l(i):0==r&&(e=i.previousSibling)&&e.nodeType==i.nodeType&&(r=e.length,t==i&&(c=!1),e.appendData(i.data),g(i),i=e);else{if(r>0){var d=i.childNodes[r-1];d&&a(d)&&l(d)}c=!this.collapsed}if(c){if(a(t))0==o?u(t):o==t.length&&(e=t.nextSibling)&&e.nodeType==t.nodeType&&(i==e&&(i=t,r+=t.length),t.appendData(e.data),g(e));else if(o<t.childNodes.length){var f=t.childNodes[o];f&&a(f)&&u(f)}}else t=i,o=r;n(this,t,o,i,r)},collapseToPoint:function(e,t){H(e,!0),$(e,t),this.setStartAndEnd(e,t)},parentElement:function(){return J(this),this.commonAncestorContainer?U(this.commonAncestorContainer,!0):null}}),fe(t)}function me(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:n.getCommonAncestor(e.startContainer,e.endContainer)}function ve(e,t,o,i,r){e.startContainer=t,e.startOffset=o,e.endContainer=i,e.endOffset=r,e.document=n.getDocument(t),me(e)}function ge(e){ve(this,e,0,e,0)}o.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){var n,o,i,r;J(this),z(this.startContainer,t.startContainer);var a=e==ae||e==oe?"start":"end",s=e==ie||e==oe?"start":"end";return n=this[a+"Container"],o=this[a+"Offset"],i=t[s+"Container"],r=t[s+"Offset"],c(n,o,i,r)},insertNode:function(e){if(J(this),W(e,N),Y(this.startContainer),l(e,this.startContainer))throw new r("HIERARCHY_REQUEST_ERR");var t=E(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){var e,t;if(J(this),this.collapsed)return b(this).createDocumentFragment();if(this.startContainer===this.endContainer&&a(this.startContainer))return(e=this.startContainer.cloneNode(!0)).data=e.data.slice(this.startOffset,this.endOffset),(t=b(this).createDocumentFragment()).appendChild(e),t;var n=new x(this,!0);return e=T(n),n.detach(),e},canSurroundContents:function(){J(this),Y(this.startContainer),Y(this.endContainer);var e=new x(this,!0),t=e._first&&y(e._first,this)||e._last&&y(e._last,this);return e.detach(),!t},surroundContents:function(e){if(W(e,L),!this.canSurroundContents())throw new r("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);E(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){J(this);for(var e,t=new ge(b(this)),n=ne.length;n--;)t[e=ne[n]]=this[e];return t},toString:function(){J(this);var e=this.startContainer;if(e===this.endContainer&&a(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new x(this,!0);return P(n,(function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)})),n.detach(),t.join("")},compareNode:function(e){J(this);var t=e.parentNode,n=s(e);if(!t)throw new r("NOT_FOUND_ERR");var o=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return o<0?i>0?ue:se:i>0?le:ce},comparePoint:function(e,t){return J(this),q(e,"HIERARCHY_REQUEST_ERR"),z(e,this.startContainer),c(e,t,this.startContainer,this.startOffset)<0?-1:c(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Q,toHtml:function(){return te(this)},intersectsNode:function(e,t){if(J(this),m(e)!=w(this))return!1;var n=e.parentNode,o=s(e);if(!n)return!0;var i=c(n,o,this.endContainer,this.endOffset),r=c(n,o+1,this.startContainer,this.startOffset);return t?i<=0&&r>=0:i<0&&r>0},isPointInRange:function(e,t){return J(this),q(e,"HIERARCHY_REQUEST_ERR"),z(e,this.startContainer),c(e,t,this.startContainer,this.startOffset)>=0&&c(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return O(this,e,!1)},intersectsOrTouchesRange:function(e){return O(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=c(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=c(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==c(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==c(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new r("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ce},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,h(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return J(this),S(this,e,t)},getDocument:function(){return b(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var o=b(this),i=e.createRange(o);t=t||n.getBody(o),i.selectNodeContents(t);var r=this.intersection(i),a=0,s=0;return r&&(i.setEnd(r.startContainer,r.startOffset),s=(a=i.toString().length)+r.toString().length),{start:a,end:s,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,i,r,a,s=[t],l=!1,u=!1;!u&&(o=s.pop());)if(3==o.nodeType)i=n+o.length,!l&&e.start>=n&&e.start<=i&&(this.setStart(o,e.start-n),l=!0),l&&e.end>=n&&e.end<=i&&(this.setEnd(o,e.end-n),u=!0),n=i;else for(r=(a=o.childNodes).length;r--;)s.push(a[r])},getName:function(){return"DomRange"},equals:function(e){return ge.rangesEqual(this,e)},isValid:function(){return Z(this)},inspect:function(){return A(this)},detach:function(){}}),pe(ge,ve),o.extend(ge,{rangeProperties:ne,RangeIterator:x,copyComparisonConstants:fe,createPrototypeRange:pe,inspect:A,toHtml:te,getRangeDocument:b,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=ge})),k.createCoreModule("WrappedRange",["DomRange"],(function(e,t){var n,o,i=e.dom,r=e.util,a=i.DomPosition,s=e.DomRange,l=i.getBody,u=i.getContentDocument,c=i.isCharacterDataNode;if(e.features.implementsDomRange&&function(){var o,a,c=s.rangeProperties;function d(e){for(var t,n=c.length;n--;)e[t=c[n]]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function f(e,t,n,o,i){var r=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==o||e.endOffset!=i,s=!e.equals(e.nativeRange);(r||a||s)&&(e.setEnd(o,i),e.setStart(t,n))}n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,d(this)},s.createPrototypeRange(n,f),(o=n.prototype).selectNode=function(e){this.nativeRange.selectNode(e),d(this)},o.cloneContents=function(){return this.nativeRange.cloneContents()},o.surroundContents=function(e){this.nativeRange.surroundContents(e),d(this)},o.collapse=function(e){this.nativeRange.collapse(e),d(this)},o.cloneRange=function(){return new n(this.nativeRange.cloneRange())},o.refresh=function(){d(this)},o.toString=function(){return this.nativeRange.toString()};var h=document.createTextNode("test");l(document).appendChild(h);var p=document.createRange();p.setStart(h,0),p.setEnd(h,0);try{p.setStart(h,1),o.setStart=function(e,t){this.nativeRange.setStart(e,t),d(this)},o.setEnd=function(e,t){this.nativeRange.setEnd(e,t),d(this)},a=function(e){return function(t){this.nativeRange[e](t),d(this)}}}catch(e){o.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}d(this)},o.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}d(this)},a=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(o){this.nativeRange[t](n),this.nativeRange[e](n)}d(this)}}}o.setStartBefore=a("setStartBefore","setEndBefore"),o.setStartAfter=a("setStartAfter","setEndAfter"),o.setEndBefore=a("setEndBefore","setStartBefore"),o.setEndAfter=a("setEndAfter","setStartAfter"),o.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},p.selectNodeContents(h),p.setEnd(h,3);var m=document.createRange();m.selectNodeContents(h),m.setEnd(h,4),m.setStart(h,2),-1==p.compareBoundaryPoints(p.START_TO_END,m)&&1==p.compareBoundaryPoints(p.END_TO_START,m)?o.compareBoundaryPoints=function(e,t){return e==(t=t.nativeRange||t).START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:o.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var v=document.createElement("div");v.innerHTML="123";var g=v.firstChild,y=l(document);y.appendChild(v),p.setStart(g,1),p.setEnd(g,2),p.deleteContents(),"13"==g.data&&(o.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},o.extractContents=function(){var e=this.nativeRange.extractContents();return d(this),e}),y.removeChild(v),y=null,r.isHostMethod(p,"createContextualFragment")&&(o.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(h),o.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return(e=u(e,t,"createNativeRange")).createRange()}}(),e.features.implementsTextRange){var d=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();(n=e.duplicate()).collapse(!1);var r=n.parentElement(),a=o==r?o:i.getCommonAncestor(o,r);return a==t?a:i.getCommonAncestor(t,a)},f=function(e){return 0==e.compareEndPoints("StartToEnd",e)},h=function(e,t,n,o,r){var s=e.duplicate();s.collapse(n);var l=s.parentElement();if(i.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var u=new a(l.parentNode,i.getNodeIndex(l));return{boundaryPosition:u,nodeInfo:{nodeIndex:u.offset,containerElement:u.node}}}var d=i.getDocument(l).createElement("span");d.parentNode&&i.removeNode(d);for(var f,h,p,m,v,g=n?"StartToStart":"StartToEnd",y=r&&r.containerElement==l?r.nodeIndex:0,b=l.childNodes.length,w=b,k=w;k==b?l.appendChild(d):l.insertBefore(d,l.childNodes[k]),s.moveToElementText(d),0!=(f=s.compareEndPoints(g,e))&&y!=w;){if(-1==f){if(w==y+1)break;y=k}else w=w==y+1?y:k;k=Math.floor((y+w)/2),l.removeChild(d)}if(v=d.nextSibling,-1==f&&v&&c(v)){var C;if(s.setEndPoint(n?"EndToStart":"EndToEnd",e),/[\r\n]/.test(v.data)){var E=s.duplicate(),O=E.text.replace(/\r\n/g,"\r").length;for(C=E.moveStart("character",O);-1==(f=E.compareEndPoints("StartToEnd",E));)C++,E.moveStart("character",1)}else C=s.text.length;m=new a(v,C)}else h=(o||!n)&&d.previousSibling,m=(p=(o||n)&&d.nextSibling)&&c(p)?new a(p,0):h&&c(h)?new a(h,h.data.length):new a(l,i.getNodeIndex(d));return i.removeNode(d),{boundaryPosition:m,nodeInfo:{nodeIndex:k,containerElement:l}}},p=function(e,t){var n,o,r,a,s=e.offset,u=i.getDocument(e.node),d=l(u).createTextRange(),f=c(e.node);return f?o=(n=e.node).parentNode:(n=s<(a=e.node.childNodes).length?a[s]:null,o=e.node),(r=u.createElement("span")).innerHTML="&#feff;",n?o.insertBefore(r,n):o.appendChild(r),d.moveToElementText(r),d.collapse(!t),o.removeChild(r),f&&d[t?"moveStart":"moveEnd"]("character",s),d};(o=function(e){this.textRange=e,this.refresh()}).prototype=new s(document),o.prototype.refresh=function(){var e,t,n,o=d(this.textRange);f(this.textRange)?t=e=h(this.textRange,o,!0,!0).boundaryPosition:(e=(n=h(this.textRange,o,!0,!1)).boundaryPosition,t=h(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},o.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(o);var m=function(e){if(e.collapsed)return p(new a(e.startContainer,e.startOffset),!0);var t=p(new a(e.startContainer,e.startOffset),!0),n=p(new a(e.endContainer,e.endOffset),!1),o=l(s.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o};if(o.rangeToTextRange=m,o.prototype.toTextRange=function(){return m(this)},e.WrappedTextRange=o,!e.features.implementsDomRange||e.config.preferTextRange){var v=Function("return this;")();void 0===v.Range&&(v.Range=o),e.createNativeRange=function(e){return e=u(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=o}}e.createRange=function(n){return n=u(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=u(e,t,"createRangyRange"),new s(e)},r.createAliasForDeprecatedMethod(e,"createIframeRange","createRange"),r.createAliasForDeprecatedMethod(e,"createIframeRangyRange","createRangyRange"),e.addShimListener((function(t){var n=t.document;void 0===n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null}))})),k.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],(function(e,t){e.config.checkSelectionRanges=!0;var n,o,i="boolean",r="number",a=e.dom,s=e.util,l=s.isHostMethod,u=e.DomRange,c=e.WrappedRange,d=e.DOMException,f=a.DomPosition,h=e.features,p="Control",m=a.getDocument,v=a.getBody,g=u.rangesEqual;function y(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function b(e,n){if(e){if(a.isWindow(e))return e;if(e instanceof J)return e.win;var o=a.getContentDocument(e,t,n);return a.getWindow(o)}return window}function w(e){return b(e,"getWinSelection").getSelection()}function k(e){return b(e,"getDocSelection").document.selection}function C(e){var t=!1;return e.anchorNode&&(t=1==a.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}var E=l(window,"getSelection"),O=s.isHostObject(document,"selection");h.implementsWinGetSelection=E,h.implementsDocSelection=O;var T=O&&(!E||e.config.preferTextRange);if(T)n=k,e.isSelectionValid=function(e){var t=b(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||m(n.createRange().parentElement())==t};else{if(!E)return t.fail("Neither document.selection or window.getSelection() detected."),!1;n=w,e.isSelectionValid=function(){return!0}}e.getNativeSelection=n;var P=n();if(!P)return t.fail("Native selection was null (possibly issue 138?)"),!1;var _=e.createNativeRange(document),R=v(document),S=s.areHostProperties(P,["anchorNode","focusNode","anchorOffset","focusOffset"]);h.selectionHasAnchorAndFocus=S;var A=l(P,"extend");h.selectionHasExtend=A;var x=l(P,"setBaseAndExtent");h.selectionHasSetBaseAndExtent=x;var I=typeof P.rangeCount==r;h.selectionHasRangeCount=I;var D=!1,M=!0,N=A?function(t,n){var o=u.getRangeDocument(n),i=e.createRange(o);i.collapseToPoint(n.endContainer,n.endOffset),t.addRange(W(i)),t.extend(n.startContainer,n.startOffset)}:null;s.areHostMethods(P,["addRange","getRangeAt","removeAllRanges"])&&typeof P.rangeCount==r&&h.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,o=n>1,i=[],r=C(t),s=0;s<n;++s)i[s]=t.getRangeAt(s);var l=a.createTestElement(document,"",!1),u=l.appendChild(document.createTextNode("   ")),c=document.createRange();if(c.setStart(u,1),c.collapse(!0),t.removeAllRanges(),t.addRange(c),M=1==t.rangeCount,t.removeAllRanges(),!o){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&parseInt(d[1])>=36)D=!1;else{var f=c.cloneRange();c.setStart(u,0),f.setEnd(u,3),f.setStart(u,2),t.addRange(c),t.addRange(f),D=2==t.rangeCount}}for(a.removeNode(l),t.removeAllRanges(),s=0;s<n;++s)0==s&&r?N?N(t,i[s]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[s])):t.addRange(i[s])}}(),h.selectionSupportsMultipleRanges=D,h.collapsedNonEditableSelectionsSupported=M;var L,j,V=!1;function B(e,t,n){var o=n?"end":"start",i=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function F(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function U(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0,H(e)}function H(e){e.type=0==e.rangeCount?"None":o(e)?"Caret":"Range"}function W(t){var n;return t instanceof u?((n=e.createNativeRange(t.getDocument())).setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof c?n=t.nativeRange:h.implementsDomRange&&t instanceof a.getWindow(t.startContainer).Range&&(n=t),n}function $(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!a.isAncestorOf(e[0],e[t]))return!1;return!0}function z(e){var n=e.getNodes();if(!$(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function Y(e){return!!e&&void 0!==e.text}function q(e,t){var n=new c(t);e._ranges=[n],B(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed,H(e)}function G(t){if(t._ranges.length=0,"None"==t.docSelection.type)U(t);else{var n=t.docSelection.createRange();if(Y(n))q(t,n);else{t.rangeCount=n.length;for(var o,i=m(n.item(0)),r=0;r<t.rangeCount;++r)(o=e.createRange(i)).selectNode(n.item(r)),t._ranges.push(o);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,B(t,t._ranges[t.rangeCount-1],!1),H(t)}}}function Z(e,n){for(var o=e.docSelection.createRange(),i=z(n),r=m(o.item(0)),a=v(r).createControlRange(),s=0,l=o.length;s<l;++s)a.add(o.item(s));try{a.add(i)}catch(e){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),G(e)}function J(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function K(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0,H(e)}R&&l(R,"createControlRange")&&(L=R.createControlRange(),s.areHostProperties(L,["item","add"])&&(V=!0)),h.implementsControlRange=V,o=S?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed},l(P,"getRangeAt")?j=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}}:S&&(j=function(t){var n=m(t.anchorNode),o=e.createRange(n);return o.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),o}),J.prototype=e.selectionPrototype;var X=[];function Q(e,t){for(var n,o,i=X.length;i--;)if(o=(n=X[i]).selection,"deleteAll"==t)K(o);else if(n.win==e)return"delete"==t?(X.splice(i,1),!0):o;return"deleteAll"==t&&(X.length=0),null}var ee=function(e){if(e&&e instanceof J)return e.refresh(),e;var t=Q(e=b(e,"getNativeSelection")),o=n(e),i=O?k(e):null;return t?(t.nativeSelection=o,t.docSelection=i,t.refresh()):(t=new J(o,i,e),X.push({win:e,selection:t})),t};e.getSelection=ee,s.createAliasForDeprecatedMethod(e,"getIframeSelection","getSelection");var te,ne=J.prototype;function oe(e,n){for(var o,i=m(n[0].startContainer),r=v(i).createControlRange(),a=0,s=n.length;a<s;++a){o=z(n[a]);try{r.add(o)}catch(e){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),G(e)}if(!T&&S&&s.areHostMethods(P,["removeAllRanges","addRange"])){ne.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),U(this)};var ie=function(e,t){N(e.nativeSelection,t),e.refresh()};ne.addRange=I?function(t,n){if(V&&O&&this.docSelection.type==p)Z(this,t);else if(y(n)&&A)ie(this,t);else{var i;D?i=this.rangeCount:(this.removeAllRanges(),i=0);var r=W(t).cloneRange();try{this.nativeSelection.addRange(r)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var a=j(this.nativeSelection,this.rangeCount-1);a&&!g(a,t)&&(t=new c(a))}this._ranges[this.rangeCount-1]=t,B(this,t,re(this.nativeSelection)),this.isCollapsed=o(this),H(this)}else this.refresh()}}:function(e,t){y(t)&&A?ie(this,e):(this.nativeSelection.addRange(W(e)),this.refresh())},ne.setRanges=function(e){if(V&&O&&e.length>1)oe(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(l(P,"empty")&&l(_,"select")&&V&&T))return t.fail("No means of selecting a Range or TextRange was found"),!1;ne.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=m(this.anchorNode);else if(this.docSelection.type==p){var t=this.docSelection.createRange();t.length&&(e=m(t.item(0)))}e&&(v(e).createTextRange().select(),this.docSelection.empty())}}catch(e){}U(this)},ne.addRange=function(t){this.docSelection.type==p?Z(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,B(this,t,!1),H(this))},ne.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?oe(this,e):t&&this.addRange(e[0])}}if(ne.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new d("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()},T)te=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=v(t.win.document).createTextRange()).collapse(!0),t.docSelection.type==p?G(t):Y(n)?q(t,n):U(t)};else if(l(P,"getRangeAt")&&typeof P.rangeCount==r)te=function(t){if(V&&O&&t.docSelection.type==p)G(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,i=t.rangeCount;n<i;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));B(t,t._ranges[t.rangeCount-1],re(t.nativeSelection)),t.isCollapsed=o(t),H(t)}else U(t)};else{if(!S||typeof P.isCollapsed!=i||typeof _.collapsed!=i||!h.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;te=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=j(n,0),e._ranges=[t],e.rangeCount=1,F(e),e.isCollapsed=o(e),H(e)):U(e)}}ne.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(te(this),e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;i--;)if(!g(t[i],this._ranges[i]))return!0;return!1}};var re,ae=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,i=n.length;o<i;++o)g(t,n[o])||e.addRange(n[o]);e.rangeCount||U(e)};function se(e,t){if(e.win.document!=m(t))throw new d("WRONG_DOCUMENT_ERR")}function le(e,t){if(t<0||t>(a.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new d("INDEX_SIZE_ERR")}function ue(t){return function(n,o){var i;this.rangeCount?(i=this.getRangeAt(0))["set"+(t?"Start":"End")](n,o):(i=e.createRange(this.win.document)).setStartAndEnd(n,o),this.setSingleRange(i,this.isBackward())}}function ce(e){var t=[],n=new f(e.anchorNode,e.anchorOffset),o=new f(e.focusNode,e.focusOffset),i="function"==typeof e.getName?e.getName():"Selection";if(void 0!==e.rangeCount)for(var r=0,a=e.rangeCount;r<a;++r)t[r]=u.inspect(e.getRangeAt(r));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}ne.removeRange=V&&O?function(e){if(this.docSelection.type==p){for(var t=this.docSelection.createRange(),n=z(e),o=m(t.item(0)),i=v(o).createControlRange(),r=!1,a=0,s=t.length;a<s;++a)t.item(a)!==n||r?i.add(t.item(a)):r=!0;i.select(),G(this)}else ae(this,e)}:function(e){ae(this,e)},!T&&S&&h.implementsDomRange?(re=C,ne.isBackward=function(){return re(this)}):re=ne.isBackward=function(){return!1},ne.isBackwards=ne.isBackward,ne.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},ne.collapse=function(t,n){se(this,t);var o=e.createRange(t);o.collapseToPoint(t,n),this.setSingleRange(o),this.isCollapsed=!0},ne.collapseToStart=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},ne.collapseToEnd=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},ne.selectAllChildren=function(t){se(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},x?ne.setBaseAndExtent=function(e,t,n,o){this.nativeSelection.setBaseAndExtent(e,t,n,o),this.refresh()}:A&&(ne.setBaseAndExtent=function(t,n,o,i){le(t,n),le(o,i),se(this,t),se(this,o);var r=e.createRange(node),s=-1==a.comparePoints(t,n,o,i);s?r.setStartAndEnd(o,i,t,n):r.setStartAndEnd(t,n,o,i),this.setSingleRange(r,s)}),ne.deleteFromDocument=function(){if(V&&O&&this.docSelection.type==p){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),a.removeNode(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,i=n.length;o<i;++o)n[o].deleteContents();this.addRange(n[i-1])}}},ne.eachRange=function(e,t){for(var n=0,o=this._ranges.length;n<o;++n)if(e(this.getRangeAt(n)))return t},ne.getAllRanges=function(){var e=[];return this.eachRange((function(t){e.push(t)})),e},ne.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},ne.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange((function(o){n.push(o[e].apply(o,t||[]))})),n},ne.setStart=ue(!0),ne.setEnd=ue(!1),e.rangePrototype.select=function(e){ee(this.getDocument()).setSingleRange(this,e)},ne.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange((function(n){e(n),t.push(n)})),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},ne.containsNode=function(e,t){return this.eachRange((function(n){return n.containsNode(e,t)}),!0)||!1},ne.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},ne.moveToBookmark=function(t){for(var n,o,i=[],r=0;n=t.rangeBookmarks[r++];)(o=e.createRange(this.win)).moveToBookmark(n),i.push(o);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},ne.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},ne.restoreRanges=function(e){this.removeAllRanges();for(var t,n=0;t=e.ranges[n];++n)this.addRange(t,e.backward&&0==n)},ne.toHtml=function(){var e=[];return this.eachRange((function(t){e.push(u.toHtml(t))})),e.join("")},h.implementsTextRange&&(ne.getNativeTextRange=function(){var n;if(n=this.docSelection){var o=n.createRange();if(Y(o))return o;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),ne.getName=function(){return"WrappedSelection"},ne.inspect=function(){return ce(this)},ne.detach=function(){Q(this.win,"delete"),K(this)},J.detachAll=function(){Q(null,"deleteAll")},J.inspect=ce,J.isDirectionBackward=y,e.Selection=J,e.selectionPrototype=ne,e.addShimListener((function(e){void 0===e.getSelection&&(e.getSelection=function(){return ee(e)}),e=null}))}));var j=!1,V=function(e){j||(j=!0,!k.initialized&&k.config.autoInitialize&&R())};return b&&("complete"==document.readyState?V():(s(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",V,!1),g(window,"load",V))),k},void 0===(i="function"==typeof o?o.call(t,n,t,e):o)||(e.exports=i)},48527:function(e,t,n){"use strict";var o=n(42733),i=n(11435),r=(0,n(51900).Z)(i.Z,o.s,o.x,!1,null,null,null);t.Z=r.exports},20412:function(e,t,n){"use strict";var o=n(70307),i=n(24984),r=(0,n(51900).Z)(i.Z,o.s,o.x,!1,null,null,null);t.Z=r.exports},57323:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(65803),i={components:{ISpinner:n(20412).Z},props:{src:{type:String,default:""},text:{type:Boolean,default:!0}},data:function(){return{numPages:{},files:{},visiblePagesList:{1:!0},isLoading:!0,isLoadedEventEmitted:!1,throttleUpdateVisiblePages:null,viewPortSettings:{bottom:-1.5*window.innerHeight,top:-1.5*window.innerHeight},scrollListenerElement:null,selectors:{portfolioPopupScrollable:".popup-portfolio",imageViewerPopupScrollable:".iv-body__scroll"},firstPageSize:{width:0,height:0}}},computed:{pageLoaderStyle:function(){return this.firstPageSize.width?{width:"".concat(this.firstPageSize.width,"px"),height:"".concat(this.firstPageSize.height,"px")}:{}},loadedPageStyle:function(){return this.firstPageSize.width?{minHeight:"".concat(this.firstPageSize.height,"px")}:{}}},watch:{src:function(){var e=this;window.defferScripts.on("pdfVuer",(function(){e.updatePdf()}))}},mounted:function(){var e=this;window.defferScripts.on("pdfVuer",(function(){e.updatePdf()})),this.initWindowScrollEvent()},beforeDestroy:function(){this.removeWindowScrollEventListener()},methods:{updatePdf:function(){var e=this;if(this.src&&!this.files[this.src]){var t=this.src,n=pdfvuer.createLoadingTask({url:t});n.then((function(n){e&&e.numPages&&e.$set(e.numPages,t,n.numPages)})).catch((function(){})),this.files[this.src]=n}},loadingHandler:function(){var e=this;this.isLoadedEventEmitted||(this.isLoadedEventEmitted=!0,this.isLoading=!1,window.bus.$emit("pdf-portfolio-loaded"),this.$emit("loaded"),setTimeout((function(){e.setFirstPageSize(),e.$nextTick((function(){e.updateVisiblePages()}))}),300))},updateVisiblePages:function(){var e=this;this.$refs.pdfList&&_.forOwn(this.$refs.pdfList,(function(t){var n=t.dataset.page;n&&(0,o.uJ)(t,e.viewPortSettings)&&!e.visiblePagesList[n]&&e.$set(e.visiblePagesList,n,!0)}))},initWindowScrollEvent:function(){var e=this;this.setScrollListenerElement(),this.scrollListenerElement&&(this.throttleUpdateVisiblePages=_.throttle((function(){e.updateVisiblePages()}),300),this.scrollListenerElement.addEventListener("scroll",this.throttleUpdateVisiblePages),this.scrollListenerElement.addEventListener("touchmove",this.throttleUpdateVisiblePages))},removeWindowScrollEventListener:function(){this.scrollListenerElement&&(this.scrollListenerElement.removeEventListener("scroll",this.throttleUpdateVisiblePages),this.scrollListenerElement.removeEventListener("touchmove",this.throttleUpdateVisiblePages))},setScrollListenerElement:function(){var e=document.querySelector(this.selectors.portfolioPopupScrollable),t=document.querySelector(this.selectors.imageViewerPopupScrollable);this.scrollListenerElement=e||t||window},setFirstPageSize:function(){var e,t,n,o;null!==(e=this.$refs)&&void 0!==e&&e.pdfComponent[0]&&null!==(t=this.$refs)&&void 0!==t&&null!==(t=t.pdfComponent[0].pdfViewer)&&void 0!==t&&t.viewport&&(this.firstPageSize={width:Math.ceil(null===(n=this.$refs)||void 0===n?void 0:n.pdfComponent[0].pdfViewer.viewport.width),height:Math.ceil(null===(o=this.$refs)||void 0===o?void 0:o.pdfComponent[0].pdfViewer.viewport.height)})}}},r=(0,n(51900).Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pdf-view",class:{loading:e.isLoading,"pdf-view--one-page":1===e.numPages[e.src]}},[e.isLoading?n("div",{staticClass:"pdf-view__loader"},[n("i-spinner",{staticClass:"iv-spinner",class:{hidden:!e.isLoading}})],1):e._e(),e._v(" "),e.src&&e.numPages[e.src]?e._l(e.numPages[e.src],(function(t){return n("div",{key:t,ref:"pdfList",refInFor:!0,class:{"pdf-view__page-loader":!e.visiblePagesList[t],"pdf-view__page-ready":e.visiblePagesList[t]},style:e.visiblePagesList[t]?e.loadedPageStyle:e.pageLoaderStyle,attrs:{"data-page":t}},[e.visiblePagesList[t]?n("pdf",{ref:"pdfComponent",refInFor:!0,attrs:{src:e.files[e.src],page:t,resize:!0,text:e.text},on:{loading:e.loadingHandler}}):e._e()],1)})):e._e()],2)}),[],!1,null,null,null).exports},39988:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var o=n(21702),i=n(17040),r={mixins:[o.Z,i.Z],computed:{header:function(){return this.externalData.header||l("title","components/portfolio-delete-modal/portfolio-delete-modal-confirm")},description:function(){var e;return e=this.typeFile?"image"===this.typeFile?l("descriptionImage","components/portfolio-delete-modal/portfolio-delete-modal-confirm"):"video"===this.typeFile?l("descriptionVideo","components/portfolio-delete-modal/portfolio-delete-modal-confirm"):l("descriptionOther","components/portfolio-delete-modal/portfolio-delete-modal-confirm"):l("description","components/portfolio-delete-modal/portfolio-delete-modal-confirm"),this.externalData.description||e},btnCancelText:function(){return this.externalData.cancel||l("cancel","components/portfolio-delete-modal/portfolio-delete-modal-confirm")},btnDeleteText:function(){return this.externalData.delete||l("confirm","components/portfolio-delete-modal/portfolio-delete-modal-confirm")},canDelete:function(){return void 0===this.externalData.canDelete||this.externalData.canDelete}},methods:{closeCancel:function(){this.isModalOpened=!1,this.clearExternalData(),window.bus.$emit("portfolio-modal-delete-cancel")},resetModal:function(e){this.closeModal(),this.clearExternalData(),this.$nextTick((function(){window.bus.$emit("portfolio-modal-delete",e)}))},deletePortfolio:function(){var e,t=this,n=this.externalData.portfolioId||0;n?"my-portfolios"===(null===(e=window.portfolioList)||void 0===e?void 0:e.modal.page)&&axios.post("/portfolio/delete",{portfolio_id:n}).then((function(e){var o=e.data;o&&(o.success?(window.isPageProfile&&(window.lastMediaPlayerKey="",window.bus.$emit("pause-media-player")),window.bus.$emit("delete-portfolio",n),window.MessageState&&(window.MessageState.showMessage("success",l("successfullyDeleted","components/portfolio-delete-modal/portfolio-delete-modal-confirm")),window.MessageState.fadeMessageWithTimeout(300,2e3))):(o.data.message||o.data.error)&&window.MessageState.showMessage("error",o.data.message||o.data.error,"",!0),t.resetModal(n))})).catch((function(){})).then((function(){t.isApiRequestSended=!1})):this.resetModal(n)},clearExternalData:function(){this.externalData={}}}},a=(0,n(51900).Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("k-modal",{staticClass:"portfolio-delete-modal-confirm",attrs:{title:e.header,isCloseOnEscape:!0,design:"small",backdrop:"dark","child-popup":e.childPopupLocal},on:{close:e.closeCancel},scopedSlots:e._u([{key:"footer",fn:function(){return[e.canDelete?[n("button",{staticClass:"js-confirm-portfolio kw-button kw-button--gray-border kw-button--no-padding",attrs:{type:"button"},on:{click:e.closeCancel}},[e._v(e._s(e.btnCancelText))]),e._v(" "),n("button",{staticClass:"kw-button kw-button--no-padding kw-button--red",class:e.buttonWaiting,attrs:{type:"button"},domProps:{textContent:e._s(e.btnDeleteText)},on:{click:function(t){return e.apiRequest("deletePortfolio")}}})]:e._e()]},proxy:!0}]),model:{value:e.isModalOpened,callback:function(t){e.isModalOpened=t},expression:"isModalOpened"}},[n("div",{class:{pb12:!e.canDelete},domProps:{innerHTML:e._s(e.description)}})])}),[],!1,null,null,null).exports},52968:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var o=n(17040),i=n(21702),r={mixins:[o.Z,i.Z],methods:{closeConfirm:function(){this.isModalOpened=!1,window.bus.$emit("portfolio-modal-hide")},closeContinue:function(){this.isModalOpened=!1,this.$nextTick((function(){window.bus.$emit("portfolio-modal-continue")}))}}},a=(0,n(51900).Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("k-modal",{staticClass:"portfolio-upload-modal-confirm",attrs:{title:e.l("closeWithoutSaving","components/portfolio-upload-modal/portfolio-upload-modal-confirm"),design:"small"},on:{close:e.closeContinue},scopedSlots:e._u([{key:"footer",fn:function(){return[n("button",{staticClass:"kw-button kw-button--no-padding kw-button--green",attrs:{type:"button"},on:{click:e.closeContinue}},[e._v(e._s(e.l("legacyTranslation3","components/portfolio-upload-modal/portfolio-upload-modal-confirm")))]),e._v(" "),n("button",{staticClass:"js-confirm-portfolio kw-button kw-button--gray-border kw-button--no-padding",attrs:{type:"button"},on:{click:e.closeConfirm}},[e._v(e._s(e.l("legacyTranslation4","components/portfolio-upload-modal/portfolio-upload-modal-confirm")))])]},proxy:!0}]),model:{value:e.isModalOpened,callback:function(t){e.isModalOpened=t},expression:"isModalOpened"}},[n("p",{domProps:{innerHTML:e._s(e.l("description","components/portfolio-upload-modal/portfolio-upload-modal-confirm"))}})])}),[],!1,null,null,null).exports},11435:function(e,t,n){"use strict";var o=n(9828);t.Z=o.Z},24984:function(e,t,n){"use strict";var o=n(86458);t.Z=o.Z},42733:function(e,t,n){"use strict";n.d(t,{s:function(){return o},x:function(){return i}});var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"audio-wavesurfer",class:[e.theme?"audio-wavesurfer--theme-"+e.theme:null],on:{click:function(e){e.stopPropagation()}}},[n("div",{staticClass:"audio-wavesurfer__control"},[n("div",{staticClass:"audio-wavesurfer__control-button",on:{click:function(t){return t.preventDefault(),e.playPause.apply(null,arguments)}}},[e.isLoading?n("span",{class:e.loaderSelectors}):n("img",{staticClass:"audio-wavesurfer__icon",attrs:{src:e.iconPlayPauseSrc,alt:""}})]),e._v(" "),e.mobileVersion?e._e():n("div",{staticClass:"audio-wavesurfer__control-volume",on:{mouseenter:function(t){t.preventDefault(),e.isControlVolumeHovered=!0},mouseleave:function(t){t.preventDefault(),e.isControlVolumeHovered=!1}}},[n("img",{staticClass:"audio-wavesurfer__icon",attrs:{src:e.cdnImageUrl("/icons/audio-volume-"+(e.volumeValue>0?"on":"off")+".svg"),alt:""},on:{click:function(t){return t.preventDefault(),e.toggleMute.apply(null,arguments)}}}),e._v(" "),e.isControlVolumeHovered?n("input",{directives:[{name:"model",rawName:"v-model",value:e.volumeValue,expression:"volumeValue"}],style:"--val: "+e.volumeValue+";",attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.volumeValue},on:{click:function(e){e.preventDefault()},input:e.onVolumeChange,__r:function(t){e.volumeValue=t.target.value}}}):e._e()]),e._v(" "),e.totalDuration?n("div",{staticClass:"audio-wavesurfer__control-timer"},[e.hasPlaybackTime&&e.playbackTime?[e._v(e._s(e.playbackTime)+" /")]:e._e(),e._v("\n\t\t\t"+e._s(e.totalDuration)+"\n\t\t")],2):e._e()]),e._v(" "),n("div",{ref:"wavesurfer",staticClass:"audio-wavesurfer__visualization",class:{"audio-wavesurfer__visualization--hidden":!e.isPeaksReady}})])},i=[]},70307:function(e,t,n){"use strict";n.d(t,{s:function(){return o},x:function(){return i}});var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return"lite"==e.mode?n("div",{staticClass:"ispinner-lite"}):n("div",{staticClass:"ispinner ispinner--gray ispinner--animating ispinner--large"},e._l(12,(function(e){return n("div",{key:e,staticClass:"ispinner__blade"})})),0)},i=[]},51900:function(e,t,n){"use strict";function o(e,t,n,o,i,r,a,s){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),r&&(u._scopeId="data-v-"+r),a?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):i&&(l=s?function(){i.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}n.d(t,{Z:function(){return o}})},21796:function(e){
/*!
 * wavesurfer.js 6.6.4 (2023-06-10)
 * https://wavesurfer-js.org
 * @license BSD-3-Clause
 */
var t;self,t=()=>(()=>{var e={"./src/drawer.canvasentry.js":
/*!***********************************!*\
  !*** ./src/drawer.canvasentry.js ***!
  \***********************************/(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(/*! ./util/style */"./src/util/style.js")),i=r(n(/*! ./util/get-id */"./src/util/get-id.js"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,r=void 0,r=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===a(r)?r:String(r)),o)}var i,r}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=(0,i.default)(void 0!==this.constructor.name?this.constructor.name.toLowerCase()+"_":"canvasentry_"),this.canvasContextAttributes={}}var t,n,r;return t=e,(n=[{key:"initWave",value:function(e){this.wave=e,this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(e){this.progress=e,this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(e,t,n,i){this.start=this.wave.offsetLeft/t||0,this.end=this.start+e/t,this.wave.width=n,this.wave.height=i;var r={width:e+"px"};(0,o.default)(this.wave,r),this.hasProgressCanvas&&(this.progress.width=n,this.progress.height=i,(0,o.default)(this.progress,r))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(e,t){this.waveCtx.fillStyle=this.getFillStyle(this.waveCtx,e),this.hasProgressCanvas&&(this.progressCtx.fillStyle=this.getFillStyle(this.progressCtx,t))}},{key:"getFillStyle",value:function(e,t){if("string"==typeof t||t instanceof CanvasGradient)return t;var n=e.createLinearGradient(0,0,0,e.canvas.height);return t.forEach((function(e,o){return n.addColorStop(o/t.length,e)})),n}},{key:"applyCanvasTransforms",value:function(e){e&&(this.waveCtx.setTransform(0,1,1,0,0,0),this.hasProgressCanvas&&this.progressCtx.setTransform(0,1,1,0,0,0))}},{key:"fillRects",value:function(e,t,n,o,i){this.fillRectToContext(this.waveCtx,e,t,n,o,i),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,e,t,n,o,i)}},{key:"fillRectToContext",value:function(e,t,n,o,i,r){e&&(r?this.drawRoundedRect(e,t,n,o,i,r):e.fillRect(t,n,o,i))}},{key:"drawRoundedRect",value:function(e,t,n,o,i,r){0!==i&&(i<0&&(n-=i*=-1),e.beginPath(),e.moveTo(t+r,n),e.lineTo(t+o-r,n),e.quadraticCurveTo(t+o,n,t+o,n+r),e.lineTo(t+o,n+i-r),e.quadraticCurveTo(t+o,n+i,t+o-r,n+i),e.lineTo(t+r,n+i),e.quadraticCurveTo(t,n+i,t,n+i-r),e.lineTo(t,n+r),e.quadraticCurveTo(t,n,t+r,n),e.closePath(),e.fill())}},{key:"drawLines",value:function(e,t,n,o,i,r){this.drawLineToContext(this.waveCtx,e,t,n,o,i,r),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,e,t,n,o,i,r)}},{key:"drawLineToContext",value:function(e,t,n,o,i,r,a){if(e){var s,l,u,c=t.length/2,d=Math.round(c*this.start),f=d,h=Math.round(c*this.end)+1,p=this.wave.width/(h-f-1),m=o+i,v=n/o;for(e.beginPath(),e.moveTo((f-d)*p,m),e.lineTo((f-d)*p,m-Math.round((t[2*f]||0)/v)),s=f;s<h;s++)l=t[2*s]||0,u=Math.round(l/v),e.lineTo((s-d)*p+this.halfPixel,m-u);for(var g=h-1;g>=f;g--)l=t[2*g+1]||0,u=Math.round(l/v),e.lineTo((g-d)*p+this.halfPixel,m-u);e.lineTo((f-d)*p,m-Math.round((t[2*f+1]||0)/v)),e.closePath(),e.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(e,t,n){var o=this;return"blob"===n?new Promise((function(n){o.wave.toBlob(n,e,t)})):"dataURL"===n?this.wave.toDataURL(e,t):void 0}}])&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=l,e.exports=t.default},"./src/drawer.js":
/*!***********************!*\
  !*** ./src/drawer.js ***!
  \***********************/(e,t,n)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=a?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(i,s,l):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(n(/*! ./util */"./src/util/index.js"));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===o(a)?a:String(a)),i)}var r,a}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(u,e);var t,n,o,r=l(u);function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=r.call(this)).container=i.withOrientation(e,t.vertical),n.params=t,n.width=0,n.height=t.height*n.params.pixelRatio,n.lastPos=0,n.wrapper=null,n}return t=u,(n=[{key:"style",value:function(e,t){return i.style(e,t)}},{key:"createWrapper",value:function(){this.wrapper=i.withOrientation(this.container.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",cursor:this.params.hideCursor?"none":"auto",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(e,t){!t&&e.preventDefault();var n,o=i.withOrientation(e.targetTouches?e.targetTouches[0]:e,this.params.vertical).clientX,r=this.wrapper.getBoundingClientRect(),a=this.width,s=this.getWidth(),l=this.getProgressPixels(r,o);return n=!this.params.fillParent&&a<s?l*(this.params.pixelRatio/a)||0:(l+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,i.clamp(n,0,1)}},{key:"getProgressPixels",value:function(e,t){return this.params.rtl?e.right-t:t-e.left}},{key:"setupWrapperEvents",value:function(){var e=this;this.wrapper.addEventListener("click",(function(t){var n=i.withOrientation(t,e.params.vertical),o=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!==o){var r=e.wrapper.getBoundingClientRect();if(n.clientY>=r.bottom-o)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))})),this.wrapper.addEventListener("dblclick",(function(t){e.params.interact&&e.fireEvent("dblclick",t,e.handleEvent(t))})),this.wrapper.addEventListener("scroll",(function(t){return e.fireEvent("scroll",t)}))}},{key:"drawPeaks",value:function(e,t,n,o){this.setWidth(t)||this.clearWave(),this.params.barWidth?this.drawBars(e,0,n,o):this.drawWave(e,0,n,o)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)}},{key:"recenterOnPosition",value:function(e,t){var n=this.wrapper.scrollLeft,o=~~(this.wrapper.clientWidth/2),i=this.wrapper.scrollWidth-this.wrapper.clientWidth,r=e-o,a=r-n;if(0!=i){if(!t&&-o<=a&&a<o){var s=this.params.autoCenterRate;s/=o,s*=i,r=n+(a=Math.max(-s,Math.min(s,a)))}(r=Math.max(0,Math.min(i,r)))!=n&&(this.wrapper.scrollLeft=r)}}},{key:"getScrollX",value:function(){var e=0;if(this.wrapper){var t=this.params.pixelRatio;if(e=Math.round(this.wrapper.scrollLeft*t),this.params.scrollParent){var n=~~(this.wrapper.scrollWidth*t-this.getWidth());e=Math.min(n,Math.max(0,e))}}return e}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){if(this.width==e)return!1;if(this.width=e,this.params.fillParent||this.params.scrollParent)this.style(this.wrapper,{width:""});else{var t=~~(this.width/this.params.pixelRatio)+"px";this.style(this.wrapper,{width:t})}return this.updateSize(),!0}},{key:"setHeight",value:function(e){return e!=this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(e){var t=1/this.params.pixelRatio,n=Math.round(e*this.width)*t;if(n<this.lastPos||n-this.lastPos>=t){if(this.lastPos=n,this.params.scrollParent&&this.params.autoCenter){var o=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(o,this.params.autoCenterImmediately)}this.updateProgress(n)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container.domElement&&this.container.removeChild(this.wrapper.domElement),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(e,t,n,o){}},{key:"drawWave",value:function(e,t,n,o){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(e){}}])&&a(t.prototype,n),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Observer);t.default=c,e.exports=t.default},"./src/drawer.multicanvas.js":
/*!***********************************!*\
  !*** ./src/drawer.multicanvas.js ***!
  \***********************************/(e,t,n)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(n(/*! ./drawer */"./src/drawer.js")),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(/*! ./util */"./src/util/index.js")),a=l(n(/*! ./drawer.canvasentry */"./src/drawer.canvasentry.js"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===o(a)?a:String(a)),i)}var r,a}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f(e);if(t){var r=f(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(s,e);var t,n,o,i=d(s);function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=i.call(this,e,t)).maxCanvasWidth=t.maxCanvasWidth,n.maxCanvasElementWidth=Math.round(t.maxCanvasWidth/t.pixelRatio),n.hasProgressCanvas=t.waveColor!=t.progressColor,n.halfPixel=.5/t.pixelRatio,n.canvases=[],n.progressWave=null,n.EntryClass=a.default,n.canvasContextAttributes=t.drawingContextAttributes,n.overlap=2*Math.ceil(t.pixelRatio/2),n.barRadius=t.barRadius||0,n.vertical=t.vertical,n}return t=s,n=[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=r.withOrientation(this.wrapper.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.progressWave,{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"}),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var e=this,t=Math.round(this.width/this.params.pixelRatio),n=Math.ceil(t/(this.maxCanvasElementWidth+this.overlap));this.canvases.length<n;)this.addCanvas();for(;this.canvases.length>n;)this.removeCanvas();var o=this.maxCanvasWidth+this.overlap,i=this.canvases.length-1;this.canvases.forEach((function(t,n){n==i&&(o=e.width-e.maxCanvasWidth*i),e.updateDimensions(t,o,e.height),t.clearWave()}))}},{key:"addCanvas",value:function(){var e=new this.EntryClass;e.canvasContextAttributes=this.canvasContextAttributes,e.hasProgressCanvas=this.hasProgressCanvas,e.halfPixel=this.halfPixel;var t=this.maxCanvasElementWidth*this.canvases.length,n=r.withOrientation(this.wrapper.appendChild(document.createElement("canvas")),this.params.vertical);if(this.style(n,{position:"absolute",zIndex:2,left:t+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}),e.initWave(n),this.hasProgressCanvas){var o=r.withOrientation(this.progressWave.appendChild(document.createElement("canvas")),this.params.vertical);this.style(o,{position:"absolute",left:t+"px",top:0,bottom:0,height:"100%"}),e.initProgress(o)}this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases[this.canvases.length-1];e.wave.parentElement.removeChild(e.wave.domElement),this.hasProgressCanvas&&e.progress.parentElement.removeChild(e.progress.domElement),e&&(e.destroy(),e=null),this.canvases.pop()}},{key:"updateDimensions",value:function(e,t,n){var o=Math.round(t/this.params.pixelRatio),i=Math.round(this.width/this.params.pixelRatio);e.updateDimensions(o,i,t,n),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){var e=this;r.frame((function(){e.canvases.forEach((function(e){return e.clearWave()}))}))()}},{key:"drawBars",value:function(e,t,n,o){var i=this;return this.prepareDraw(e,t,n,o,(function(e){var t=e.absmax,r=e.hasMinVals,a=(e.height,e.offsetY),s=e.halfH,l=e.peaks,u=e.channelIndex;if(void 0!==n)for(var c=r?2:1,d=l.length/c,f=i.params.barWidth*i.params.pixelRatio,h=f+(null===i.params.barGap?Math.max(i.params.pixelRatio,~~(f/2)):Math.max(i.params.pixelRatio,i.params.barGap*i.params.pixelRatio)),p=d/i.width,m=o,v=n;v<m;v+=h){var g=0,y=Math.floor(v*p)*c,b=Math.floor((v+h)*p)*c;do{var w=Math.abs(l[y]);w>g&&(g=w),y+=c}while(y<b);var k=Math.round(g/t*s);i.params.barMinHeight&&(k=Math.max(k,i.params.barMinHeight)),i.fillRect(v+i.halfPixel,s-k+a,f+i.halfPixel,2*k,i.barRadius,u)}}))}},{key:"drawWave",value:function(e,t,n,o){var i=this;return this.prepareDraw(e,t,n,o,(function(e){var t=e.absmax,r=e.hasMinVals,a=(e.height,e.offsetY),s=e.halfH,l=e.peaks,u=e.channelIndex;if(!r){for(var c=[],d=l.length,f=0;f<d;f++)c[2*f]=l[f],c[2*f+1]=-l[f];l=c}void 0!==n&&i.drawLine(l,t,s,a,n,o,u),i.fillRect(0,s+a-i.halfPixel,i.width,i.halfPixel,i.barRadius,u)}))}},{key:"drawLine",value:function(e,t,n,o,i,r,a){var s=this,l=this.params.splitChannelsOptions.channelColors[a]||{},u=l.waveColor,c=l.progressColor;this.canvases.forEach((function(a,l){s.setFillStyles(a,u,c),s.applyCanvasTransforms(a,s.params.vertical),a.drawLines(e,t,n,o,i,r)}))}},{key:"fillRect",value:function(e,t,n,o,i,r){for(var a=Math.floor(e/this.maxCanvasWidth),s=Math.min(Math.ceil((e+n)/this.maxCanvasWidth)+1,this.canvases.length),l=a;l<s;l++){var u=this.canvases[l],c=l*this.maxCanvasWidth,d={x1:Math.max(e,l*this.maxCanvasWidth),y1:t,x2:Math.min(e+n,l*this.maxCanvasWidth+u.wave.width),y2:t+o};if(d.x1<d.x2){var f=this.params.splitChannelsOptions.channelColors[r]||{},h=f.waveColor,p=f.progressColor;this.setFillStyles(u,h,p),this.applyCanvasTransforms(u,this.params.vertical),u.fillRects(d.x1-c,d.y1,d.x2-d.x1,d.y2-d.y1,i)}}}},{key:"hideChannel",value:function(e){return this.params.splitChannels&&this.params.splitChannelsOptions.filterChannels.includes(e)}},{key:"prepareDraw",value:function(e,t,n,o,i,a,s){var l=this;return r.frame((function(){if(e[0]instanceof Array){var u=e;if(l.params.splitChannels){var c,d=u.filter((function(e,t){return!l.hideChannel(t)}));return l.params.splitChannelsOptions.overlay||l.setHeight(Math.max(d.length,1)*l.params.height*l.params.pixelRatio),l.params.splitChannelsOptions&&l.params.splitChannelsOptions.relativeNormalization&&(c=r.max(u.map((function(e){return r.absMax(e)})))),u.forEach((function(e,t){return l.prepareDraw(e,t,n,o,i,d.indexOf(e),c)}))}e=u[0]}if(!l.hideChannel(t)){var f=1/l.params.barHeight;l.params.normalize&&(f=void 0===s?r.absMax(e):s);var h=[].some.call(e,(function(e){return e<0})),p=l.params.height*l.params.pixelRatio,m=p/2,v=p*a||0;return l.params.splitChannelsOptions&&l.params.splitChannelsOptions.overlay&&(v=0),i({absmax:f,hasMinVals:h,height:p,offsetY:v,halfH:m,peaks:e,channelIndex:t})}}))()}},{key:"setFillStyles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.params.waveColor,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.params.progressColor;e.setFillStyles(t,n)}},{key:"applyCanvasTransforms",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.applyCanvasTransforms(t)}},{key:"getImage",value:function(e,t,n){if("blob"===n)return Promise.all(this.canvases.map((function(o){return o.getImage(e,t,n)})));if("dataURL"===n){var o=this.canvases.map((function(o){return o.getImage(e,t,n)}));return o.length>1?o:o[0]}}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}],n&&u(t.prototype,n),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),s}(i.default);t.default=h,e.exports=t.default},"./src/mediaelement-webaudio.js":
/*!**************************************!*\
  !*** ./src/mediaelement-webaudio.js ***!
  \**************************************/(e,t,n)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var i;function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===o(a)?a:String(a)),i)}var r,a}function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},a.apply(this,arguments)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(c,e);var t,n,o,i=l(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,e)).params=e,t.sourceMediaElement=null,t}return t=c,(n=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(e,t,n){a(u(c.prototype),"_load",this).call(this,e,t,n),this.createMediaElementSource(e)}},{key:"createMediaElementSource",value:function(e){this.sourceMediaElement=this.ac.createMediaElementSource(e),this.sourceMediaElement.connect(this.analyser)}},{key:"play",value:function(e,t){return this.resumeAudioContext(),a(u(c.prototype),"play",this).call(this,e,t)}},{key:"destroy",value:function(){a(u(c.prototype),"destroy",this).call(this),this.destroyWebAudio()}}])&&r(t.prototype,n),o&&r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(((i=n(/*! ./mediaelement */"./src/mediaelement.js"))&&i.__esModule?i:{default:i}).default);t.default=c,e.exports=t.default},"./src/mediaelement.js":
/*!*****************************!*\
  !*** ./src/mediaelement.js ***!
  \*****************************/(e,t,n)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,r=(i=n(/*! ./webaudio */"./src/webaudio.js"))&&i.__esModule?i:{default:i},a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(/*! ./util */"./src/util/index.js"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===o(a)?a:String(a)),i)}var r,a}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},u.apply(this,arguments)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f(e);if(t){var r=f(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(r,e);var t,n,o,i=d(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).params=e,t.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},t.mediaType=e.mediaType.toLowerCase(),t.elementPosition=e.elementPosition,t.peaks=null,t.playbackRate=1,t.volume=1,t.isMuted=!1,t.buffer=null,t.onPlayEnd=null,t.mediaListeners={},t}return t=r,(n=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var e=this;this.mediaListeners.error=function(){e.fireEvent("error","Error loading media element")},this.mediaListeners.waiting=function(){e.fireEvent("waiting")},this.mediaListeners.canplay=function(){e.fireEvent("canplay")},this.mediaListeners.ended=function(){e.fireEvent("finish")},this.mediaListeners.play=function(){e.fireEvent("play")},this.mediaListeners.pause=function(){e.fireEvent("pause")},this.mediaListeners.seeked=function(t){e.fireEvent("seek")},this.mediaListeners.volumechange=function(t){e.isMuted=e.media.muted,e.isMuted?e.volume=0:e.volume=e.media.volume,e.fireEvent("volume")},Object.keys(this.mediaListeners).forEach((function(t){e.media.removeEventListener(t,e.mediaListeners[t]),e.media.addEventListener(t,e.mediaListeners[t])}))}},{key:"createTimer",value:function(){var e=this;this.on("play",(function t(){e.isPaused()||(e.fireEvent("audioprocess",e.getCurrentTime()),a.frame(t)())})),this.on("pause",(function(){e.fireEvent("audioprocess",e.getCurrentTime())}))}},{key:"load",value:function(e,t,n,o){var i=document.createElement(this.mediaType);i.controls=this.params.mediaControls,i.autoplay=this.params.autoplay||!1,i.preload=null==o?"auto":o,i.src=e,i.style.width="100%";var r=t.querySelector(this.mediaType);r&&t.removeChild(r),t.appendChild(i),this._load(i,n,o)}},{key:"loadElt",value:function(e,t){e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,this._load(e,t,e.preload)}},{key:"_load",value:function(e,t,n){if(!(e instanceof HTMLMediaElement)||void 0===e.addEventListener)throw new Error("media parameter is not a valid media element");"function"!=typeof e.load||t&&"none"==n||e.load(),this.media=e,this._setupMediaListeners(),this.peaks=t,this.onPlayEnd=null,this.buffer=null,this.isMuted=e.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var e=(this.buffer||this.media).duration;return e>=1/0&&(e=this.media.seekable.end(0)),e}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){null==e||isNaN(e)||(this.media.currentTime=e),this.clearPlayEnd()}},{key:"play",value:function(e,t){this.seekTo(e);var n=this.media.play();return t&&this.setPlayEnd(t),n}},{key:"pause",value:function(){var e;return this.media&&(e=this.media.pause()),this.clearPlayEnd(),e}},{key:"setPlayEnd",value:function(e){var t=this;this.clearPlayEnd(),this._onPlayEnd=function(n){n>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(e,t,n){return this.buffer?u(f(r.prototype),"getPeaks",this).call(this,e,t,n):this.peaks||[]}},{key:"setSinkId",value:function(e){return e?this.media.setSinkId?this.media.setSinkId(e):Promise.reject(new Error("setSinkId is not supported in your browser")):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.volume=e,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"setMute",value:function(e){this.isMuted=this.media.muted=e}},{key:"destroy",value:function(){var e=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach((function(t){e.media&&e.media.removeEventListener(t,e.mediaListeners[t])})),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}])&&l(t.prototype,n),o&&l(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(r.default);t.default=h,e.exports=t.default},"./src/peakcache.js":
/*!**************************!*\
  !*** ./src/peakcache.js ***!
  \**************************/(e,t)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,a=function(e,t){if("object"!==n(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===n(a)?a:String(a)),i)}var r,a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clearPeakCache()}var t,n,i;return t=e,(n=[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(e,t,n){e!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=e);for(var o=[],i=0;i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<t;)i++;for(i%2==0&&o.push(t);i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<=n;)o.push(this.peakCacheRanges[i]),i++;i%2==0&&o.push(n),o=o.filter((function(e,t,n){return 0==t?e!=n[t+1]:t==n.length-1?e!=n[t-1]:e!=n[t-1]&&e!=n[t+1]})),this.peakCacheRanges=this.peakCacheRanges.concat(o),this.peakCacheRanges=this.peakCacheRanges.sort((function(e,t){return e-t})).filter((function(e,t,n){return 0==t?e!=n[t+1]:t==n.length-1?e!=n[t-1]:e!=n[t-1]&&e!=n[t+1]}));var r=[];for(i=0;i<o.length;i+=2)r.push([o[i],o[i+1]]);return r}},{key:"getCacheRanges",value:function(){var e,t=[];for(e=0;e<this.peakCacheRanges.length;e+=2)t.push([this.peakCacheRanges[e],this.peakCacheRanges[e+1]]);return t}}])&&o(t.prototype,n),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=i,e.exports=t.default},"./src/util/absMax.js":
/*!****************************!*\
  !*** ./src/util/absMax.js ***!
  \****************************/(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,o.default)(e),n=(0,i.default)(e);return-n>t?-n:t};var o=r(n(/*! ./max */"./src/util/max.js")),i=r(n(/*! ./min */"./src/util/min.js"));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},"./src/util/clamp.js":
/*!***************************!*\
  !*** ./src/util/clamp.js ***!
  \***************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return Math.min(Math.max(t,e),n)},e.exports=t.default},"./src/util/fetch.js":
/*!***************************!*\
  !*** ./src/util/fetch.js ***!
  \***************************/(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)throw new Error("fetch options missing");if(!e.url)throw new Error("fetch url missing");var t=new i.default,n=new Headers,o=new Request(e.url);t.controller=new AbortController,e&&e.requestHeaders&&e.requestHeaders.forEach((function(e){n.append(e.key,e.value)}));var r=e.responseType||"json",a={method:e.method||"GET",headers:n,mode:e.mode||"cors",credentials:e.credentials||"same-origin",cache:e.cache||"default",redirect:e.redirect||"follow",referrer:e.referrer||"client",signal:t.controller.signal};return fetch(o,a).then((function(e){t.response=e;var n=!0;e.body||(n=!1);var o=e.headers.get("content-length");return null===o&&(n=!1),n?(t.onProgress=function(e){t.fireEvent("progress",e)},new Response(new ReadableStream(new s(t,o,e)),a)):e})).then((function(e){var t;if(e.ok)switch(r){case"arraybuffer":return e.arrayBuffer();case"json":return e.json();case"blob":return e.blob();case"text":return e.text();default:t="Unknown responseType: "+r}throw t||(t="HTTP error status: "+e.status),new Error(t)})).then((function(e){t.fireEvent("success",e)})).catch((function(e){t.fireEvent("error",e)})),t.fetchRequest=o,t};var o,i=(o=n(/*! ./observer */"./src/util/observer.js"))&&o.__esModule?o:{default:o};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(a)?a:String(a)),o)}var i,a}var s=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.instance._reader=o.body.getReader(),this.total=parseInt(n,10),this.loaded=0}var t,n,o;return t=e,(n=[{key:"start",value:function(e){var t=this;!function n(){t.instance._reader.read().then((function(o){var i=o.done,r=o.value;if(i)return 0===t.total&&t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!1}),void e.close();t.loaded+=r.byteLength,t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!(0===t.total)}),e.enqueue(r),n()})).catch((function(t){e.error(t)}))}()}}])&&a(t.prototype,n),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=t.default},"./src/util/frame.js":
/*!***************************!*\
  !*** ./src/util/frame.js ***!
  \***************************/(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(0,i.default)((function(){return e.apply(void 0,n)}))}};var o,i=(o=n(/*! ./request-animation-frame */"./src/util/request-animation-frame.js"))&&o.__esModule?o:{default:o};e.exports=t.default},"./src/util/get-id.js":
/*!****************************!*\
  !*** ./src/util/get-id.js ***!
  \****************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e&&(e="wavesurfer_"),e+Math.random().toString(32).substring(2)},e.exports=t.default},"./src/util/index.js":
/*!***************************!*\
  !*** ./src/util/index.js ***!
  \***************************/(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Observer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"absMax",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"clamp",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"fetchFile",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"frame",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"getId",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"ignoreSilenceMode",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"max",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"min",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"preventClick",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"requestAnimationFrame",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"style",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"withOrientation",{enumerable:!0,get:function(){return m.default}});var o=g(n(/*! ./get-id */"./src/util/get-id.js")),i=g(n(/*! ./max */"./src/util/max.js")),r=g(n(/*! ./min */"./src/util/min.js")),a=g(n(/*! ./absMax */"./src/util/absMax.js")),s=g(n(/*! ./observer */"./src/util/observer.js")),l=g(n(/*! ./style */"./src/util/style.js")),u=g(n(/*! ./request-animation-frame */"./src/util/request-animation-frame.js")),c=g(n(/*! ./frame */"./src/util/frame.js")),d=g(n(/*! debounce */"./node_modules/debounce/index.js")),f=g(n(/*! ./prevent-click */"./src/util/prevent-click.js")),h=g(n(/*! ./fetch */"./src/util/fetch.js")),p=g(n(/*! ./clamp */"./src/util/clamp.js")),m=g(n(/*! ./orientation */"./src/util/orientation.js")),v=g(n(/*! ./silence-mode */"./src/util/silence-mode.js"));function g(e){return e&&e.__esModule?e:{default:e}}},"./src/util/max.js":
/*!*************************!*\
  !*** ./src/util/max.js ***!
  \*************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=-1/0;return Object.keys(e).forEach((function(n){e[n]>t&&(t=e[n])})),t},e.exports=t.default},"./src/util/min.js":
/*!*************************!*\
  !*** ./src/util/min.js ***!
  \*************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Number(1/0);return Object.keys(e).forEach((function(n){e[n]<t&&(t=e[n])})),t},e.exports=t.default},"./src/util/observer.js":
/*!******************************!*\
  !*** ./src/util/observer.js ***!
  \******************************/(e,t)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,a=void 0,a=function(e,t){if("object"!==n(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===n(a)?a:String(a)),i)}var r,a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._disabledEventEmissions=[],this.handlers=null}var t,n,i;return t=e,n=[{key:"on",value:function(e,t){var n=this;this.handlers||(this.handlers={});var o=this.handlers[e];return o||(o=this.handlers[e]=[]),o.push(t),{name:e,callback:t,un:function(e,t){return n.un(e,t)}}}},{key:"un",value:function(e,t){if(this.handlers){var n,o=this.handlers[e];if(o)if(t)for(n=o.length-1;n>=0;n--)o[n]==t&&o.splice(n,1);else o.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,t){var n=this;return this.on(e,(function o(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];t.apply(n,r),setTimeout((function(){n.un(e,o)}),0)}))}},{key:"setDisabledEventEmissions",value:function(e){this._disabledEventEmissions=e}},{key:"_isDisabledEventEmission",value:function(e){return this._disabledEventEmissions&&this._disabledEventEmissions.includes(e)}},{key:"fireEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(this.handlers&&!this._isDisabledEventEmission(e)){var i=this.handlers[e];i&&i.forEach((function(e){e.apply(void 0,n)}))}}}],n&&o(t.prototype,n),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=i,e.exports=t.default},"./src/util/orientation.js":
/*!*********************************!*\
  !*** ./src/util/orientation.js ***!
  \*********************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){return t[i]?t:new Proxy(t,{get:function(t,r,a){if(r===i)return!0;if("domElement"===r)return t;if("style"===r)return e(t.style,n);if("canvas"===r)return e(t.canvas,n);if("getBoundingClientRect"===r)return function(){return e(t.getBoundingClientRect.apply(t,arguments),n)};if("getContext"===r)return function(){return e(t.getContext.apply(t,arguments),n)};var s=t[o(r,n)];return"function"==typeof s?s.bind(t):s},set:function(e,t,i){return e[o(t,n)]=i,!0}})};var n={width:"height",height:"width",overflowX:"overflowY",overflowY:"overflowX",clientWidth:"clientHeight",clientHeight:"clientWidth",clientX:"clientY",clientY:"clientX",scrollWidth:"scrollHeight",scrollLeft:"scrollTop",offsetLeft:"offsetTop",offsetTop:"offsetLeft",offsetHeight:"offsetWidth",offsetWidth:"offsetHeight",left:"top",right:"bottom",top:"left",bottom:"right",borderRightStyle:"borderBottomStyle",borderRightWidth:"borderBottomWidth",borderRightColor:"borderBottomColor"};function o(e,t){return Object.prototype.hasOwnProperty.call(n,e)&&t?n[e]:e}var i=Symbol("isProxy");e.exports=t.default},"./src/util/prevent-click.js":
/*!***********************************!*\
  !*** ./src/util/prevent-click.js ***!
  \***********************************/(e,t)=>{"use strict";function n(e){e.stopPropagation(),document.body.removeEventListener("click",n,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){document.body.addEventListener("click",n,!0)},e.exports=t.default},"./src/util/request-animation-frame.js":
/*!*********************************************!*\
  !*** ./src/util/request-animation-frame.js ***!
  \*********************************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return setTimeout(e,1e3/60)}).bind(window);t.default=n,e.exports=t.default},"./src/util/silence-mode.js":
/*!**********************************!*\
  !*** ./src/util/silence-mode.js ***!
  \**********************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=new AudioContext,t=e.createBufferSource();t.buffer=e.createBuffer(1,1,44100),t.connect(e.destination),t.start();var n=document.createElement("div");n.innerHTML='<audio x-webkit-airplay="deny"></audio>';var o=n.children.item(0);o.src="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQxAADgnABGiAAQBCqgCRMAAgEAH///////////////7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq//////////////////9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",o.preload="auto",o.type="audio/mpeg",o.disableRemotePlayback=!0,o.play(),o.remove(),n.remove()},e.exports=t.default},"./src/util/style.js":
/*!***************************!*\
  !*** ./src/util/style.js ***!
  \***************************/(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Object.keys(t).forEach((function(n){e.style[n]!==t[n]&&(e.style[n]=t[n])})),e},e.exports=t.default},"./src/wavesurfer.js":
/*!***************************!*\
  !*** ./src/wavesurfer.js ***!
  \***************************/(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==g(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var a=i?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(o,r,a):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}(n(/*! ./util */"./src/util/index.js")),i=u(n(/*! ./drawer.multicanvas */"./src/drawer.multicanvas.js")),r=u(n(/*! ./webaudio */"./src/webaudio.js")),a=u(n(/*! ./mediaelement */"./src/mediaelement.js")),s=u(n(/*! ./peakcache */"./src/peakcache.js")),l=u(n(/*! ./mediaelement-webaudio */"./src/mediaelement-webaudio.js"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=m(e);if(t){var i=m(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function v(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,k(o.key),o)}}function w(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e){var t=function(e,t){if("object"!==g(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==g(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===g(t)?t:String(t)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(n,e);var t=f(n);function n(e){var s;if(y(this,n),v(p(s=t.call(this)),"defaultParams",{audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!1},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,hideCursor:!1,ignoreSilenceMode:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:i.default,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,splitChannelsOptions:{overlay:!1,channelColors:{},filterChannels:[],relativeNormalization:!1,splitDragSelection:!1},vertical:!1,waveColor:"#999",xhr:{}}),v(p(s),"backends",{MediaElement:a.default,WebAudio:r.default,MediaElementWebAudio:l.default}),v(p(s),"util",o),s.params=Object.assign({},s.defaultParams,e),s.params.splitChannelsOptions=Object.assign({},s.defaultParams.splitChannelsOptions,e.splitChannelsOptions),s.container="string"==typeof e.container?document.querySelector(s.params.container):s.params.container,!s.container)throw new Error("Container element not found");if(null==s.params.mediaContainer?s.mediaContainer=s.container:"string"==typeof s.params.mediaContainer?s.mediaContainer=document.querySelector(s.params.mediaContainer):s.mediaContainer=s.params.mediaContainer,!s.mediaContainer)throw new Error("Media Container element not found");if(s.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(s.params.maxCanvasWidth%2==1)throw new Error("maxCanvasWidth must be an even number");if(!0===s.params.rtl&&(!0===s.params.vertical?o.style(s.container,{transform:"rotateX(180deg)"}):o.style(s.container,{transform:"rotateY(180deg)"})),s.params.backgroundColor&&s.setBackgroundColor(s.params.backgroundColor),s.savedVolume=0,s.isMuted=!1,s.tmpEvents=[],s.currentRequest=null,s.arraybuffer=null,s.drawer=null,s.backend=null,s.peakCache=null,"function"!=typeof s.params.renderer)throw new Error("Renderer parameter is invalid");s.Drawer=s.params.renderer,"AudioElement"==s.params.backend&&(s.params.backend="MediaElement"),"WebAudio"!=s.params.backend&&"MediaElementWebAudio"!==s.params.backend||r.default.prototype.supportsWebAudio.call(null)||(s.params.backend="MediaElement"),s.Backend=s.backends[s.params.backend],s.initialisedPluginList={},s.isDestroyed=!1,s.isReady=!1;var u=0;return s._onResize=o.debounce((function(){s.drawer.wrapper&&u!=s.drawer.wrapper.clientWidth&&!s.params.scrollParent&&(u=s.drawer.wrapper.clientWidth)&&s.drawer.fireEvent("redraw")}),"number"==typeof s.params.responsive?s.params.responsive:100),h(s,p(s))}return w(n,[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(e){var t=this;return e.forEach((function(e){return t.addPlugin(e)})),e.forEach((function(e){e.deferInit||t.initPlugin(e.name)})),this.fireEvent("plugins-registered",e),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(e){var t=this;if(!e.name)throw new Error("Plugin does not have a name!");if(!e.instance)throw new Error("Plugin ".concat(e.name," does not have an instance property!"));e.staticProps&&Object.keys(e.staticProps).forEach((function(n){t[n]=e.staticProps[n]}));var n=e.instance;return Object.getOwnPropertyNames(o.Observer.prototype).forEach((function(e){n.prototype[e]=o.Observer.prototype[e]})),this[e.name]=new n(e.params||{},this),this.fireEvent("plugin-added",e.name),this}},{key:"initPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet!"));return this.initialisedPluginList[e]&&this.destroyPlugin(e),this[e].init(),this.initialisedPluginList[e]=!0,this.fireEvent("plugin-initialised",e),this}},{key:"destroyPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[e])throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"));if("function"!=typeof this[e].destroy)throw new Error("Plugin ".concat(e," does not have a destroy function!"));return this[e].destroy(),delete this.initialisedPluginList[e],this.fireEvent("plugin-destroyed",e),this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach((function(t){return e.destroyPlugin(t)}))}},{key:"createDrawer",value:function(){var e=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",(function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())})),this.drawer.on("click",(function(t,n){setTimeout((function(){return e.seekTo(n)}),0)})),this.drawer.on("scroll",(function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)})),this.drawer.on("dblclick",(function(t,n){e.fireEvent("dblclick",t,n)}))}},{key:"createBackend",value:function(){var e=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",(function(){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("finish")})),this.backend.on("play",(function(){return e.fireEvent("play")})),this.backend.on("pause",(function(){return e.fireEvent("pause")})),this.backend.on("audioprocess",(function(t){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("audioprocess",t)})),"MediaElement"!==this.params.backend&&"MediaElementWebAudio"!==this.params.backend||(this.backend.on("seek",(function(){e.drawer.progress(e.backend.getPlayedPercents())})),this.backend.on("volume",(function(){var t=e.getVolume();e.fireEvent("volume",t),e.backend.isMuted!==e.isMuted&&(e.isMuted=e.backend.isMuted,e.fireEvent("mute",e.isMuted))})))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new s.default)}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){e>=this.getDuration()?this.seekTo(1):this.seekTo(e/this.getDuration())}},{key:"play",value:function(e,t){var n=this;return this.params.ignoreSilenceMode&&o.ignoreSilenceMode(),this.fireEvent("interaction",(function(){return n.play(e,t)})),this.backend.play(e,t)}},{key:"setPlayEnd",value:function(e){this.backend.setPlayEnd(e)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var t=this.getDuration()||1,n=this.getCurrentTime()||0;n=Math.max(0,Math.min(t,n+(e||0))),this.seekAndCenter(n/t)}},{key:"seekAndCenter",value:function(e){this.seekTo(e),this.drawer.recenter(e)}},{key:"seekTo",value:function(e){var t=this;if("number"!=typeof e||!isFinite(e)||e<0||e>1)throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",(function(){return t.seekTo(e)}));var n="WebAudio"===this.params.backend,o=this.backend.isPaused();n&&!o&&this.backend.pause();var i=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(e*this.getDuration()),this.drawer.progress(e),n&&!o&&this.backend.play(),this.params.scrollParent=i,this.fireEvent("seek",e)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(e){return this.backend.setSinkId(e)}},{key:"setVolume",value:function(e){!0!==this.isMuted?(this.backend.setVolume(e),this.fireEvent("volume",e)):this.savedVolume=e}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){e!==this.isMuted?(this.backend.setMute?(this.backend.setMute(e),this.isMuted=e):e?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),this.fireEvent("mute",this.isMuted)):this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].waveColor:this.params.waveColor}},{key:"setWaveColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].waveColor=e:this.params.waveColor=e,this.drawBuffer()}},{key:"getProgressColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].progressColor:this.params.progressColor}},{key:"setProgressColor",value:function(e,t){this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].progressColor=e:this.params.progressColor=e,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(e){this.params.backgroundColor=e,o.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(e){this.params.cursorColor=e,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(e){this.params.height=e,this.drawer.setHeight(e*this.params.pixelRatio),this.drawBuffer()}},{key:"setFilteredChannels",value:function(e){this.params.splitChannelsOptions.filterChannels=e,this.drawBuffer()}},{key:"drawBuffer",value:function(){var e,t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),n=this.drawer.getWidth(),o=t,i=0,r=Math.max(i+n,o);if(this.params.fillParent&&(!this.params.scrollParent||t<n)&&(i=0,r=o=n),this.params.partialRender){var a,s=this.peakCache.addRangeToPeakCache(o,i,r);for(a=0;a<s.length;a++)e=this.backend.getPeaks(o,s[a][0],s[a][1]),this.drawer.drawPeaks(e,o,s[a][0],s[a][1])}else e=this.backend.getPeaks(o,i,r),this.drawer.drawPeaks(e,o,i,r);this.fireEvent("redraw",e,o)}},{key:"zoom",value:function(e){e?(this.params.minPxPerSec=e,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)}},{key:"loadArrayBuffer",value:function(e){var t=this;this.decodeArrayBuffer(e,(function(e){t.isDestroyed||t.loadDecodedBuffer(e)}))}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(e){var t=this,n=new FileReader;n.addEventListener("progress",(function(e){return t.onProgress(e)})),n.addEventListener("load",(function(e){return t.loadArrayBuffer(e.target.result)})),n.addEventListener("error",(function(){return t.fireEvent("error","Error reading file")})),n.readAsArrayBuffer(e),this.empty()}},{key:"load",value:function(e,t,n,o){if(!e)throw new Error("url parameter cannot be empty");if(this.empty(),n){var i={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(n),"Peaks are not provided":!t,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!=typeof e},r=Object.keys(i).filter((function(e){return i[e]}));r.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+r.join("\n\t- ")),n=null)}switch("WebAudio"===this.params.backend&&e instanceof HTMLMediaElement&&(e=e.src),this.params.backend){case"WebAudio":return this.loadBuffer(e,t,o);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(e,t,n,o)}}},{key:"loadBuffer",value:function(e,t,n){var o=this,i=function(t){return t&&o.tmpEvents.push(o.once("ready",t)),o.getArrayBuffer(e,(function(e){return o.loadArrayBuffer(e)}))};if(!t)return i();this.backend.setPeaks(t,n),this.drawBuffer(),this.fireEvent("waveform-ready"),this.tmpEvents.push(this.once("interaction",i))}},{key:"loadMediaElement",value:function(e,t,n,o){var i=this,r=e;if("string"==typeof e)this.backend.load(r,this.mediaContainer,t,n);else{var a=e;this.backend.loadElt(a,t),r=a.src}this.tmpEvents.push(this.backend.once("canplay",(function(){i.backend.destroyed||(i.drawBuffer(),i.isReady=!0,i.fireEvent("ready"))})),this.backend.once("error",(function(e){return i.fireEvent("error",e)}))),t&&(this.backend.setPeaks(t,o),this.drawBuffer(),this.fireEvent("waveform-ready")),t&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(r,(function(e){i.decodeArrayBuffer(e,(function(e){i.backend.buffer=e,i.backend.setPeaks(null),i.drawBuffer(),i.fireEvent("waveform-ready")}))}))}},{key:"decodeArrayBuffer",value:function(e,t){var n=this;this.isDestroyed||(this.arraybuffer=e,this.backend.decodeArrayBuffer(e,(function(o){n.isDestroyed||n.arraybuffer!=e||(t(o),n.arraybuffer=null)}),(function(){return n.fireEvent("error","Error decoding audiobuffer")})))}},{key:"getArrayBuffer",value:function(e,t){var n=this,i=Object.assign({url:e,responseType:"arraybuffer"},this.params.xhr),r=o.fetchFile(i);return this.currentRequest=r,this.tmpEvents.push(r.on("progress",(function(e){n.onProgress(e)})),r.on("success",(function(e){t(e),n.currentRequest=null})),r.on("error",(function(e){n.fireEvent("error",e),n.currentRequest=null}))),r}},{key:"onProgress",value:function(e){var t;t=e.lengthComputable?e.loaded/e.total:e.loaded/(e.loaded+1e6),this.fireEvent("loading",Math.round(100*t),e.target)}},{key:"exportPCM",value:function(e,t,n,o,i){e=e||1024,o=o||0,t=t||1e4,n=n||!1;var r=this.backend.getPeaks(e,o,i),a=[].map.call(r,(function(e){return Math.round(e*t)/t}));return new Promise((function(e,t){if(!n){var o=new Blob([JSON.stringify(a)],{type:"application/json;charset=utf-8"}),i=URL.createObjectURL(o);window.open(i),URL.revokeObjectURL(i)}e(a)}))}},{key:"exportImage",value:function(e,t,n){return e||(e="image/png"),t||(t=1),n||(n="dataURL"),this.drawer.getImage(e,t,n)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest._reader&&this.currentRequest._reader.cancel().catch((function(e){})),this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach((function(e){return e.un()}))}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&(this.backend.destroy(),this.backend=null),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}],[{key:"create",value:function(e){return new n(e).init()}}]),n}(o.Observer);t.default=C,v(C,"VERSION","6.6.4"),v(C,"util",o),e.exports=t.default},"./src/webaudio.js":
/*!*************************!*\
  !*** ./src/webaudio.js ***!
  \*************************/(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=a?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(o,s,l):o[s]=e[s]}return o.default=e,n&&n.set(e,o),o}(n(/*! ./util */"./src/util/index.js"));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,f(o.key),o)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,n)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function d(e,t,n){return(t=f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}var h="playing",p="paused",m="finished",v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(c,e);var t,n,i,r=l(c);function c(e){var t,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),d(u(o=r.call(this)),"audioContext",null),d(u(o),"stateBehaviors",(d(t={},h,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),d(t,p,{init:function(){},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),d(t,m,{init:function(){this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),t)),o.params=e,o.ac=e.audioContext||(o.supportsWebAudio()?o.getAudioContext():{}),o.lastPlay=o.ac.currentTime,o.startPosition=0,o.scheduledPause=null,o.states=(d(n={},h,Object.create(o.stateBehaviors[h])),d(n,p,Object.create(o.stateBehaviors[p])),d(n,m,Object.create(o.stateBehaviors[m])),n),o.buffer=null,o.filters=[],o.gainNode=null,o.mergedPeaks=null,o.offlineAc=null,o.peaks=null,o.playbackRate=1,o.analyser=null,o.scriptNode=null,o.source=null,o.splitPeaks=[],o.state=null,o.explicitDuration=e.duration,o.sinkStreamDestination=null,o.sinkAudioElement=null,o.destroyed=!1,o}return t=c,n=[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(e){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),window.WaveSurferOfflineAudioContext}},{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(p),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach((function(e){e&&e.disconnect()})),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.setFilters(t)}},{key:"setFilters",value:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce((function(e,t){return e.connect(t),t}),this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor&&(this.scriptNode=this.params.audioScriptProcessor,this.scriptNode.connect(this.ac.destination))}},{key:"addOnAudioProcess",value:function(){var e=this;!function t(){var n=e.getCurrentTime();n>=e.getDuration()&&e.state!==e.states[m]?(e.setState(m),e.fireEvent("pause")):n>=e.scheduledPause&&e.state!==e.states[p]?e.pause():e.state===e.states[h]&&(e.fireEvent("audioprocess",n),o.frame(t)())}()}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(e){return e?(this.sinkAudioElement||(this.sinkAudioElement=new window.Audio,this.sinkAudioElement.autoplay=!0),this.sinkAudioElement.setSinkId?(this.sinkStreamDestination||(this.sinkStreamDestination=this.ac.createMediaStreamDestination()),this.gainNode.disconnect(),this.gainNode.connect(this.sinkStreamDestination),this.sinkAudioElement.srcObject=this.sinkStreamDestination.stream,this.sinkAudioElement.setSinkId(e)):Promise.reject(new Error("setSinkId is not supported in your browser"))):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"setVolume",value:function(e){this.gainNode.gain.setValueAtTime(e,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,t,n){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),"webkitAudioContext"in window?this.offlineAc.decodeAudioData(e,(function(e){return t(e)}),n):this.offlineAc.decodeAudioData(e).then((function(e){return t(e)})).catch((function(e){return n(e)}))}},{key:"setPeaks",value:function(e,t){null!=t&&(this.explicitDuration=t),this.peaks=e}},{key:"setLength",value:function(e){if(!this.mergedPeaks||e!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var t,n=this.buffer?this.buffer.numberOfChannels:1;for(t=0;t<n;t++)this.splitPeaks[t]=[],this.splitPeaks[t][2*(e-1)]=0,this.splitPeaks[t][2*(e-1)+1]=0;this.mergedPeaks[2*(e-1)]=0,this.mergedPeaks[2*(e-1)+1]=0}}},{key:"getPeaks",value:function(e,t,n){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(t=t||0,n=n||e-1,this.setLength(e),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var o=this.createBuffer(1,4096,this.sampleRate);this.buffer=o.buffer}var i,r=this.buffer.length/e,a=~~(r/10)||1,s=this.buffer.numberOfChannels;for(i=0;i<s;i++){var l=this.splitPeaks[i],u=this.buffer.getChannelData(i),c=void 0;for(c=t;c<=n;c++){var d=~~(c*r),f=~~(d+r),h=u[d],p=h,m=void 0;for(m=d;m<f;m+=a){var v=u[m];v>p&&(p=v),v<h&&(h=v)}l[2*c]=p,l[2*c+1]=h,(0==i||p>this.mergedPeaks[2*c])&&(this.mergedPeaks[2*c]=p),(0==i||h<this.mergedPeaks[2*c+1])&&(this.mergedPeaks[2*c+1]=h)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroyWebAudio",value:function(){this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode&&this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"==typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null),this.sinkStreamDestination&&(this.sinkAudioElement.pause(),this.sinkAudioElement.srcObject=null,this.sinkStreamDestination.disconnect(),this.sinkStreamDestination=null)}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.destroyWebAudio()}},{key:"load",value:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.setPlaybackRate(this.playbackRate),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"resumeAudioContext",value:function(){"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume()}},{key:"isPaused",value:function(){return this.state!==this.states[h]}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(e,t){if(this.buffer)return this.scheduledPause=null,null==e&&(e=this.getCurrentTime())>=this.getDuration()&&(e=0),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states[m]&&this.setState(p),{start:e,end:t}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,t){if(this.buffer){this.createSource();var n=this.seekTo(e,t);e=n.start,t=n.end,this.scheduledPause=t,this.source.start(0,e),this.resumeAudioContext(),this.setState(h),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime();try{this.source&&this.source.stop(0)}catch(e){}this.setState(p),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.source&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime)}},{key:"setPlayEnd",value:function(e){this.scheduledPause=e}}],n&&a(t.prototype,n),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.Observer);t.default=v,e.exports=t.default},"./node_modules/debounce/index.js":
/*!****************************************!*\
  !*** ./node_modules/debounce/index.js ***!
  \****************************************/e=>{function t(e,t,n){var o,i,r,a,s;function l(){var u=Date.now()-a;u<t&&u>=0?o=setTimeout(l,t-u):(o=null,n||(s=e.apply(r,i),r=i=null))}null==t&&(t=100);var u=function(){r=this,i=arguments,a=Date.now();var u=n&&!o;return o||(o=setTimeout(l,t)),u&&(s=e.apply(r,i),r=i=null),s};return u.clear=function(){o&&(clearTimeout(o),o=null)},u.flush=function(){o&&(s=e.apply(r,i),r=i=null,clearTimeout(o),o=null)},u}t.debounce=t,e.exports=t}},t={},n=function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}("./src/wavesurfer.js");return n})(),e.exports=t()},52452:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var o=n(17819);function i(e,t,n){if("undefined"==typeof window)return;if("object"!=typeof t||t&&"nodeType"in t&&1!==t.nodeType)throw new Error("First argument must be an element");const i={container:window,top:0,right:0,bottom:0,left:0};let r;(0,o.DD)(n)?(r={...i},o.mA.forEach((e=>{e!==n&&(r[e]="ignore")}))):(0,o.LY)(n)?(r={...i},o.mA.forEach((e=>{n.split(" ").includes(e)||(r[e]="ignore")}))):r=Object.assign({},i,n);const a=Object.assign({},i,r);return a.container===document.body||a.container&&"nodeName"in a.container&&"BODY"===a.container.nodeName||a.container&&"nodeType"in a.container&&1!==a.container.nodeType?a.container="sync"===e?window:document:"async"===e&&a.container===window&&(a.container=document),a}},17819:function(e,t,n){"use strict";n.d(t,{DD:function(){return i},LY:function(){return r},mA:function(){return o}});const o=["top","right","bottom","left"];function i(e){return Boolean(e)&&"string"==typeof e&&o.includes(e)}function r(e){return"string"==typeof e&&e.split(" ").every((t=>e.includes(t)))}},65803:function(e,t,n){"use strict";n.d(t,{uJ:function(){return o.u}});var o=n(91064);const i=(r=void 0,"undefined"!=typeof self?self:"undefined"!=typeof window?window:r);var r;!async function(){if(!i)return;const e=await n.e(6172).then(n.bind(n,56172));"function"==typeof e&&("jQuery"in i?e(i.jQuery):"$"in i&&e(i.$))}()},91064:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var o=n(52452),i=n(17819);function r(e,t){let n,r=0,a=0;const s=[0,0],l=(0,o.i)("sync",e,t),u=l.container===window,c=e.getBoundingClientRect();l.container===window?(n=document.documentElement.getBoundingClientRect(),r=document.body.scrollTop,a=window.scrollX||document.body.scrollLeft):l.container&&l.container!==window&&(n=l.container.getBoundingClientRect(),r=l.container.scrollTop,a=l.container.scrollLeft),a&&(s[0]=18),r&&(s[1]=16);const d={top(){return"ignore"===l.top||(u?c.top>=l.top:c.top>=r-(r-n.top)+l.top)},right(){return"ignore"===l.right||(u?c.right<=n.right+a-l.right:c.right<=n.right-s[0]-l.right)},bottom(){if("ignore"===l.bottom)return!0;let e=0;return e=l.container===window?l.container.innerHeight:n.bottom,c.bottom<=e-s[1]-l.bottom},left(){return"ignore"===l.left||(u?c.left>=l.left:c.left>=a-(a-n.left)+l.left)},all(){return d.top()&&d.bottom()&&d.left()&&d.right()}};return i.mA.every((e=>d[e]()))}}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e].call(r.exports,r,r.exports,o),r.exports}o.m=t,o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))},o.u=function(e){return"js/dist/chunk/"+e+"_8c26329cbbc1e5a2.js"},o.miniCssF=function(e){},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},o.l=function(t,n,i,r){if(e[t])e[t].push(n);else{var a,s;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var c=l[u];if(c.getAttribute("src")==t){a=c;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.src=t),e[t]=[n];var d=function(n,o){a.onerror=a.onload=null,clearTimeout(f);var i=e[t];if(delete e[t],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((function(e){return e(o)})),n)return n(o)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),s&&document.head.appendChild(a)}},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="/",void 0!==o&&Object.defineProperty(o,"p",{get:function(){try{if("string"!=typeof chunkCdnUrl)throw new Error("WebpackRequireFrom: 'chunkCdnUrl' is not a string or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return chunkCdnUrl}catch(e){return console.error(e),"/"}},set:function(e){console.warn("WebpackRequireFrom: something is trying to override webpack public path. Ignoring the new value"+e+".")}}),function(){var e={9472:0};o.f.j=function(t,n){var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise((function(n,o){i=e[t]=[n,o]}));n.push(i[2]=r);var a=o.p+o.u(t),s=new Error;o.l(a,(function(n){if(o.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",s.name="ChunkLoadError",s.type=r,s.request=a,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,n){var i,r,a=n[0],s=n[1],l=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)o.o(s,i)&&(o.m[i]=s[i]);if(l)l(o)}for(t&&t(n);u<a.length;u++)r=a[u],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),function(){"use strict";o(83412);function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function r(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,n||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:String(n)}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selectors={wrapper:".js-loader-wrapper"},this.el=void 0}var n,o,r;return n=e,o=[{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.el=e?document.querySelector(e):document.body,this.el){var n=t(Array(12).fill('<div class="ispinner__blade"></div>')).join(""),o='\n\t\t\t<div class="js-loader-wrapper modal-loader-wrapper">\n\t\t\t\t<div class="modal-loader modal-loader--white">\n\t\t\t\t\t<div class="ispinner ispinner--gray ispinner--animating ispinner--large">\n\t\t\t\t\t\t'.concat(n,"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>");window.lockBodyForPopup(),this.el.insertAdjacentHTML("beforeend",o)}}},{key:"remove",value:function(){var e=this.el.querySelector(this.selectors.wrapper);e&&(window.unlockBodyForPopup(),e.remove())}}],o&&i(n.prototype,o),r&&i(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,c(o.key),o)}}function c(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=s(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:String(t)}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"getSortedCategories",value:function(e){var t=null;return t=Array.isArray(e)?e:Object.values(e),_.sortBy(t,[function(e){return parseInt(e.sort_index)},function(e){var t=e.CATID||e.id;return-1*parseInt(t)}])}}],(n=null)&&u(t.prototype,n),o&&u(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,p(o.key),o)}}function p(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=f(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:String(t)}var m,v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"uploadedFileIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.substring(e.lastIndexOf(".")+1).toLowerCase(),o="default";return _.indexOf(["doc","docx"],n)>=0?o="word":_.indexOf(["xls","xlsx","csv"],n)>=0?o="excel":_.indexOf(["ppt","pptx","pptm"],n)>=0?o="powerpoint":_.indexOf(["pdf"],n)>=0?o="pdf":_.indexOf(["txt","ini","cfg","rtf","html"],n)>=0?o="alt":_.indexOf(["php","js","cpp","css","scss","cs"],n)>=0?o="code":_.indexOf(["mp3","wav","flac","midi","aac"],n)>=0?o="audio":_.indexOf(["wmv","avi","mp4","flv","mov","mkv","mpeg"],n)>=0?o="video":_.indexOf(["zip","7z","rar","rar5","tar","gz","gzip"],n)>=0?o="archive":_.indexOf(["png","jpg","jpeg","gif","raw","tif","cdr","bmp","tiff","ai","eps","svg","dib"],n)>=0?o="image":_.indexOf(["psd"],n)>=0&&(o="psd"),"file-icon file-icon--".concat(o+=t?" file-icon--small":"")}},{key:"getExtension",value:function(e){return _.toLower(e.substring(_.lastIndexOf(e,".")+1))}}],(n=null)&&h(t.prototype,n),o&&h(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function y(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return(t=O(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,O(o.key),o)}}function O(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=g(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:String(t)}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url="/",this.fileName="file",this.file=null,this.postData={},this.aborted=!1,this.maxFileSize=null,this.minFileSize=30720,this.minImageWidth=660,this.minImageHeight=440,this.maxImageWidth=6e3,this.maxImageHeight=1e4,this.mimeTypes=null,this.minVideoResolution=null,this.onError=function(){},m?this.input=m:((m=$('<input type="file" class="d-none" />')).prependTo("body"),this.input=m,this.input.on("change",(function(e){$(e.target).data("loadHandler").fileUpload(e)}))),this.fileTypes={image:{type:"image",mimeTypes:{"image/jpeg":["jpg","jpeg"],"image/gif":["gif"],"image/png":["png"]},maxFileSize:e.convertFileSize(10),uploadEndpoint:"/portfolio/upload_image"},video:{type:"video",mimeTypes:{"video/mp4":["mp4"],"video/avi":["avi"],"video/x-msvideo":["avi"],"video/quicktime":["mov"],"video/mov":["mov"]},maxFileSize:e.convertFileSize(50),maxDuration:75,uploadEndpoint:"/portfolio/upload_video"},pdf:{type:"pdf",mimeTypes:{"application/pdf":["pdf"]},maxFileSize:e.convertFileSize(10),uploadEndpoint:"/portfolio/upload_pdf"},audio:{type:"audio",mimeTypes:{"audio/mpeg":["mp3"]},maxFileSize:e.convertFileSize(10),minDuration:3,maxDuration:210,uploadEndpoint:"/portfolio/upload_audio"}},this.fileHeaders={"application/pdf":["25504446"],"audio/mpeg":["49443304","49443303"],"image/gif":["47494638"],"image/jpeg":["ffd8ffe0","ffd8ffe1","ffd8ffe2","ffd8ffe3","ffd8ffe8"],"image/png":["89504e47"],"video/avi":["41564920","52494646"],"video/mov":["6D6F6F76","00000014"],"video/mp4":["00000018","00000020"]},this.currentFileHeader="",this.errors={bigFileSizeVideo:l("maxSizeExceeded","components/file-uploader/file-uploader",{size:e.convertFileSize(this.fileTypes.video.maxFileSize,!1)}),bigFileSize:l("maxSizeExceeded","components/file-uploader/file-uploader",{size:e.convertFileSize(this.fileTypes.image.maxFileSize,!1)}),smallFilesize:l("smallFileSize","components/file-uploader/file-uploader",{size:30}),incorrectType:l("invalidFileTypeVideo","components/file-uploader/file-uploader"),incorrectTypePdf:l("invalidFileTypePdf","components/file-uploader/file-uploader"),incorrectTypeCover:l("invalidFileType","components/file-uploader/file-uploader"),mediaBroken:l("mediaBroken","validator/portfolio"),bigFileSizeAudio:l("maxSizeExceeded","components/file-uploader/file-uploader",{size:e.convertFileSize(this.fileTypes.audio.maxFileSize,!1)}),incorrectTypeAudio:l("invalidFileTypeAudio","components/file-uploader/file-uploader")},this.checkVideoThumbnailReadyInterval=null}var t,n,o;return t=e,n=[{key:"getExtensions",value:function(){if(!this.mimeTypes)return"";var e=[];_.forOwn(this.fileTypes,(function(t){e=k(k({},e),t.mimeTypes)}));var t=[];return _.forEach(this.mimeTypes,(function(n){e[n]&&t.push(Object.values(e[n]).map((function(e){return".".concat(e)})))})),t.join(",")}},{key:"upload",value:function(){this.input.attr("accept",this.getExtensions()),this.input.data("loadHandler",this),this.input.trigger("click")}},{key:"checkFileTypeByExtension",value:function(e,t){var n=[];return _.forOwn(this.fileTypes[t].mimeTypes,(function(e){n=[].concat(y(n),y(e))})),n.includes(e.replace(/\s/g,""))}},{key:"fileUpload",value:function(){var e=this;this.abort();var t=this.input.get(0).files[0],n=v.getExtension(t.name),o=t.type;if(this.file=t,this.input.val(""),!o){n="",this.currentFileHeader="";var i=t.slice(0,4),r=new FileReader;return r.onloadend=function(i){for(var r=new Uint8Array(i.target.result).subarray(0,4),a="",s=0;s<r.length;s+=1)a+=r[s].toString(16).padStart(2,"0");var l=_.findKey(e.fileHeaders,(function(e){return _.includes(e,a)}));o=l,_.forOwn(e.fileTypes,(function(e){e.mimeTypes[l]&&(n=e.mimeTypes[l][0])})),e.currentFileHeader=l,t=new File([t],"".concat(t.name,".").concat(n),{type:l}),e.checkFileAndUpload(n,t,o)},void r.readAsArrayBuffer(i)}this.checkFileAndUpload(n,t,o)}},{key:"checkFileAndUpload",value:function(e,t,n){var o,i=this;if(this.checkFileTypeByExtension(e,this.fileTypes.video.type)?this.maxFileSize=this.fileTypes.video.maxFileSize:this.checkFileTypeByExtension(e,this.fileTypes.audio.type)?this.maxFileSize=this.fileTypes.audio.maxFileSize:this.maxFileSize=this.fileTypes.image.maxFileSize,t.size>this.maxFileSize)this.onError&&(this.checkFileTypeByExtension(e,this.fileTypes.video.type)?this.onError(this.errors.bigFileSizeVideo):this.checkFileTypeByExtension(e,this.fileTypes.audio.type)?this.onError(this.errors.bigFileSizeAudio):this.onError(this.errors.bigFileSize));else if(t.size<this.minFileSize)this.onError&&this.onError(this.errors.smallFilesize);else if(this.mimeTypes&&-1==$.inArray(n,this.mimeTypes))this.onError&&("cover"===this.type?this.onError(this.errors.incorrectTypeCover):-1!==$.inArray("application/pdf",this.mimeTypes)?this.onError(this.errors.incorrectTypePdf):this.mimeTypes.some((function(e){return Object.keys(i.fileTypes.audio.mimeTypes).includes(e)}))?this.onError(this.errors.incorrectTypeAudio):this.onError(this.errors.incorrectType));else if((null===(o=window.portfolioList)||void 0===o?void 0:o.modal.portfolioType)===this.fileTypes.audio.type&&"cover"===this.type&&(this.postData.ignore_hash=!0),this.checkFileTypeByExtension(e,this.fileTypes.pdf.type))this.readPdfForPreview(t,(function(){i.url=i.fileTypes.pdf.uploadEndpoint,i.fileUploadAjax(t)}));else if(this.checkFileTypeByExtension(e,this.fileTypes.video.type)){var r;null!==(r=window.portfolioList)&&void 0!==r&&r.modal&&(this.postData=k(k({},window.portfolioList.modal.getMediaHashValues()),this.postData)),this.url=this.fileTypes.video.uploadEndpoint,this.readMediaForPreview(this.fileTypes.video.type,t,(function(){i.fileUploadAjax(t,!0)}))}else if(this.checkFileTypeByExtension(e,this.fileTypes.audio.type)){var a;null!==(a=window.portfolioList)&&void 0!==a&&a.modal&&(this.postData=k(k({},window.portfolioList.modal.getMediaHashValues(!0)),this.postData)),this.url=this.fileTypes.audio.uploadEndpoint,this.readMediaForPreview(this.fileTypes.audio.type,t,(function(){i.fileUploadAjax(t)}))}else this.readMediaForPreview(this.fileTypes.image.type,t,(function(){"cover"!==i.type&&(i.url=i.fileTypes.image.uploadEndpoint),i.fileUploadAjax(t)}))}},{key:"fileUploadAjax",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=new FormData;$.each(this.postData,(function(e,t){o.append(e,t)})),o.append(this.fileName,e),this.xhr=$.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var n=parseInt(e.loaded/e.total*100);t.onProgress&&t.onProgress(n)}}),!1),e},url:this.url,data:o,async:!0,contentType:!1,processData:!1,type:"POST",complete:function(o){if(!t.aborted){var i,r={};try{r=JSON.parse(o.responseText)}catch(e){}if("success"in r&&1==r.success){if(t.onSuccess)if(t.onSuccess(r.data),t.file=null,n)t.checkFileThumbnailReady((null===(i=r.data)||void 0===i?void 0:i.id)||null);else if("image/gif"===e.type){var a;t.checkFileThumbnailReady((null===(a=r.data)||void 0===a?void 0:a.id)||null,!0)}}else t.onFail&&t.onFail(r.data||r.error)}}})}},{key:"readPdfForPreview",value:function(e,t){var n=this,o=new FileReader;o.onload=function(){var e=new Uint8Array(o.result);pdfjsLib.getDocument({data:e}).promise.then((function(e){e.getPage(1).then((function(e){var o=e.getViewport({scale:1}),i=document.createElement("canvas"),r={viewport:o,canvasContext:i.getContext("2d")},a=n.limitCanvasViewport(o);i.height=a.height,i.width=a.width,e.render(r).promise.then((function(){var e,o=i.toDataURL();null===(e=n.onLoad)||void 0===e||e.call(n,o,n.fileTypes.pdf.type),t()}))}))})).catch((function(){t()}))},o.readAsArrayBuffer(e)}},{key:"limitCanvasViewport",value:function(e){return{width:e.width>this.maxImageWidth?this.maxImageWidth:e.width,height:e.height>this.maxImageHeight?this.maxImageHeight:e.height}}},{key:"readMediaForPreview",value:function(e,t,n){var o,i=this,r=[].concat(y(this.fileTypes.video.mimeTypes["video/avi"]),y(this.fileTypes.video.mimeTypes["video/quicktime"])),a=e===this.fileTypes.video.type;if(a&&r.includes(v.getExtension(t.name)))return null===(o=this.onLoad)||void 0===o||o.call(this,URL.createObjectURL(t),e),void n();var s=e===this.fileTypes.image.type,u=e===this.fileTypes.audio.type,c=new FileReader;c.onload=function(){var o,r,d=i.fileTypes[e].maxDuration;o=s?new Image:document.createElement(e),s?(r="onload",o.src=i.currentFileHeader?c.result.replace("application/octet-stream",i.currentFileHeader):c.result):a?(Utils.isIos()&&(o.autoplay=!0),r="onloadeddata",o.src=URL.createObjectURL(t)):u&&(r="onloadedmetadata",o.src=URL.createObjectURL(t)),o[r]=function(){var t;s&&!i.validateImageResolution(o)||a&&!i.validateVideoResolution(o)||(a&&Math.floor(o.duration)>d?i.onError(l("maxFileDuration","components/portfolio-upload-modal",{fileType:e,maxDuration:d})):(null===(t=i.onLoad)||void 0===t||t.call(i,o.src,e),n()))},o.addEventListener("error",(function(e){n()}))},s?c.readAsDataURL(t):c.readAsArrayBuffer(t)}},{key:"checkMinImageResolution",value:function(e){return!(e.naturalWidth<this.minImageWidth||e.naturalHeight<this.minImageHeight)}},{key:"checkMaxImageResolution",value:function(e){return!(e.width>this.maxImageWidth||e.height>this.maxImageHeight)}},{key:"validateImageResolution",value:function(e){return this.checkMinImageResolution(e)?!!this.checkMaxImageResolution(e)||(this.onError(l("maxImageResolution","components/file-uploader/file-uploader",{width:this.maxImageWidth,height:this.maxImageHeight})),!1):(this.onError(l("minImageResolution","components/file-uploader/file-uploader",{width:this.minImageWidth,height:this.minImageHeight})),!1)}},{key:"getVideoResolutionError",value:function(e){var t,n,o;return e.isVertical||e.width<=e.height?(t=this.minVideoResolution.vertical.width,n=this.minVideoResolution.vertical.height,o=this.minVideoResolution.vertical.text):(t=this.minVideoResolution.horizontal.width,n=this.minVideoResolution.horizontal.height,o=this.minVideoResolution.horizontal.text),e.isLowWidth&&e.isLowHeight||e.width<t&&e.height<n?l("minVideoResolution","components/file-uploader/file-uploader",{resolution:o}):e.isLowWidth||e.width<t?l("minVideoWidth","components/file-uploader/file-uploader",{width:t}):e.isLowHeight||e.height<n?l("minVideoHeight","components/file-uploader/file-uploader",{height:n}):""}},{key:"validateVideoResolution",value:function(e){if(!e||!e.videoWidth||!e.videoHeight)return!0;var t=this.getVideoResolutionError({width:e.videoWidth,height:e.videoHeight});return!t.length||(this.onError(t),!1)}},{key:"checkResponse",value:function(e){var t="string"!=typeof e?JSON.stringify(e):e;try{t=JSON.parse(t)}catch(e){return!1}return"object"===g(t)&&null!==t}},{key:"abort",value:function(){this.xhr&&(this.aborted=!0,this.xhr.abort(),this.aborted=!1)}},{key:"checkFileThumbnailReady",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n?this.requestFileCheck(e,n):this.checkVideoThumbnailReadyInterval=setInterval((function(){t.requestFileCheck(e,n)}),15e3)}},{key:"requestFileCheck",value:function(e,t){var n=this,o="/portfolio/".concat(t?"check_gif_thumbnail_ready":"check_video_thumbnail_ready");axios.get(o,{params:{id:e}}).then((function(e){var o,i=e.data;i.success?(t||n.clearCheckVideoThumbnailReadyInterval(),i.data.hasError||null===(o=window.portfolioList)||void 0===o||null===(o=o.modal)||void 0===o||o.updatePortfolioVideoCover(i.data,!1)):t&&!i.data&&n.onGifError(n.errors.mediaBroken)})).catch((function(){}))}},{key:"clearCheckVideoThumbnailReadyInterval",value:function(){this.checkVideoThumbnailReadyInterval&&(clearInterval(this.checkVideoThumbnailReadyInterval),this.checkVideoThumbnailReadyInterval=null)}}],o=[{key:"convertFileSize",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?Math.round(e/1024/1024):1024*e*1024}}],n&&E(t.prototype,n),o&&E(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function P(e,t,n){return t=S(t),function(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,R()?Reflect.construct(t,n||[],S(e).constructor):t.apply(e,n))}function R(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(R=function(){return!!e})()}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}function x(e,t){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},x(e,t)}function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return(t=B(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,B(o.key),o)}}function V(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function B(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=I(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:String(t)}var F=function(){function e(){var t,n,o=this;L(this,e),this.addToListAfterLoad=!0,this.uploadableBase64=null,this.hasError=!1,this.textError="",this.portfolioType=window.portfolioType||"",this.isFocusGroup26771=window.isFocusGroup26771||!1,this.portfolioTypes={photo:"photo",video:"video",pdf:"pdf",audio:"audio"},this.portfolioModalAudio=null,this.selectors={requiredMessage:".js-form-required",requiredMessageNoRequired:"form-item__required--required-no",preview:{image:".js-portfolio-modal-image",audio:".js-portfolio-modal-audio",video:".js-portfolio-modal-video"},audioWavesurfer:".audio-wavesurfer",hidden:"d-none"},this.isTouchDevice=(null===(t=window.touchDetector)||void 0===t?void 0:t.lastActionIsTouch)||isMobile();var i=!this.isTouchDevice&&(!window.isPageTrack||(null===(n=window.portfolioList)||void 0===n?void 0:n.modal.isModalOpened));this.moveIcon=i?'\n\t\t\t\t<div class="js-move-icon portfolio-card-thumbnail__button move d-none">\n\t\t\t\t\t<svg class="portfolio-card-thumbnail__button-icon" xmlns="http://www.w3.org/2000/svg" fill="none">\n\t\t\t\t\t\t<path stroke="#333" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round" d="M9.866 12.992l-1.865 1.865m0 0l-1.864-1.865m1.864 1.865V10.11M6.135 3.008L8 1.143m0 0l1.864 1.865M8.001 1.143V5.89M3.008 9.865L1.143 8.001m0 0l1.865-1.865M1.143 8.001H5.89m7.102-1.866L14.857 8m0 0l-1.865 1.864M14.857 8H10.11" />\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t':"",this.cardThumbnailButtons=function(){return'\n\t\t\t<div class="portfolio-card-thumbnail__buttons">\n\t\t\t\t<button type="button" class="portfolio-card-thumbnail__button delete" title="'+l("srcLegacyJsPortfolioUploadSortableCardJs1","legacy-translations")+'">\n\t\t\t\t\t<svg class="portfolio-card-thumbnail__button-icon" viewBox="0 0 12 13" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M8 1.353V0H4v1.353H0v1.353h12V1.353H8zM1.333 3.383v8.12c0 .746.598 1.354 1.334 1.354h6.666c.736 0 1.334-.608 1.334-1.353V3.383H1.333zm4 6.768H4V6.09h1.333v4.06zm2.667 0H6.667V6.09H8v4.06z" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="portfolio-card-thumbnail__button upload" title="'+l("srcLegacyJsPortfolioUploadSortableCardJs2","legacy-translations")+'">\n\t\t\t\t\t<svg class="portfolio-card-thumbnail__button-icon" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M0 9.5V12h2.5l7.378-7.378-2.5-2.5L0 9.5zm11.805-6.805a.668.668 0 000-.943L10.248.195a.668.668 0 00-.943 0l-1.22 1.22 2.5 2.5 1.22-1.22z" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>'},this.html=$('<div class="draggable-block item">\n\t\t\t<div class="clickable">\n\t\t\t\t<div class="image draggable-anchor">\n\t\t\t\t\t<div class="thumbnail-img-load">\n\t\t\t\t\t\t<div class="ispinner-lite"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<img src="" alt="" class="js-portfolio-modal-image portfolio-modal-image d-none">\n\t\t\t\t\t'.concat(this.moveIcon,'\n\t\t\t\t\t<video class="d-none js-portfolio-modal-video" controls="controls" pip="false"></video>\n\t\t\t\t\t<div class="draggable-block__type"></div>\n\t\t\t\t\t<div class="progress">\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t').concat(this.cardThumbnailButtons(),'\n\t\t\t\t<div class="draggable-block_error"></div>\n\t\t\t</div>\n\t\t</div>')),i&&this.html.find(".js-move-icon").on("mousedown",(function(e){return o.onDragStart(e),!1})),this.html.find(".image").find(this.selectors.preview.image).on("load",(function(){var e=$(this);if(e.hasClass("isNotCrop")){var t=e.get(0).width,n=e.get(0).height;t>n&&n/t<.665&&e.addClass("isHorizontalImg")}}))}return V(e,[{key:"moveMediaToImages",value:function(e){var t=this,n=e;if(this.isFocusGroup26771)return n.images=[],_.forEach(n.items,(function(e){if(_.isObject(e)&&e.portfolio_type===t.portfolioTypes.video){var o=!!e.urlThumbnail;n.images.push(M({isVideoThumb:o,type:t.portfolioTypes.video,urlBig:o?e.urlThumbnail:""},e))}else e.portfolio_type===t.portfolioTypes.audio?n.images.push(M({type:t.portfolioTypes.audio},e)):n.images.push(M({type:t.portfolioTypes.photo},e))})),_.isNull(n.cover.idPortfolioImage)&&n.cover.idPortfolioMedia&&delete n.cover.idPortfolioImage,delete n.items,n;var o=[];_.forOwn(n.audios,(function(e,i){n.images.push(M({type:t.portfolioTypes.audio},e)),o.push(i)})),_.forEachRight(o,(function(e){n.audios.splice(e,1)}));var i=[];return _.forEach(n.videos,(function(e,o){if("object"===I(e)){var r=!!e.urlThumbnail,a=r?e.urlThumbnail:"";n.images.push(M({type:t.portfolioTypes.video,isVideoThumb:r,urlBig:a},e)),i.push(o)}})),_.forEachRight(i,(function(e){n.videos.splice(e,1)})),null===n.cover.idPortfolioImage&&n.cover.idPortfolioMedia&&delete n.cover.idPortfolioImage,n}},{key:"updateMediaFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jpg";this.html.find(".image").find(["jpg","image"].includes(e)?this.selectors.preview.image:e).removeClass("d-none"),this.html.find(".thumbnail-img-load").remove();var t=this.getMediaFileSrc();t&&this.addMediaFile(e,t)}},{key:"addMediaFile",value:function(e,t){if(["jpg","image"].includes(e))this.addImage(t);else{var n=this.html.find(".image"),o=n.find(e);if(this.html.find(".draggable-block__type").attr("data-ext",this.data.type),e===this.portfolioTypes.audio){var i="audio-wavesurfer".concat(this.data.id?"-".concat(this.data.id):"");n.append('<div class="js-portfolio-modal-audio portfolio-modal-audio d-none"><audio-wavesurfer key="'.concat(i,'" :has-playback-time="false" url="').concat(t,'" peaks="').concat(this.data.peaks||"",'" :duration="').concat(this.data.duration||0,'" place="addPortfolio"></audio-wavesurfer></div>')),this.portfolioModalAudio=new Vue({el:n.find(this.selectors.preview.audio)[0]}),n.find(this.selectors.preview.audio).removeClass("d-none"),this.html.find(".thumbnail-img-load").remove()}(e===this.portfolioTypes.audio||e===this.portfolioTypes.video&&(this.data.urlBig&&this.data.url&&this.data.urlBig===this.data.url||this.data.cover&&this.data.cover.urlBig&&this.data.cover.url&&this.data.cover.urlBig===this.data.cover.url||null===this.data.urlBig))&&o.addClass("isNotCrop"),n.addClass("uploaded"),o.attr("src",t)}}},{key:"getAudioPeaks",value:function(){return this.portfolioModalAudio&&this.portfolioModalAudio.$children[0].peaksLocal||""}},{key:"updateVideoData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.html.find(this.selectors.preview.image),o=this.html.find(this.selectors.preview.video);this.data.url=t||e,this.data.urlBig=e,e&&(n.attr("src",e).removeClass(this.selectors.hidden),o.addClass(this.selectors.hidden)),t&&o.attr("src",t).removeClass(this.selectors.hidden)}},{key:"addImage",value:function(e){var t=this,n=this.html.find(".image"),o=n.find(this.selectors.preview.image);this.html.find(".draggable-block__type").attr("data-ext",this.data.type),(this.data.urlBig&&this.data.url&&this.data.urlBig==this.data.url||this.data.cover&&this.data.cover.urlBig&&this.data.cover.url&&this.data.cover.urlBig==this.data.cover.url||null===this.data.urlBig)&&(o.addClass("isNotCrop"),o.on("load",(function(){t.setImageCropIfNotCropped(n,o)}))),n.addClass("uploaded"),o.attr("src",e),this.data.urlRetina&&o.attr("srcset","".concat(this.data.urlRetina," 2x"))}},{key:"setImageCropIfNotCropped",value:function(e,t){var n,o=null===(n=this.data)||void 0===n||null===(n=n.cover)||void 0===n?void 0:n.crop;if(o&&0!==e.length&&0!==t.length){var i=e.width(),r=t[0].naturalWidth,a=t[0].naturalHeight,s=i/(o.w*r),l=s*r,u=s*a,c=o.x*l,d=o.y*u;t.css({transform:"translateX(-".concat(c,"px) translateY(-").concat(d,"px)"),width:"".concat(l,"px"),height:"".concat(u,"px")})}}},{key:"applyErrors",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.hasError=t.length>0,this.backendErrors={};var n="",o=(l("srcLegacyJsPortfolioUploadSortableCardJs3","legacy-translations"),l("correctErrorsInPortfolio","components/portfolio-upload-modal/portfolio-modal")),i=l("srcLegacyJsPortfolioUploadSortableCardJs5","legacy-translations"),r=!1,a=!1;if($(".js-portfolio-common-error").html(""),"string"!=typeof t)$.each(t,(function(t,n){var o;"position"in n?(n.target in e.backendErrors||(e.backendErrors[n.target]={}),e.backendErrors[n.target][n.position]=n.text):(n.target in e.backendErrors||(e.backendErrors[n.target]=[]),e.backendErrors[n.target].push(n.text)),"image"!==n.target&&"images"!==n.target&&"cover"!==n.target||"Данное изображение уже загружено"!==(o=n.text.replace(/<\/?[^>]+>/gi,""))&&"This image has already been uploaded"!==o||(a=!0);["image","images","cover","title","video","videos","audio","audios"].includes(n.target)&&(r=!0)}));else{var s=$(".js-portfolio-common-error");s.length>0&&s.html(t)}"photo"===this.portfolioType?a?n="<div>"+i+"</div>":r&&(n="<div>"+o+"</div>"):"video"===this.portfolioType?r&&(n+="<div>"+o+"</div>"):this.portfolioType===this.portfolioTypes.audio&&r&&(n+="<div>"+o+"</div>"),!n&&"string"==typeof t&&t&&(n=t),this.updateErrorVisuals(n)}},{key:"updateErrorVisuals",value:function(e){this.hasError?(this.html.addClass("error"),this.html.find(".draggable-block_error").html(e)):(this.html.removeClass("error"),this.html.find(".draggable-block_error").html(""))}},{key:"showProgress",value:function(){this.updateProgress(0),this.html.addClass("loading")}},{key:"hideProgress",value:function(){this.html.removeClass("loading"),this.html.find(".thumbnail-img-load").remove()}},{key:"updateProgress",value:function(e){this.html.find(".progress div").css({width:e+"%"})}}]),e}(),U=function(e){function t(e){var n;if(L(this,t),(n=P(this,t)).blank=!1,n.isFocusGroup26771=window.isFocusGroup26771||!1,n.data={id:null,draftHash:null,cover:{id:null,crop:null,hash:null,url:null,idPortfolioImage:null},title:"",images:[],videos:[],audios:[],description:""},e){var o=e.isOnlyCategory?e:n.moveMediaToImages(e);$.extend(n.data,o),n.addToListAfterLoad=!1}else n.blank=!0;if(n.backendErrors={},n.updateMediaFile(),n.html.find(".upload").on("click",(function(){n.onEdit()})),n.html.find(".delete").on("click",(function(){"track"===window.portfolioList.modal.page?(window.bus.$emit("open-modal-remove-portfolio"),window.portfolioTrack=new t(e)):n.openPortfolioDeleteConfirmModal()})),n.data.images||n.data.audios){var i=$(n.selectors.requiredMessage);"video"===n.portfolioType?i.toggleClass(n.selectors.requiredMessageNoRequired,n.data.images.filter((function(e){return"video"===e.type})).length>0):n.portfolioType===n.portfolioTypes.audio?i.toggleClass(n.selectors.requiredMessageNoRequired,n.data.audios.length>0):i.toggleClass(n.selectors.requiredMessageNoRequired,n.data.images.filter((function(e){return"video"!==e.type})).length>0)}return n}return A(t,e),V(t,[{key:"emitEvent",value:function(){$(document).trigger("portfolio-change")}},{key:"portfolioDelete",value:function(){var e,t,n,o=this,i=(null===(e=window.portfolioList)||void 0===e||null===(e=e.modal)||void 0===e?void 0:e.page)&&window.portfolioList.modal.page===window.portfolioList.modal.PAGE_KWORK,r=i&&(null===(t=window.KworkSaveModule)||void 0===t?void 0:t.isSaveDraft()),a=$(".js-portfolios-block .js-kwork-save-field-error"),s=$(".js-portfolio-modal-image").length-1;if(!i||null!==(n=this.data)&&void 0!==n&&n.id){var l=new FormData;l.append("portfolio_id",this.data.id),l.append("count",s),r||l.append("unlink","true"),a.text("").addClass("hidden"),$.ajax({url:"/portfolio/delete",data:l,async:!0,contentType:!1,processData:!1,type:"POST",complete:function(e){var t={};try{t=JSON.parse(e.responseText)}catch(e){}t.success?i?(o.onDelete(),o.emitEvent()):window.location=window.location.href:i&&(a.removeClass("hidden").text(t.data.message),$("html, body").animate({scrollTop:a.offset().top-30},250))}})}else this.onDelete()}},{key:"openPortfolioDeleteConfirmModal",value:function(){var e=this;window.bus.$emit("open-modal-portfolio-delete-confirm"),window.bus.$off("portfolio-modal-delete"),window.bus.$on("portfolio-modal-delete",(function(){e.portfolioDelete(),e.emitEvent()}))}},{key:"getMediaFileSrc",value:function(){return this.data.cover&&this.data.cover.url?this.data.cover.url:null}},{key:"parseBackendErrors",value:function(e){var t=this;this.backendErrors={},$.each(e,(function(e,n){!n.target in t.backendErrors&&(t.backendErrors[n.target]=[]),t.backendErrors[n.target]=n.text}))}},{key:"getData",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e||this.data;this.isFocusGroup26771&&_.forEach(o.images,(function(e,t){e.position=t}));var i=$.extend(!0,{},o);delete i.cover.url,delete i.cover.urlBig,delete i.cover.urlDefault,delete i.cover.hash,delete i.fromKwork;var r=[],a=i.cover.idPortfolioImage;if(a>0){var s=_.find(i.images,(function(e){return e.id===a}));s&&(i.cover.idPortfolioMedia=a,i.cover.type="video"===s.type?"video":"image",delete i.cover.idPortfolioImage)}return this.isFocusGroup26771&&(i.items=[]),_.forOwn(i.images,(function(e,o){_.isUndefined(e)||(n||"pdf"!==e.type)&&(e.type===t.portfolioTypes.video?t.isFocusGroup26771?i.items.push({id:e.id,crop:e.crop||null,position:e.position,portfolio_type:e.type}):(i.videos.push({id:e.id,crop:e.crop||null}),r.push(o)):e.type===t.portfolioTypes.audio?t.isFocusGroup26771?i.items.push({id:e.id,peaks:e.peaks,position:e.position,portfolio_type:e.type}):(i.audios.push({id:e.id,peaks:e.peaks}),r.push(o)):t.isFocusGroup26771?i.items.push({id:e.id,crop:e.crop||null,position:e.position,portfolio_type:t.portfolioTypes.photo}):i.images[o]={id:e.id,crop:e.crop||null})})),r.length>0&&_.forEach(r,(function(e,t){i.images.splice(e-t,1)})),this.isFocusGroup26771&&(delete i.images,delete i.videos,delete i.audios),i}}]),t}(F),H=function(e){function t(e,n){var o;L(this,t),o=P(this,t),n&&(o.list=n),o.isPdfAllowed=!1,o.isAudioAllowed=!1,o.data={id:null,hash:null,url:null,urlBig:null,type:null,isVideoThumb:!1},e&&($.extend(o.data,e),o.addToListAfterLoad=!1),o.fileUploader=new T({isMiniature:!0}),o.updateMediaFile(o.data.type),o.progress=o.html.find(".progress"),o.progressBar=o.progress.find("div"),o.progressCoefficient=1,o.progressTimerId=null,o.thumbWaiting=1e4,o.progressInterval=500,o.percentageProgress=0,o.intervalPercent=0,o.pdfMimeType="application/pdf",o.audioMimeType="audio/mpeg",o.fileUploader.type="media",o.fileUploader.fileName="file",o.fileUploader.mimeTypes=["image/jpeg","image/png","image/gif","video/mp4","video/avi","video/x-msvideo","video/quicktime","video/mov"],o.updateMediaAvailability(),window.kworkId&&window.portfolioList.modal.page===window.portfolioList.modal.PAGE_KWORK&&(o.fileUploader.postData.kwork_id=window.kworkId,window.kworkLang&&(o.fileUploader.postData.kworkLang=window.kworkLang));var i=window.portfolioList.getImagesHashes().concat(window.portfolioList.getCoverHashes());window.portfolioList.modal.portfolio.cover.hash&&i.push(window.portfolioList.modal.portfolio.cover.hash),window.firstPhotoHash&&i.push(window.firstPhotoHash),i.length&&$.each(i,(function(e,t){o.fileUploader.postData["hashes["+e+"]"]=t}));var r=window.portfolioList.modal.portfolio.id;return r&&(o.fileUploader.postData.portfolio_id=r),o.fileUploader.onLoad=function(e,t){o.data.type=t||"jpg",o.uploadableBase64=e,o.onLoadStart(),o.onChangeState(),o.updateMediaFile(t),o.showProgress(),o.changeCoefficient(t),o.addToListAfterLoad&&(o.onLoad(),o.onChangeState(),o.addToListAfterLoad=!1)},o.fileUploader.onProgress=function(e){$(".draggable-block.create-block").removeClass("error"),o.updateProgress(e*o.progressCoefficient)},o.fileUploader.onSuccess=function(e){o.data.id=e.id,o.data.url=o.uploadableBase64,o.data.urlBig=o.uploadableBase64,o.data.hash=e.hash,o.data.type===o.portfolioTypes.video||o.data.type===o.portfolioTypes.audio?(o.percentageProgress=o.progressNoPreview(),o.initProgressInterval(o.thumbWaiting,o.progressInterval,90)):o.onSuccessMedia()},o.fileUploader.onError=function(e){var t,n=null===(t=o.list.stageBlock)||void 0===t?void 0:t.find(".draggable-block.create-block");if(n&&n.length&&(n.removeClass("error"),n.addClass("error")),!o.addToListAfterLoad&&!o.data.url)return o.onDelete(),o.onChangeState(),void o.onError(e);o.uploadableBase64=null,o.onChangeState(),o.updateMediaFile(o.data.type),o.hideProgress(),o.onError(e)},o.fileUploader.onFail=function(e){if(!e&&o.fileUploader.file)setTimeout((function(){o.fileUploader.postData.delay_hash=1,o.fileUploader.fileUploadAjax(o.fileUploader.file),o.fileUploader.file=null}),5e3);else{var t,n=e;!_.isString(e)&&null!=e&&null!==(t=e.file)&&void 0!==t&&t[0]&&(n=e.file[0]),o.fileUploader.onError(n)}},o.html.find(".upload").on("click",(function(){o.fileUploader.upload()})),o.html.find(".delete").on("click",(function(){var e={childPopupLocal:!0};e.typeFile=o.data.type,"jpg"===e.typeFile&&(e.typeFile="image"),window.bus.$emit("open-modal-portfolio-delete-confirm",{data:e}),window.bus.$on("portfolio-modal-delete",(function(){var e;null===(e=o.portfolioModalAudio)||void 0===e||e.$children[0].destroy("addPortfolio"),o.fileUploader.abort(),o.onDelete()}))})),o.fileUploader.onGifError=function(e){o.onDelete(),o.onError(e)},o}return A(t,e),V(t,[{key:"onSuccessMedia",value:function(){this.uploadableBase64=null,this.onChangeState(),this.hideProgress(),this.onSuccess()}},{key:"updateMediaAvailability",value:function(){if(this.list&&this.fileUploader&&this.fileUploader.mimeTypes)if(this.isPdfAllowed=this.list.isPdfAllowed||!1,this.isAudioAllowed=this.list.isAudioAllowed||!1,this.isPdfAllowed)_.find(this.fileUploader.mimeTypes,this.pdfMimeType)||this.fileUploader.mimeTypes.unshift(this.pdfMimeType),this.fileUploader.minFileSize=10;else if(this.isAudioAllowed)_.find(this.fileUploader.mimeTypes,this.audioMimeType)||this.fileUploader.mimeTypes.unshift(this.audioMimeType),this.fileUploader.minFileSize=10;else{var e=_.findIndex(this.fileUploader.mimeTypes,this.pdfMimeType);-1!==e&&this.fileUploader.mimeTypes.splice(e,1);var t=_.findIndex(this.fileUploader.mimeTypes,this.audioMimeType);-1!==t&&this.fileUploader.mimeTypes.splice(t,1),this.fileUploader.minFileSize=30720}}},{key:"getMediaFileSrc",value:function(){return this.uploadableBase64?this.uploadableBase64:this.data.url?this.data.url:null}},{key:"changeCoefficient",value:function(e){this.progressCoefficient="video"===e?.75:1}},{key:"progressNoPreview",value:function(){return 100*this.progressCoefficient}},{key:"getIntervalPercent",value:function(e){return(100-this.percentageProgress)/e}},{key:"toLastStepProgress",value:function(){var e=100-2*this.intervalPercent;this.percentageProgress<e&&(clearTimeout(this.progressTimerId),this.initProgressInterval(600,150,100))}},{key:"stopProgress",value:function(){var e=this;clearTimeout(this.progressTimerId),_.find(this.list.items,(function(t){return t.data&&t.data.id===e.data.id}))&&this.onSuccessMedia()}},{key:"initProgressInterval",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=e/t;this.intervalPercent=this.getIntervalPercent(i),this.progressTimerId=setInterval((function(){n.percentageProgress<=o?(n.percentageProgress+=n.intervalPercent,n.updateProgress(n.percentageProgress),n.percentageProgress>=100&&n.stopProgress()):clearTimeout(n.progressTimerId)}),t)}}]),t}(F),W=function(){function e(t){L(this,e),this.isCross=t.isCross,this.title=t.title,this.click=t.click,this.id="CreateBlock",this.classes={loading:"create-block--is-load"},this.setHtml(),this.setListeners(),this.html.data("instance",this)}return V(e,[{key:"setHtml",value:function(){this.isCross?this.setCrossHtml():this.setDefaultHtml()}},{key:"setListeners",value:function(){var e=this;this.html.on("click",(function(){e.click(e)}))}},{key:"setCrossHtml",value:function(){var e=window.isUserTester&&"portfolio-upload-modal__upload-image-title-small",t="a".concat(Date.now()),n="b".concat(Date.now()),o=l("modalAddBtn","components/portfolio-upload-modal/portfolio-modal");this.html=$('<div class="draggable-block create-block">\n\t\t\t<div class="draggable-block__fit-wrapper">\n\t\t\t\t<button type="button" class="upload portfolio-upload-modal__upload-image portfolio-upload-modal__upload-image--active">\n\t\t\t\t\t<svg class="portfolio-upload-modal__upload-image-icon" viewBox="0 0 48 49" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M24 3.986c11.36 0 20.572 9.21 20.572 20.571 0 11.36-9.211 20.572-20.572 20.572-11.36 0-20.571-9.211-20.571-20.572 0-11.36 9.21-20.571 20.571-20.571zm0 2.571c-9.941 0-18 8.06-18 18 0 9.941 8.059 18 18 18s18-8.059 18-18c0-9.94-8.059-18-18-18zm0 7.715a1.286 1.286 0 011.286 1.285v7.715H33a1.286 1.286 0 110 2.571h-7.714v7.714a1.286 1.286 0 01-2.572 0v-7.714H15a1.286 1.286 0 010-2.571h7.714v-7.715A1.286 1.286 0 0124 14.272z"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<svg class="portfolio-upload-modal__upload-image-icon--loader" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M48 24C48 10.746 37.254 0 24 0v3c11.598 0 21 9.402 21 21s-9.402 21-21 21v3c13.254 0 24-10.746 24-24Z" fill="url(#'.concat(t,')"/><path d="M24 48C10.746 48 0 37.254 0 24S10.746 0 24 0v3C12.402 3 3 12.402 3 24s9.402 21 21 21v3Z" fill="url(#').concat(n,')"/><defs><linearGradient id="').concat(t,'" x1="36" y1="0" x2="36" y2="48" gradientUnits="userSpaceOnUse"><stop stop-color="#04B70A" stop-opacity="0"/><stop offset="1" stop-color="#04B70A" stop-opacity=".5"/></linearGradient><linearGradient id="').concat(n,'" x1="12" y1="0" x2="12" y2="48" gradientUnits="userSpaceOnUse"><stop stop-color="#04B70A"/><stop offset="1" stop-color="#04B70A" stop-opacity=".5"/></linearGradient></defs>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class="portfolio-upload-modal__upload-image-title ').concat(e,'">\n\t\t\t\t\t\t').concat(o,"\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>"))}},{key:"setDefaultHtml",value:function(){window.isFocusGroup19789?this.html=$('<div class="draggable-block create-block">\n\t\t\t\t<div class="clickable upload">\n\t\t\t\t\t<div class="image"></div>\n\t\t\t\t\t<div class="controls">\n\t\t\t\t\t\t<div class="empty">\n\t\t\t\t\t\t\t<a class="upload">'.concat(l("upload","components/portfolio-upload-modal/portfolio-modal"),'</a>\n\t\t\t\t\t\t\t<a class="upload hidden">').concat(l("add","components/portfolio-upload-modal/portfolio-modal"),"</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>")):this.html=$('<div class="draggable-block create-block">\n\t\t\t\t<div class="clickable upload">\n\t\t\t\t\t<div class="image"></div>\n\t\t\t\t\t<div class="controls">\n\t\t\t\t\t\t<div class="empty">\n\t\t\t\t\t\t\t<a class="upload">'.concat(window.l("upload","components/portfolio-upload-modal/portfolio-modal"),'</a>\n\t\t\t\t\t\t\t<a class="upload hidden">').concat(window.l("add","components/portfolio-upload-modal/portfolio-modal"),"</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>"))}},{key:"setLoading",value:function(e){this.html.toggleClass(this.classes.loading,e)}},{key:"replace",value:function(e){this.html.replaceWith(e.html)}}]),e}();function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function Y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,q(o.key),o)}}function q(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=z(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==z(t)?t:String(t)}var G=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.draggedBlock=null,this.stageOffset=null,this.stageWidth=0,this.stageHeight=0,this.containerWidth=0,this.containerHeight=0,this.containerRowSize=3,this.portfolioMinCount=window.portfolioMinCount||5,this.blockDragLeft=0,this.blockDragTop=0,this.stageBlock=$(t),this.isCross=this.stageBlock.hasClass("sortable-card-list--is-cross"),this.isKwork=this.stageBlock.hasClass("sortable-card-list--is-kwork"),this.draggableBlocks=this.stageBlock.find(".draggable-blocks"),this.placeholders=this.stageBlock.find(".placeholders"),this.errorBlock=this.stageBlock.find(".portfolio-error"),this.isCounterInit=!1,this.counterClasses={counterEnough:"kwork-photos-block__counter--enough",valueMain:"kwork-photos-block__counter-value",valueEmpty:"kwork-photos-block__counter-value--empty",valueNotEnough:"kwork-photos-block__counter-value--not-enough"},this.type=this.stageBlock.data("type"),this.createTitle=this.stageBlock.data("createTitle"),this.maxCount=this.stageBlock.data("maxCount")||9,this.minCols=this.stageBlock.data("minCols"),this.itemWidth=this.stageBlock.data("item-width")||190,this.itemMarginRight=this.stageBlock.data("item-margin-right")||15,this.sortable="unsortable"!=this.stageBlock.data("sortable"),this.needCreateBlocksCount=1,this.createBlockId="CreateBlock",this.isFocusGroup26771=window.isFocusGroup26771||!1,this.videoTempCover="video-converting",this.imageUploaderParams={minImageWidth:660,minImageHeight:440},this.minVideoResolution=null,this.isPdfAllowed=!1,this.isAudioAllowed=!1,this.items=[],this.isNeedToSendPortfolioGAErrors=!1,this.additionalData={};var o=this.stageBlock.find(".data-additional");o.length&&(this.additionalData=JSON.parse(o.val())),this.ignoredHashes=[],"portfolios"===this.type&&(this.ModalLoader=new a,this.modal=new oe,this.modal.onSave=function(e){var t=function(e){return _.isObject(e)?!_.isNull(e.id):!_.isNull(e)},o=n.modal.portfolioItem.data,i=o.images,r=o.videos,a=o.audios,s=(null==i?void 0:i.filter(t).length)>0,l=(null==r?void 0:r.filter(t).length)>0,u=(null==a?void 0:a.filter(t).length)>0;(l||s||u)&&(n.itemSave(n.modal.portfolioItem,e),n.modal.portfolioItem.hasError=!1,n.modal.portfolioItem.updateErrorVisuals(),$.each(n.getPortfolioItems(),(function(e,t){if(t.hasError)return!1;n.errorBlock.text("")})))},this.modal.getImagesHashes=function(e){return n.getImagesHashes(e)},this.modal.getCoverHashes=function(e){return n.getCoverHashes(e)},this.modal.checkCoverHash=function(e){return n.checkCoverHash(e)},this.modal.checkImageHash=function(e){return n.checkImageHash(e)},this.modal.checkVideoUrl=function(e,t){return n.checkVideoUrl(e,t)},this.loadItems(window.portfolios)),$(document).mousemove((function(e){return n.dragMove(e)})),$(document).mouseup((function(e){n.dragStop(e)})),$(window).on("resize",(function(){n.updateOffsets(),n.updateAllBlockCoordinates()})),this.isKwork&&window.bus.$emit("add-kworks-portfolio-set-sortable",this),this.initPortfolioCounter()}var t,n,o;return t=e,n=[{key:"initPortfolioCounter",value:function(){var e=this,t=this.stageBlock.data("counter");t&&(this.$counter=$(t),this.renderCounter(),$(document).on("portfolio-change",(function(){e.renderCounter()})))}},{key:"validateMinItems",value:function(){return this.getPortfolioItems().length>=this.portfolioMinCount}},{key:"renderCounter",value:function(){var e=this.getPortfolioItems().length;if(e<this.portfolioMinCount)return this.counterMessage="".concat(l("portfolioCounter","pages/kwork-edit/portfolio",{onlyDesktopStart:'<span class="m-hidden">',onlyDesktopEnd:"</span>"})," ").concat(this.getCounterValueBlock(e)),this.isCounterInit=!0,this.$counter.removeClass(this.counterClasses.counterEnough),void this.$counter.html(this.counterMessage);this.isCounterInit&&(this.counterMessage=l("portfolioCounterEnough","pages/kwork-edit/portfolio"),this.$counter.addClass(this.counterClasses.counterEnough),this.$counter.html(this.counterMessage))}},{key:"getCounterValueBlock",value:function(e){var t=this;return'<span class="'.concat("".concat(t.counterClasses.valueMain," ").concat(e>0?t.counterClasses.valueNotEnough:t.counterClasses.valueEmpty),'">').concat(e,"/").concat(this.portfolioMinCount,"</span>")}},{key:"getPortfolioItems",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items).filter((function(t){return!e.isCreateBlock(t)}))}},{key:"applyMediaAvailability",value:function(e,t,n){this.isPdfAllowed=e||!1,this.isAudioAllowed=t||!1,this.updateUploadTitle(n),_.forOwn(this.getPortfolioItems(),(function(e){var t;null===(t=e.updateMediaAvailability)||void 0===t||t.call(e)}))}},{key:"updateUploadTitle",value:function(e){this.stageBlock.find(".js-field-images .portfolio-upload-modal__upload-image-title").text(e)}},{key:"updatePlaceholders",value:function(){for(var e="",t=0,n=this.items.length;t<n;t+=1){var o="";if(this.items[t].hasError){var i=this.items[t].html.find(".draggable-block_error").outerHeight();o=$("<div/>").css("height",i)}var r=$("<div/>",{class:"placeholder",html:'<div class="image"></div>'});o&&r.append(o),e+=r.prop("outerHTML")}this.placeholders.html(e)}},{key:"createItemDialogue",value:function(e){var t=this,n=this.createItem();"portfolios"===this.type?(e&&(this.additionalData.createBlockItem=e),this.modal.edit(n,this.additionalData)):(n.onLoad=function(){"images"!==t.type&&"media"!==t.type||(_.isEmpty(t.ignoredHashes)||(n.fileUploader.postData.ignored_hashes=t.ignoredHashes.join(",")),_.isEmpty(window.deletedPortfolioIds)||(n.fileUploader.postData.deleted_portfolio_ids=window.deletedPortfolioIds.join(","))),t.itemSave(n)},n.fileUploader.minImageWidth=this.imageUploaderParams.minImageWidth,n.fileUploader.minImageHeight=this.imageUploaderParams.minImageHeight,n.fileUploader.minVideoResolution=this.minVideoResolution,n.fileUploader.upload())}},{key:"editItem",value:function(e){var t=this;if("portfolios"==this.type){var n=e.data.id||e.data.duplicate_from;n?this.getPortfolioData(n,(function(n){if(n.portfolio){var o=n.portfolio;e.data.category_id=o.category_id,e.data.duplicate_from&&(e.data.cover.hash=e.data.cover.hash||o.cover.hash,e.data.cover.hashValue=e.data.cover.hashValue||o.cover.hashValue)}t.additionalData=n.additional,t.modal.edit(e,t.additionalData)})):this.modal.edit(e,this.additionalData)}else this.uploaderBlock.trigger("click")}},{key:"getPortfolioData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;this.ModalLoader.add(),$.ajax({type:"POST",url:"/portfolio/get_popup",data:{portfolioId:t},dataType:"json",success:function(t){e.ModalLoader.remove(),t.success&&n&&n(t.data)}})}},{key:"setCreateBlocks",value:function(){var t=this;this.isKwork&&"portfolios"===this.type&&["video","photo","audio"].includes(window.portfolioType)?this.needCreateBlocksCount=this.portfolioMinCount:this.needCreateBlocksCount=1;var n=this.getPortfolioItems(),o=this.items.filter((function(t){return e.isCreateBlock(t)})),i=this.needCreateBlocksCount-o.length,r=n.length>=this.maxCount,a=i,s=!1;if(i>=1&&this.needCreateBlocksCount>1&&(a-=n.length),a<=0&&0===o.length&&!r&&(a=1,s=!0),a<0&&o.length>1)for(var l=function(){var e=o.filter((function(e,t){return t>0}));t.items=t.items.filter((function(t){return-1===e.indexOf(t)}))},u=a;u<0;u+=1)l();if(a>0&&!r)for(var c=0;c<a;c+=1){var d=this.getCreateBlock();this.items.push(d),this.draggableBlocks.append(d.html)}r&&(this.items=this.getPortfolioItems()),this.draggableBlocks.find(".create-block").each((function(e,n){var o=$(n);-1===t.items.indexOf(o.data("instance"))&&o.remove()})),!s&&this.needCreateBlocksCount-n.length>0||this.items.sort((function(t,n){return!e.isCreateBlock(t)&&!e.isCreateBlock(n)||e.isCreateBlock(t)&&e.isCreateBlock(n)?0:e.isCreateBlock(t)?1:-1}))}},{key:"resetCreateBlocks",value:function(){this.items=this.getPortfolioItems(),this.setCreateBlocks(),this.repositionItems()}},{key:"repositionItems",value:function(){this.updatePlaceholders(),this.updateOffsets(),this.updateAllBlockCoordinates()}},{key:"getCreateBlock",value:function(){return new W({isCross:this.isCross,title:this.createTitle,click:this.createItemDialogue.bind(this)})}},{key:"setLoadingForCreateBlocks",value:function(t){var n=this.items.filter((function(t){return e.isCreateBlock(t)}));if(n.length<t)for(var o=0;o<t-n.length;o+=1){var i=this.getCreateBlock();i.setLoading(!0),this.items.push(i),this.draggableBlocks.append(i.html)}_.forEach(n,(function(e,n){e.setLoading(n+1<=t)})),this.repositionItems()}},{key:"removeItems",value:function(e){var t=this.items.filter(e);_.forEach(t,(function(e){e.html.remove()})),this.items=this.getPortfolioItems().filter((function(e){return-1===t.indexOf(e)})),this.resetCreateBlocks()}},{key:"loadItems",value:function(t){var n=this;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?this.items=this.items.filter((function(t){return!e.isCreateBlock(t)})):(this.items=[],this.draggableBlocks.find(".item").remove()),$.each(t,(function(e,t){var o,i,r=n.createItem(t);n.items.push(r),n.draggableBlocks.append(r.html),"video"===t.type&&t.isVideoThumb&&(null!==(o=t.url)&&void 0!==o&&o.includes(n.videoTempCover)||null!==(i=t.urlBig)&&void 0!==i&&i.includes(n.videoTempCover))&&r.updateVideoData(t.url||t.urlBig)})),this.setCreateBlocks(),this.repositionItems()}},{key:"itemSave",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.updateMediaFile(),-1===this.items.indexOf(e)&&(t.createBlockItem&&this.needCreateBlocksCount>this.getPortfolioItems().length?(t.createBlockItem.replace(e),this.items=this.items.map((function(n){return n===t.createBlockItem?e:n}))):(this.items.push(e),this.draggableBlocks.append(e.html)),this.setCreateBlocks(),this.repositionItems())}},{key:"createItem",value:function(e){var t=this,n=null;return"portfolios"==this.type?n=new U(e):"media"==this.type&&(n=new H(e,this)),n.onLoadStart=function(){t.stageBlock.find(".portfolio-error").html("")},n.onError=function(e){if(t.stageBlock.find(".portfolio-error").html(e),t.isNeedToSendPortfolioGAErrors&&e){var n="undefined"!=typeof removeTags?window.removeTags(e):e;oe.sendToAnalytics(n,"images[]",!0)}},n.onDragStart=function(e){t.dragStart(e,n)},n.onEdit=function(){t.editItem(n)},n.onDelete=function(){t.deleteItem(n),"images"!=t.type&&"media"!=t.type||t.onDelete(n)},n.onChangeState=function(){t.onChangeState()},n.onSuccess=function(){t.onSuccess(n)},n}},{key:"deleteItem",value:function(e){var t,n;e.hasError&&this.stageBlock.find(".portfolio-error").html(""),e.html.remove(),this.items=this.items.filter((function(t){return t!==e})),this.stageBlock.find(".placeholder:last-child").remove(),this.setCreateBlocks(),this.repositionItems(),null!==(t=e.data)&&void 0!==t&&t.fromKwork&&this.checkPortfoliosOnFromKwork();var o=null===(n=e.data)||void 0===n?void 0:n.id;"portfolios"===this.type&&o&&(window.deletedPortfolioIds=_.union(window.deletedPortfolioIds,[o]))}},{key:"checkPortfoliosOnFromKwork",value:function(){var e=this.getPortfolioItems().map((function(e){return e.data.fromKwork||e.data.duplicate_from})).filter((function(e){return e}));window.bus.$emit("add-kworks-portfolio-update-selected-kworks",e)}},{key:"updateOffsets",value:function(){this.stageOffset=this.stageBlock.offset(),this.stageWidth=this.stageBlock.outerWidth(),this.stageHeight=this.stageBlock.outerHeight();var e=this.stageBlock.find(".placeholder");this.containerWidth=e.outerWidth(),this.containerHeight=e.outerHeight();var t=-1;if(0==this.sortable);else for(var n=this.stageWidth+2*this.itemMarginRight;n>=0;n-=this.itemWidth+this.itemMarginRight)t+=1;this.minCols&&t<this.minCols&&(t=this.minCols),this.stageBlock.attr("data-cols",t),this.containerRowSize=t}},{key:"getPositionByCoords",value:function(e,t){var n=Math.round(t/this.containerHeight),o=Math.round(e/(this.stageWidth/this.containerRowSize)),i=n*this.containerRowSize+o;return i>=this.items.length&&(i=this.items.length-1),i}},{key:"updateAllBlockCoordinates",value:function(){var e=this;$.each(this.items,(function(t,n){e.updateBlockCoordinates(n.html,t)}))}},{key:"updateBlockCoordinates",value:function(e,t){var n=this.stageBlock.find(".placeholder:nth-child("+(t+1)+")");if(!(n.length<1)){var o=n.offset(),i=o.top-this.stageOffset.top,r=o.left-this.stageOffset.left;e.css({top:i,left:r})}}},{key:"dragStart",value:function(e,t){if(this.sortable&&1==e.which){this.updateOffsets(),t.html.addClass("moved");var n=t.html.offset();return this.blockDragLeft=e.pageX-n.left,this.blockDragTop=e.pageY-n.top,this.draggedBlock=t,!1}}},{key:"dragStop",value:function(e){this.draggedBlock&&(this.draggedBlock.html.removeClass("moved"),this.updateAllBlockCoordinates(),this.draggedBlock=null)}},{key:"dragMove",value:function(e){if(this.draggedBlock){var t=e.pageY-this.stageOffset.top-this.blockDragTop,n=e.pageX-this.stageOffset.left-this.blockDragLeft,o=this.stageWidth-this.containerWidth,i=this.stageHeight-this.containerHeight;n<0?n=0:n>o&&(n=o),t<0?t=0:t>i&&(t=i);var r=this.items.indexOf(this.draggedBlock),a=this.getPositionByCoords(n,t);return a!=r&&this.moveElement(this.items,r,a),this.repositionItems(),this.draggedBlock.html.css({left:n+"px",top:t+"px"}),!1}}},{key:"moveElement",value:function(e,t,n){if(n>=e.length)for(var o=n-e.length+1;o--;)e.push(void 0);e.splice(n,0,e.splice(t,1)[0])}},{key:"getData",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[];return $.each(this.getPortfolioItems(),(function(n,o){t.push(o.getData(null,e))})),t}},{key:"isReady",value:function(){var e=!0;return $.each(this.getPortfolioItems(),(function(t,n){if(n.uploadableBase64)return e=!1,!1})),e}},{key:"applyErrors",value:function(e){var t=this,n={};$.each(e,(function(e,t){n[parseInt(t.position)]=t.errors||t.text})),$.each(this.getPortfolioItems(),(function(e,o){var i=[];e in n&&(i=n[e]),o.applyErrors(i),t.repositionItems()}))}},{key:"checkCoverHash",value:function(e){var t=this.getCoverHashes();return-1==$.inArray(e,t)}},{key:"checkImageHash",value:function(e){var t=this.getImagesHashes();return-1==$.inArray(e,t)}},{key:"checkVideoUrl",value:function(e,t){var n=this.getVideoUrls(t);return-1==$.inArray(e,n)}},{key:"getCoverHashes",value:function(){var e=[],t=this.modal.portfolioItem;return $.each(this.getPortfolioItems(),(function(n,o){if(o==t)return!0;o.data.cover.hash&&e.push(o.data.cover.hash)})),e}},{key:"getImagesHashes",value:function(){var e=[],t=this.modal.portfolioItem,n=this.modal.portfolio?this.modal.portfolio.images:[];return $.each(this.getPortfolioItems(),(function(n,o){if(o==t)return!0;$.each(o.data.images,(function(t,n){e.push(n.hash)}))})),$.each(n,(function(t,n){e.push(n.hash)})),e}},{key:"getVideoUrls",value:function(e){var t=[],n=this.modal.portfolioItem,o=this.modal.portfolio.videos;return $.each(this.getPortfolioItems(),(function(e,o){if(o==n)return!0;$.each(o.data.videos,(function(e,n){t.push(n)}))})),$.each(o,(function(n,o){if(n==e)return!0;t.push(o)})),window.ordersPortfolioVideos&&$.each(window.ordersPortfolioVideos,(function(e,n){t.push(n)})),t}},{key:"setIsNeedToSendPortfolioGAErrors",value:function(e){this.isNeedToSendPortfolioGAErrors=e||!1}},{key:"setMinVideoResolution",value:function(e){this.minVideoResolution=e,_.forEach(this.getPortfolioItems(),(function(t){t.fileUploader&&(t.fileUploader.minVideoResolution=e)}))}},{key:"setImageUploaderMinResolution",value:function(e,t){var n=this;e.width&&e.height&&(this.imageUploaderParams.minImageWidth=+e.width,this.imageUploaderParams.minImageHeight=+e.height,_.forEach(this.getPortfolioItems(),(function(e){e.fileUploader&&(e.fileUploader.minImageWidth=n.imageUploaderParams.minImageWidth,e.fileUploader.minImageHeight=n.imageUploaderParams.minImageHeight)})),t||this.errorBlock.text(""))}},{key:"updateIgnoredHashes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.ignoredHashes=e}}],o=[{key:"isCreateBlock",value:function(e){return e.id&&"CreateBlock"===e.id}}],n&&Y(t.prototype,n),o&&Y(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,r,a,s=[],l=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=r.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return(t=ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ne(o.key),o)}}function ne(e){var t=function(e,t){if("object"!=Z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Z(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Z(t)?t:String(t)}var oe=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.PORTFOLIO_TYPE_PHOTO="photo",this.PORTFOLIO_TYPE_VIDEO="video",this.PORTFOLIO_TYPE_AUDIO="audio",this.PORTFOLIO_TYPE_PDF="pdf",this.COVER_IMAGE_TYPE_VIDEO="video",this.COVER_IMAGE_TYPE_IMAGE="image",this.COVER_IMAGE_TYPE_UPLOAD="upload",this.COVER_IMAGE_TYPE_DEFAULT_AUDIO="default-audio",this.portfolioType=window.portfolioType||this.PORTFOLIO_TYPE_PHOTO,this.MAX_YOUTUBE=5,this.MIN_WIDTH_CROP_BOX=660,this.MIN_HEIGHT_CROP_BOX=440,this.defaultImageUploadResolution={width:660,height:440},this.minVideoResolution=window.minVideoResolution||{},this.minVideoResolution.horizontal.text='<span class="nowrap">'.concat(this.minVideoResolution.horizontal.width," х ").concat(this.minVideoResolution.horizontal.height," px</span>"),this.minVideoResolution.vertical.text='<span class="nowrap">'.concat(this.minVideoResolution.vertical.width," х ").concat(this.minVideoResolution.vertical.height," px</span>"),this.minResolutionForSelection=null,this.attributeResolutions=window.portfolioAttributeResolutions||{},this.isResolutionValid=!0,this.isModalOpened=!1,this.isPortfolioLoading=!1,this.hasSavedVideoErrors=!1,this.MAX_VIDEO_WIDTH=6e3,this.MAX_VIDEO_HEIGHT=1e4,this.MAX_VIDEO_DURATION=75,this.maxAudioDuration=210,this.minAudioDuration=3,this.PAGE_ORDER="track",this.PAGE_KWORK="edit-kwork",this.PAGE_MY_PORTFOLIO="my-portfolios",this.block=$(".portfolio-upload-modal"),this.titleInput=this.block.find('input[name="title"]'),this.fieldKworks=this.block.find(".js-field-kworks"),this.fieldOrders=this.block.find(".js-field-orders"),this.coverUploadGrid=this.block.find(".js-cover-upload-grid"),this.coverTextNotLoad=this.block.find(".js-portfolio-cover-text-not-load"),this.coverTextLoad=this.block.find(".js-portfolio-cover-text-load"),this.exampleCard=this.block.find(".portfolio-example-card"),this.exampleCardCntLikes=this.exampleCard.find(".cnt-likes"),this.exampleCardCntViews=this.exampleCard.find(".cnt-views"),this.exampleCardCntComments=this.exampleCard.find(".cnt-comments"),this.exampleCardName=this.exampleCard.find(".portfolio-card-name"),this.exampleCardCategory=this.exampleCard.find(".portfolio-card-content--category"),this.exampleCardThumbnail=this.exampleCard.find(".portfolio-cropper-preview"),this.confirmAtClose=!0,this.reloadAfterSave=this.block.data("portfolioReloadAfterSave")||!1,this.page=this.block.data("portfolioPage"),this.orderId=this.block.data("orderId"),this.userPage=this.block.data("userPage"),this.requiredPortfolioType=this.block.find(".js-required-portfolio-type"),this.secondaryPortfolioType=this.block.find(".js-secondary-portfolio-type"),this.fieldImages=this.block.find(".js-field-images"),this.fieldVideos=this.block.find(".js-field-videos"),this.lastPortfolioData=null,this.savedPortfolioData={},this.coverUrlBig=null,this.youtubeValidationDataName="youtube-validation",this.attributesLoaded=!0,this.kworksList={},this.kworksIds=null,this.ordersList={},this.isNeedToSendAnalyticsErrors=this.page===this.PAGE_KWORK&&"undefined"!=typeof GTM,this.errorFields=[],this.ignoredHashes=[],this.isFocusGroup26771=window.isFocusGroup26771||!1,this.classes={field:"js-field",btnSave:"js-save-portfolio",btnDisabled:"kw-button--inactive",btnLoading:"kw-button--loading",inputClassError:"input-error-portfolio",videos:"videos",fieldYoutube:"youtube-field",fieldYoutubeErrorClass:"youtube-field--error",youtubeRemove:"js-youtube-remove",youtubeAdd:"js-youtube-add",youtubeAddText:"js-youtube-add-text",cover:"js-portfolio-cover",coverUploadField:"js-cover-upload-field",coverImage:"js-cover-image",coverBtnUpload:"js-portfolio-cover-upload",coverMini:"js-cover-mini",coverSelected:".preview.selected",categoryError:"js-category-error",attributesError:"js-attributes-error",kworkError:"js-portfolio-kwork-error",coverError:"js-portfolio-cover-error",titleError:"js-portfolio-title-error",imagesError:"js-portfolio-total-error",countVideosError:"js-portfolio-count-videos-error",videosError:"js-portfolio-videos-error",selectKwork:"js-portfolio-kwork",selectOrder:"js-portfolio-order",selectParentCategories:"js-portfolio-parent-categories",selectCategories:"js-portfolio-categories",attributes:"js-attributes",formItemVideos:"js-form-item-videos",formItemImages:"js-form-item-images",deletePreviewBtn:"delete",cropped:"cropped",requiredMessage:"js-form-required",requiredMessageIsRequired:"form-item__required--required",requiredMessageNoRequired:"form-item__required--required-no",coverUploadGridActive:"portfolio-cover-grid--active",cropperPreviewRemove:"js-cropper-preview-remove",cropperPreviewEdit:"js-cropper-preview-edit",preloader:"ispinner-lite",youtubeConfirmRemove:"js-youtube-confirm-remove",youtubeConfirmCancel:"js-youtube-confirm-cancel",youtubeConfirmOk:"js-youtube-confirm-ok"},this.$formItemVideos=$(".".concat(this.classes.formItemVideos)),this.priorityTypes=[this.PORTFOLIO_TYPE_VIDEO,this.PORTFOLIO_TYPE_PDF,this.PORTFOLIO_TYPE_AUDIO],this.frontendErrors={title:[],cover:[],images:[],videos:[],audios:[]},this.frontendErrorAnalyticsCodeAlias={images:"images[]",videos:"videos[]",audios:"audios[]"},this.backEndErrorAnalyticsCode={prefix:"portfolio/",video:"portfolio/video",audio:"portfolio/audio"},this.coverCropper="",this.cropperConfig={checkCrossOrigin:!1,checkOrientation:!1,background:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,toggleDragModeOnDblclick:!1,aspectRatio:1.5,autoCropArea:1,preview:this.exampleCardThumbnail,viewMode:1,dragMode:"move"},this.xhr=!1,this.initialState={},this.youtubeAddButtonIsActive=!1,this.cropperBeforeResizeData=null,this.initSortableContainer(),this.initCover(),this.events(),this.page===this.PAGE_KWORK&&(this.updateResolutionForSelection(),window.bus.$on("update-portfolio-resolutions",(function(){t.attributeResolutions=window.portfolioAttributeResolutions,t.updateResolutionForSelection()}))),this.setMinVideoResolution(),window.defferScripts.on("chosenJquery",(function(){$.fn.chosen&&(t.block.find("."+t.classes.selectParentCategories+", ."+t.classes.selectCategories).chosen({width:"100%",disable_search:!0,display_disabled_options:!1}),t.block.find("."+t.classes.selectKwork+", ."+t.classes.selectOrder).chosen({width:"100%",disable_search:!1,disable_search_threshold:10}))}),window.isPageProfile||window.isPageTrack),this.block.find("."+this.classes.selectOrder).on("keyup change chosen:showing_dropdown",(function(e){t.formatChosenList()}));var n=this.block.find("."+this.classes.selectOrder).parent();n.on("click",(function(e){n.hasClass("loaded")||t.getFullOrders((function(n){var o=$(e.target).find("select");t.renderOrders(n.orders,null,!1,!0),o.trigger("mousedown").trigger("chosen:open"),t.portfolio.order_id&&o.val(t.portfolio.order_id).trigger("chosen:updated"),t.formatChosenList()}))})),$(window).load((function(){$('.sortable-card-list[data-type="portfolios"]').length&&(t.initialState=t.getStatePortfolio())}))}var t,n,o;return t=e,n=[{key:"saveCropForImage",value:function(){var e=this;this.portfolio.cover.type===this.COVER_IMAGE_TYPE_UPLOAD&&(this.portfolio.cover.crop=this.getCropperData()),this.portfolio.images=this.portfolio.images.map((function(t){var n=e.isChangedCrop(e.portfolio.cover.crop);if(t.id===e.portfolio.cover.idPortfolioImage&&n){var o=e.getCropperData();return Q(Q({},t),{},{crop:o})}return t})),_.forEach(this.sortableContainer.getPortfolioItems(),(function(t){t.data.id===e.portfolio.cover.idPortfolioImage&&e.isChangedCrop(t.data.crop)&&(t.data.crop=e.getCropperData())}))}},{key:"updateAvailability",value:function(){var e,t=this.isPdfTypePortfolio(),n=this.isVideoTypePortfolio(),o=this.isAudioTypePortfolio();$(".formats-pdf").addClass("d-none");var i=$(".js-field-images .portfolio-upload-modal__upload-image-title"),r=$(".portfolio-upload-modal__image-upload-title"),a=this.block.find(".js-format-help-text-first"),s=this.block.find(".js-format-help-text-second"),u=this.block.find(".js-format-help-text-third");t?(this.block.find(".portfolio-upload-modal__top-description").text(l("topDescriptionPdf","components/portfolio-upload-modal")),i.html(l("imageUploadTitlePdfBtn","components/portfolio-upload-modal")),r.text(l("imageUploadTitlePdf","components/portfolio-upload-modal")),a.text(l("imageUploadFormatInfoPDF","components/portfolio-upload-modal")),s.html(l("imageUploadFormatInfoVideo","components/portfolio-upload-modal",{horizontalMinResolution:this.minVideoResolution.horizontal.text,verticalMinResolution:this.minVideoResolution.vertical.text})),u.text(""),e=l("imageUploadTitlePdfBtn","components/portfolio-upload-modal")):n?(i.html(l("imageUploadVideoBtn","components/portfolio-upload-modal")),r.text(l("imageUploadVideo","components/portfolio-upload-modal")),a.html(l("imageUploadFormatInfoVideo","components/portfolio-upload-modal",{horizontalMinResolution:this.minVideoResolution.horizontal.text,verticalMinResolution:this.minVideoResolution.vertical.text})),s.text(l("imageUploadFormatInfoImage","components/portfolio-upload-modal")),u.text(""),e=l("imageUploadVideoBtn","components/portfolio-upload-modal")):o?(i.html(l("audioUploadButton","components/portfolio-upload-modal")),r.text(l("audioUploadTitle","components/portfolio-upload-modal")),a.text(l("audioUploadFormats","components/portfolio-upload-modal")),s.html(l("imageUploadFormatInfoVideo","components/portfolio-upload-modal",{horizontalMinResolution:this.minVideoResolution.horizontal.text,verticalMinResolution:this.minVideoResolution.vertical.text})),u.text(l("imageUploadFormatInfoImage","components/portfolio-upload-modal")),e=l("audioUploadButton","components/portfolio-upload-modal")):(i.html(l("imageUploadTitleBtn","components/portfolio-upload-modal")),r.text(l("imageUploadTitleNew","components/portfolio-upload-modal")),a.text(l("imageUploadFormatInfoImage","components/portfolio-upload-modal")),s.html(l("imageUploadFormatInfoVideo","components/portfolio-upload-modal",{horizontalMinResolution:this.minVideoResolution.horizontal.text,verticalMinResolution:this.minVideoResolution.vertical.text})),u.text(""),e=l("imageUploadTitleBtn","components/portfolio-upload-modal")),this.sortableContainer.applyMediaAvailability(t,o,e)}},{key:"formatChosenList",value:function(){$(".chosen-results .active-result").html((function(){var e=$(this).html();return/ \(/.test(e)?e=(e=e.replace(" (",'<div class="chosen-multiline">')+"</div>").replace(")",""):e}))}},{key:"initSortableContainer",value:function(){var e=this;this.sortableContainer=new G(this.block.find(".sortable-card-list")[0]),this.sortableContainer.setIsNeedToSendPortfolioGAErrors(this.isNeedToSendAnalyticsErrors),this.sortableContainer.onChangeState=function(){e.updateSaveButton(),e.updateMedia(),e.validateTitle(),e.validateImages()},this.sortableContainer.onSuccess=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.data.type!==e.PORTFOLIO_TYPE_AUDIO){var o=!1;if(n){var i,r=e.block.find("."+e.classes.coverMini).find(e.classes.coverSelected);(r.length>0&&r.find("img").attr("data-id-image-portfolio")==t.data.id||1===e.portfolio.images.length&&null!==(i=e.portfolio.cover.urlBig)&&void 0!==i&&i.includes("video-converting"))&&(o=!0)}e.updateCoverMini(),e.portfolioItem.backendErrors.cover=[],e.validateCountVideos(),(n&&o||(!e.portfolio.cover.urlBig||e.portfolio.cover.urlDefault!==e.portfolio.cover.urlBig&&1===e.portfolio.images.length||!_.find(e.portfolio.images,{urlBig:e.portfolio.cover.urlBig}))&&t.data.type!==e.COVER_IMAGE_TYPE_VIDEO&&("video-cover"!==t.data.type||!e.portfolio.cover.urlBig))&&(e.updateCoverUrl(t.data.urlBig),e.updateCoverIdPortfolioImage(t.data.id),e.updateCoverBlock(),e.portfolio.cover.type=e.COVER_IMAGE_TYPE_IMAGE),e.setCoverMiniSelected(e.portfolio.cover.url)}},this.sortableContainer.onDelete=function(t){e.setIgnoredHashes(t.data||{}),e.updateMedia(),e.setActiveSaveButton(),e.validateCountVideos(),e.selectRandomCover(t.data.urlBig)}}},{key:"getDefaultCoverType",value:function(e){return e===this.COVER_IMAGE_TYPE_DEFAULT_AUDIO?this.COVER_IMAGE_TYPE_DEFAULT_AUDIO:this.COVER_IMAGE_TYPE_UPLOAD}},{key:"initCover",value:function(){var e=this;this.coverUploader=new T({isMiniature:!0}),this.coverUploader.postData={validator:"KworkCover"},this.coverUploader.type="cover",this.coverUploader.url="/temp-image-upload",this.coverUploader.fileName="file",this.coverUploader.maxSize=10485760,this.coverUploader.minImageWidth=this.defaultImageUploadResolution.width,this.coverUploader.minImageHeight=this.defaultImageUploadResolution.height,this.coverUploader.maxImageWidth=6e3,this.coverUploader.maxImageHeight=1e4,this.coverUploader.mimeTypes=["image/jpeg","image/png","image/gif"],this.coverUploader.errors.unknown=l("srcLegacyJsPortfolioUploadPortfolioModalJs1","legacy-translations"),this.coverUploader.onError=function(t){e.hideCoverProgress(),e._unlockSaveBtn(),e.rollbackCover(),e.errorCover(t||e.coverUploader.errors.unknown)},this.coverUploader.onLoad=function(t){e.base64=t,e.updateCoverBlock(e.base64),e.showCoverProgress(),e._lockSaveBtn()},this.coverUploader.onProgress=function(t){e.updateCoverProgress(t)},this.coverUploader.onSuccess=function(t){e.portfolioItem.backendErrors.cover=[],t.type!==e.COVER_IMAGE_TYPE_VIDEO&&(e.portfolio.cover.id=t.id,e.portfolio.cover.hash=t.hash,e.portfolio.cover.urlDefault=e.base64,e.portfolio.cover.urlBig=e.base64,e.portfolio.cover.crop=null,e.portfolio.cover.type=e.getDefaultCoverType(t.type)),e.updateCoverMini(),e.updateCoverUrl(e.base64),e.updateCoverIdPortfolioImage(),e.setCoverMiniSelected(e.base64),e.errorCover(),e.hideCoverProgress(),e._unlockSaveBtn()},this.coverUploader.onFail=function(t){if(t&&e.coverUploader.checkResponse(t)||!e.coverUploader.file){e.hideCoverProgress(),e._unlockSaveBtn();var n="";t&&$.each(t,(function(e,t){n+=t+"<br>"})),e.rollbackCover(),e.errorCover(n)}else setTimeout((function(){e.coverUploader.postData.delay_hash=1,e.coverUploader.fileUploadAjax(e.coverUploader.file),e.coverUploader.file=null}),5e3)},this.block.find("."+this.classes.coverImage).on("zoom","img",(function(t){var n;n=e.coverCropper?e.coverCropper.cropper("getData"):window.portfolioList.modal.coverCropper.cropper("getData"),t.originalEvent.detail.ratio>t.originalEvent.detail.oldRatio&&(n.width<e.MIN_WIDTH_CROP_BOX||n.height<e.MIN_HEIGHT_CROP_BOX)&&t.preventDefault()})),this.block.find("."+this.classes.coverUploadField).on("click",(function(){e.updateCoverCrop(),e.coverUploader.upload()})),this.block.find("."+this.classes.coverBtnUpload).on("click",(function(){e.updateCoverCrop();var t=window.portfolioList.modal.portfolio.id;t&&(e.coverUploader.postData.portfolio_id=t);var n=e.getImagesHashes().concat(e.getCoverHashes());e.portfolio.cover.hash&&n.push(e.portfolio.cover.hash),window.firstPhotoHash&&n.push(window.firstPhotoHash),n.length&&$.each(n,(function(t,n){e.coverUploader.postData["hashes["+t+"]"]=n})),e.coverUploader.postData.kworkLang=window.kworkLang,e.coverUploader.upload()}))}},{key:"checkStateChange",value:function(){var e=this,t=this.getStatePortfolio();if(!t)return!1;var n=this.initialState,o=!1;if(n.length!==t.length)return o=!0;var i={portfolio_type:"photo"};return $.each(n,(function(n,r){var a=t[n];if(e.isFocusGroup26771){var s=_.filter(r.items,i),l=_.filter(a.items,i);(null==s?void 0:s.length)!==(null==l?void 0:l.length)&&(o=!0),_.forEach(r.items,(function(e,t){e!==a.items[t]&&(o=!0)}))}else r.images.length!==a.images.length&&(o=!0),$.each(r.images,(function(e,t){t!==a.images[e]&&(o=!0)})),$.each(r.videos,(function(e,t){t!==a.videos[e]&&(o=!0)})),$.each(r.audios,(function(e,t){t!==a.audios[e]&&(o=!0)}))})),o}},{key:"getStatePortfolio",value:function(){var e=$('.sortable-card-list[data-type="portfolios"]').data("sortableList");return e?e.getData():null}},{key:"rollbackCover",value:function(){this.defaultCoverField(),this.clearExampleCardPreview(),this.portfolio.cover&&this.portfolio.cover.urlBig?(this.updateCoverUrl(this.portfolio.cover.urlBig),this.updateCoverIdPortfolioImage(this.portfolio.cover.idPortfolioImage),this.updateCoverBlock()):this.hideCoverUpload()}},{key:"clearCover",value:function(){this.errorCover(),this.defaultCoverField(),this.clearExampleCardPreview(),this.hideCoverUpload(),this.showCoverUploadGrid(!1)}},{key:"getCoverPortfolioImage",value:function(){var e=this,t=+this.portfolio.cover.idPortfolioImage||-1;return this.portfolio.images.filter((function(t){return t.type!==e.COVER_IMAGE_TYPE_VIDEO||t.type===e.COVER_IMAGE_TYPE_VIDEO&&t.isVideoThumb})).find((function(n){return n.hashValue===e.portfolio.cover.hashValue||+n.id===t}))}},{key:"selectRandomCover",value:function(e){if(this.updateCoverMini(),this.portfolio.cover.url===e&&(this.block.find("."+this.classes.coverImage).find('img[src="'+e+'"]').length&&this.coverMini.length>0||this.coverMini[0]&&this.coverMini[0].url||this.portfolio.cover.urlFromVideo)){var t=this.getCoverPortfolioImage();!t&&this.portfolio.cover.urlFromVideo&&(t={id:0,urlBig:this.portfolio.cover.urlFromVideo});var n=this.getCover(t);this.updateCoverUrl(n.url),n.id&&this.updateCoverIdPortfolioImage(n.id),this.updateCoverBlock(),this.portfolio.cover.type=this.coverMini[0].type}else 0===this.coverMini.length&&(this.clearCover(),this.updateCoverUrl(""),this.updateCoverIdPortfolioImage(0),this.updateCoverHash(),delete this.portfolio.cover.type)}},{key:"defaultCoverField",value:function(){this.destroyCropper(),this.block.find("."+this.classes.coverImage).find("> *:not(.progress)").remove(),this.showCoverField(),this.hideCoverImage()}},{key:"updateCoverBlock",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.showCoverUploadGrid(!0),this.destroyCropper(),this.showCoverUpload(),this.errorCover();var o=this.block.find("."+this.classes.coverImage),i=o.find("img"),r=n||this.portfolio.cover.urlBig;!1===/^data:image\//.test(r)&&(r="".concat(r,"?ver=").concat(+new Date));var a=this.portfolio.cover.crop?this.portfolio.cover.crop:"",s=this.portfolio,l=s.images,u=void 0===l?[]:l,c=s.videos,d=void 0===c?[]:c,f=(null===(e=u.concat(d).find((function(e){return e.id===t.portfolio.cover.idPortfolioImage})))||void 0===e?void 0:e.crop)||"";this.portfolio.cover.idPortfolioImage&&f&&(a=f),this.showCoverImage(),this.hideCoverField(),i.length?i.attr("src",r):o.append(this._cropImgTpl(r)),o.find("img").ready((function(){t.initCropper(a)})),this.setCoverMiniSelected(r)}},{key:"initCropper",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.block.find("."+this.classes.coverImage).find("img");this.cropperConfig.crop=function(){setTimeout((function(){e.saveCropForImage()}))},t?$("<img>").attr("src",n.attr("src")).load((function(o){var i=o.target.width,r=o.target.height;e.cropperConfig.data={x:t.x*i,y:t.y*r,width:t.w*i,height:t.h*r},e.coverCropper=n.cropper(e.cropperConfig)})):(this.cropperConfig.data={},this.coverCropper=n.cropper(this.cropperConfig));var o=_.debounce((function(){e.coverCropper&&(e.cropperBeforeResizeData=e.coverCropper.cropper("getData"))}),300,{leading:!0,trailing:!1}),i=_.debounce((function(){e.coverCropper&&e.coverCropper.cropper("setData",e.cropperBeforeResizeData)}),300,{leading:!1,trailing:!0});$(window).off(".cropperResize").on("resize.cropperResize",(function(){o(),i()}))}},{key:"getImgCropper",value:function(){if(!this.coverCropper)return!1;try{return this.coverCropper.cropper("getCroppedCanvas").toDataURL("image/jpeg")}catch(e){return!1}}},{key:"destroyCropper",value:function(){this.coverCropper&&(this.coverCropper.cropper("destroy"),this.coverCropper="")}},{key:"isChangedCrop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.portfolio.cover.crop,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCropperData(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.002;if(!e&&!t)return!1;if(!e&&t||!t&&e)return!0;var o={},i=Object.entries(e).reduce((function(e,n){var i=J(n,2),r=i[0],a=i[1];return o[r]=[a,t[r]],e[r]=Math.abs(Math.abs(+a||0).toFixed(4)-Math.abs(t[r]||0).toFixed(4)),e}),{});return Object.values(i).filter((function(e){return e>n})).length>0}},{key:"getCropperData",value:function(){if(!this.coverCropper)return!1;try{var e=this.coverCropper.cropper("getData"),t=this.coverCropper.cropper("getImageData"),n={x:e.x/t.naturalWidth,y:e.y/t.naturalHeight,w:e.width/t.naturalWidth,h:e.height/t.naturalHeight};return n.x=n.x>1?0:n.x,n.y=n.y>1?0:n.y,n}catch(e){return{x:null,y:null,w:null,h:null}}}},{key:"errorCover",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.block.find("."+this.classes.coverError).html(t),this.isNeedToSendAnalyticsErrors&&t&&e.sendToAnalytics(t,"cover")}},{key:"showCoverTextLoad",value:function(){this.coverTextNotLoad.hide(),this.coverTextLoad.show()}},{key:"showCoverTextNotLoad",value:function(){this.coverTextNotLoad.show(),this.coverTextLoad.hide()}},{key:"showCoverUpload",value:function(){this.coverUploadGrid.addClass("show-cover-upload")}},{key:"hideCoverUpload",value:function(){this.coverUploadGrid.removeClass("show-cover-upload"),this.hideCoverMini()}},{key:"showCoverImage",value:function(){this.block.find("."+this.classes.coverImage).show()}},{key:"hideCoverImage",value:function(){this.block.find("."+this.classes.coverImage).hide()}},{key:"showCoverMini",value:function(){this.block.find("."+this.classes.coverMini).show(),this.coverUploadGrid.addClass("show-cover-mini")}},{key:"hideCoverMini",value:function(){this.block.find("."+this.classes.coverMini).hide(),this.coverUploadGrid.removeClass("show-cover-mini")}},{key:"showCoverUploadGrid",value:function(e){this.coverUploadGrid.toggleClass(this.classes.coverUploadGridActive,e),$(".".concat(this.classes.coverBtnUpload)).toggle(!e)}},{key:"showCoverField",value:function(){this.block.find("."+this.classes.coverUploadField).show()}},{key:"hideCoverField",value:function(){this.block.find("."+this.classes.coverUploadField).hide()}},{key:"showCoverProgress",value:function(){var e=this.block.find("."+this.classes.coverImage);this.updateCoverProgress(0),e.addClass("loading")}},{key:"hideCoverProgress",value:function(){this.block.find("."+this.classes.coverImage).removeClass("loading")}},{key:"updateCoverProgress",value:function(e){this.block.find("."+this.classes.coverImage).find(".progress div").css({width:e+"%"})}},{key:"clearCoverMini",value:function(){var e=this.block.find("."+this.classes.coverMini);e.hasClass("slick-initialized")&&e.slick("unslick"),e.html("")}},{key:"updateCoverMini",value:function(){var e=this;this.coverMini=[],window.defferScripts.on("slick",(function(){e.clearCoverMini()})),this.portfolio.cover&&this.portfolio.cover.urlDefault&&this.portfolio.cover.type!==this.COVER_IMAGE_TYPE_VIDEO&&this.coverMini.push({id:0,url:this.portfolio.cover.urlDefault,urlBig:this.portfolio.cover.urlDefault,type:this.getDefaultCoverType(this.portfolio.cover.type)}),_.forOwn(this.portfolio.images,(function(t){var n,o;t.type===e.COVER_IMAGE_TYPE_VIDEO&&t.isVideoThumb?(n=t.urlCover||t.urlBig,o=t.urlCoverRetina||t.urlRetina):(n=t.url||t.urlBig,o=t.urlRetina),t.urlBig&&(t.type!==e.COVER_IMAGE_TYPE_VIDEO||t.type===e.COVER_IMAGE_TYPE_VIDEO&&t.isVideoThumb)&&t.type!==e.PORTFOLIO_TYPE_AUDIO&&e.coverMini.push({id:t.id,url:n,urlBig:t.urlBig,urlRetina:o,type:e.COVER_IMAGE_TYPE_IMAGE})})),this.portfolio.cover.urlFromVideo&&this.coverMini.push({id:0,url:this.portfolio.cover.urlFromVideo,type:this.COVER_IMAGE_TYPE_VIDEO}),this.addCoverMini(),window.defferScripts.on("slick",(function(){e.initCoverSlick()})),this.block.find("."+this.classes.coverMini).find(".preview").length>1?this.showCoverMini():this.hideCoverMini()}},{key:"addCoverMini",value:function(){var e=this;$.each(this.coverMini,(function(t,n){e.block.find("."+e.classes.coverMini).append('<div class="preview">\n\t\t\t\t<img src="'.concat(n.url,'" ').concat(n.urlRetina?'srcset="'.concat(n.url," 1x, ").concat(n.urlRetina,' 2x"'):"",' alt="" data-url-big="').concat(n.urlBig,'" data-id-image-portfolio="').concat(n.id,'" ').concat(n.type?' data-type="'.concat(n.type,'"'):"",">\n\t\t\t</div>"))})),this.block.find("."+this.classes.coverMini).find(".preview").on("click",(function(t){var n=$(t.currentTarget).find("[data-url-big]"),o=n.data("url-big");e.updateCoverUrl(o),e.updateCoverPortfolioHash(o),e.updateCoverIdPortfolioImage(n.data("idImagePortfolio")),e.updateCoverBlock(),e.portfolio.cover.type=n.data("type")}))}},{key:"setCoverMiniSelected",value:function(e){var t=this.block.find("."+this.classes.coverMini).find(".preview"),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.indexOf("?ver")>-1?e.substring(0,e.indexOf("?ver")):e};t.removeClass("selected"),t.find("img").filter((function(t,o){return n($(o).data("url-big"))===n(e)})).parents(".preview").addClass("selected")}},{key:"initCoverSlick",value:function(){this.coverMini.length>4&&this.block.find("."+this.classes.coverMini).slick({rows:0,dots:!1,infinite:!0,slidesToShow:4,slidesToScroll:4,focusOnSelect:!0,prevArrow:'<span class="cover-upload-mini__slick cover-upload-mini__slick-prev"><i class="fa fa-angle-left"></i></span>',nextArrow:'<span class="cover-upload-mini__slick cover-upload-mini__slick-next"><i class="fa fa-angle-right"></i></span>'})}},{key:"events",value:function(){var t=this;window.defferScripts.on("vueBootstrap",(function(){window.bus.$on("portfolio-modal-hide",(function(){t._modalHide(),e.stopCheckVideoThumbnailReady(),e.destroyAudio()})),window.bus.$on("portfolio-modal-continue",(function(){t.isModalOpened=!0,$("body").addClass("modal-open"),t.block.fadeIn(300),$(".modal-backdrop").addClass("in")}))})),this.block.on("hide.bs.modal",(function(n){if(t.isModalOpened=!1,t.stopVideos(),t.confirmAtClose){if(t.updateAll(),!1===t.isChangedPortfolio())return void e.destroyAudio();t.setDefaultTitle(),n.preventDefault(),t.block.fadeOut(300),$(".modal-backdrop").removeClass("in"),window.bus.$emit("open-modal-portfolio-upload-confirm")}GTM.deletePendingDataLayer("portfolio-modal")})),this.titleInput.on("input",(function(e,n){n&&!0===n.ignore||(t.updateTitle(),t.validateTitle(),t.setExampleCardName())})),this.block.find("."+this.classes.btnSave).on("click",(function(e){$(e.target).hasClass("js-save-portfolio-for-draft")?t.save(!0):t.save()})),this.block.on("shown.bs.modal",(function(){t.isModalOpened=!0,t.sortableContainer.updateOffsets(),t.sortableContainer.updateAllBlockCoordinates()})),this.block.on("click",".".concat(this.classes.youtubeAdd),(function(){t.youtubeAdd(),$("."+t.classes.fieldYoutube+" input").last().trigger("focus"),t.youtubeAddButtonIsActive=!0})),this.block.on("click","."+this.classes.youtubeRemove,(function(e){$(e.target).closest("."+t.classes.fieldYoutube).find("."+t.classes.youtubeConfirmRemove).addClass("is-open")})),this.block.on("click","."+this.classes.youtubeConfirmOk,(function(e){var n=$(e.target).closest("."+t.classes.fieldYoutube);t.youtubeRemove(n.find("input"))})),this.block.on("click","."+this.classes.youtubeConfirmCancel,(function(e){$(e.target).closest("."+t.classes.fieldYoutube).find("."+t.classes.youtubeConfirmRemove).removeClass("is-open")})),this.block.on("input","."+this.classes.fieldYoutube+" input",(function(e){var n=$(e.currentTarget),o=n.closest(".form-item"),i=o.find(".".concat(t.classes.fieldYoutube)),r=o.find(".portfolio-error");n.removeClass(t.classes.inputClassError),i.removeClass(t.classes.fieldYoutubeErrorClass),r.text(""),t.youtubeEvents($(e.target))})),this.block.on("change","."+this.classes.selectKwork,(function(e){t.kworkChange()})),this.block.on("change","."+this.classes.selectOrder,(function(e){t.orderChange()})),this.block.on("change","."+this.classes.selectParentCategories,(function(e){t.additionalData.attributeType="default",t.portfolio.attributes_ids=[],t.renderCategories(),t.updateCategory(),t.validateCategory(),t.portfolio.attributes_ids=[],t.block.find("."+t.classes.attributes).html(""),t.renderAttributes(),t.renderKworksAndOrders(),t.setExampleCardCategory(),t.selectMediaBlock(),t.validateImages(),t.validateVideos()})),this.block.on("change","."+this.classes.selectCategories,(function(e){t.updateCategory(),t.validateCategory(),t.portfolio.attributes_ids=[],t.block.find("."+t.classes.attributes).html(""),t.renderAttributes(),t.renderKworksAndOrders(),t.setExampleCardCategory(),t.selectMediaBlock()})),this.block.find("."+this.classes.attributes).on("change","input:radio",(function(e){var n=$(e.target).val(),o=$(e.target).closest(".js-field-block"),i=o.data("level");o.children(".js-attribute-section-block").empty(),t.updateAttributes(),t.renderAttributes(i,n),t.renderKworksAndOrders(),t.selectMediaBlock()})),this.block.find("."+this.classes.attributes).on("change","input:checkbox",(function(e){var n=$(e.target).val(),o=$(e.target).closest(".js-field-block"),i=o.data("level");t.updateAttributes(),$(e.target).prop("checked")?t.renderAttributes(i,n):o.children(".js-attribute-section-block").find(".js-field-block[data-parent-id="+n+"]").remove(),t.renderKworksAndOrders()})),this.block.on("click",".".concat(this.classes.cropperPreviewRemove),(function(){var e,n=t.portfolio.cover.idPortfolioImage,o=t.sortableContainer.items.filter((function(e){return e.data&&e.data.id===n}));o&&o.length>0&&o[0].onDelete();var i=null===(e=t.portfolio.cover)||void 0===e?void 0:e.urlDefault;if(i&&0!==n)t.portfolio.cover.idPortfolioImage=0,t.portfolio.cover.url=i,t.portfolio.cover.urlBig=i,t.portfolio.cover.type=t.COVER_IMAGE_TYPE_UPLOAD,t.selectRandomCover(i);else{var r=t.portfolio.cover.type;t.portfolio.cover={},t.selectRandomCover(),_.filter(window.portfolioList.modal.portfolio.images,{type:"audio"}).length>0&&r===t.COVER_IMAGE_TYPE_UPLOAD&&t.setDefaultAudioCover()}})),this.block.on("click",".".concat(this.classes.cropperPreviewEdit),(function(){$(".".concat(t.classes.coverBtnUpload)).eq(0).trigger("click")})),$((function(){PULL_MODULE_ENABLE&&(window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_THUMBNAIL_READY,e.updatePortfolioVideoCover)}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_WRONG_CODEC,e.mediaWrongCodec.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_CONVERT_FAILED,e.videoConvertFailed.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_HAS_DUPLICATE,e.mediaHasDuplicate.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_BROKEN,e.mediaBroken.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_BOUND_EXCEEDED,t.videoExceededMaxBound.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_DURATION_EXCEEDED,t.videoExceededMaxDuration.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_VIDEO_LOW_RESOLUTION,e.videoLowResolution.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_AUDIO_READY,e.setAudioReady.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_AUDIO_HAS_DUPLICATE,e.audioHasDuplicate.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_AUDIO_BROKEN,e.mediaBroken.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_AUDIO_WRONG_CODEC,e.audioWrongCodec.bind(t))}),window.defferJqueryPages),window.defferScripts.on("pullJs",(function(){PullModule.on(PULL_EVENT_PORTFOLIO_AUDIO_DURATION_FAILED,t.audioDurationFailed.bind(t))}),window.defferJqueryPages))}))}},{key:"kworkChange",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.updateKwork(),this.hideError(this.block.find("."+this.classes.kworkError));var n=this.portfolio.kwork_id,o=this.kworksList[+n];if(t&&(n?this.getOrders(n,(function(t){e.renderOrders([],null,t.hasOrders)})):this.getKworks((function(t){e.getKworksIds(t.kworks),e.renderOrders([],null,t.hasOrders)}))),o){var i=null;this.portfolio.category_id=+o.category,$.each(this.additionalData.categories,(function(t,n){if(n.CATID==+e.portfolio.category_id)return i=n.parent,!1})),this.renderParentCategories(i),this.renderCategories(this.portfolio.category_id),this.portfolio.attributes_ids=o.attributesIds,this.block.find("."+this.classes.attributes).html(""),this.renderAttributes(null,void 0,n),this.selectMediaBlock()}}},{key:"orderChange",value:function(){var e=this.block.find("."+this.classes.selectKwork);this.updateOrder();var t="null";+this.portfolio.order_id?t=this.ordersList[+this.portfolio.order_id].PID:this.portfolio.order_id=0,e.val(t),e.trigger("chosen:updated"),this.kworkChange(!1)}},{key:"renderKworksAndOrders",value:function(){var e=this;this.getKworks((function(t){e.getKworksIds(t.kworks),e.renderKworks(t.kworks),e.renderOrders([],null,t.hasOrders)}))}},{key:"updateContent",value:function(){var e=this;this.clearExampleCardPreview(),this.generateExampleCardCnt(),this.block.find(".js-modal-title").text(this.portfolio&&this.portfolio.id?window.l("modalEditTitle","components/portfolio-upload-modal/portfolio-modal"):window.l("modalAddTitle","components/portfolio-upload-modal/portfolio-modal"));var t=window.he?he.decode(this.portfolio.title):this.portfolio.title;this.block.find('input[name="title"]').val(t).trigger("input",{ignore:!0}),this.setExampleCardName(),this.sortableContainer.loadItems(this.portfolio.images),this.block.find("."+this.classes.videos).html(""),this.portfolio.videos.length?(this.$formItemVideos.removeClass("hidden"),$.each(this.portfolio.videos,(function(t,n){e.youtubeAdd(n)}))):this.$formItemVideos.addClass("hidden"),this.defaultCoverField();var n=this.getCoverPortfolioImage(),o=this.getCover(n);if(n?this.showCoverTextNotLoad():this.portfolio.cover&&this.portfolio.cover.type===this.COVER_IMAGE_TYPE_VIDEO?(this.portfolio.cover.urlFromVideo=this.portfolio.cover.urlBig,this.showCoverTextNotLoad()):this.portfolio.cover&&this.portfolio.cover.urlBig?(this.portfolio.cover.urlDefault=this.portfolio.cover.urlBig,this.showCoverTextLoad()):this.portfolio.images.length&&this.showCoverTextNotLoad(),o.url?(this.showCoverUploadGrid(!0),this.updateCoverMini(),this.updateCoverUrl(o.url),this.updateCoverIdPortfolioImage(o.id),this.updateCoverBlock()):(this.showCoverUploadGrid(!1),this.hideCoverUpload()),this.titleInput.attr("placeholder",this.getPortfolioNumber()),this.page==this.PAGE_MY_PORTFOLIO){if(this.block.find("."+this.classes.attributes).html(""),this.fieldKworks.hide(),this.fieldOrders.hide(),this.additionalData&&!this.additionalData.canDeletePortfolio&&this.portfolio.id)this.fixedKworkId=this.portfolio.kwork_id,this.block.find(".js-can-delete-portfolio").hide();else{this.fixedKworkId=null,this.block.find(".js-can-delete-portfolio").show();var i=+this.portfolio.category_id||null,r=null;$.each(this.additionalData.categories,(function(e,t){if(t.CATID==i)return r=t.parent,!1})),this.renderParentCategories(r),this.renderCategories(i),this.portfolio.category_id||this.updateCategory();var a=null;this.portfolio.kwork_id&&(a=this.portfolio.kwork_id),this.renderAttributes(null,null,a),$.isEmptyObject(this.additionalData.kworks)||this.renderKworks(this.additionalData.kworks,this.portfolio.kwork_id),this.setExampleCardCategory()}$.isEmptyObject(this.additionalData.order)?this.renderOrders([],null,this.additionalData.hasOrders):this.renderOrders([this.additionalData.order],this.portfolio.order_id)}}},{key:"edit",value:function(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.portfolioItem=e,this.portfolio=$.extend(!0,{},e.data),this.additionalData=o,this.savedPortfolioData={categoryId:e.data.category_id||0,attributesIds:e.data.attributes_ids||[]},e.data.id&&o.kworks?this.getKworksIds(o.kworks):this.kworksIds=null,this._modalShow(),this.updateContent(),this.selectMediaBlock(),this.validateAll(),this.portfolioItem.blank=!1,this.updateSaveButton(),null===(t=(n=window).pauseMediaPlayers)||void 0===t||t.call(n)}},{key:"setTitleErrors",value:function(e){var t,n="";e&&!0===e?(n=this.titleInput.val(),this.portfolioItem&&"backendErrors"in this.portfolioItem&&(this.portfolioItem.backendErrors.title="")):window.he&&(n=window.he.decode(this.portfolio.title)),n.length>(null===(t=this.titleInput[0])||void 0===t?void 0:t.maxLength)&&this.portfolioItem&&(this.portfolioItem.backendErrors.title=l("srcLegacyJsPortfolioUploadPortfolioModalJs4","legacy-translations"))}},{key:"updateTitle",value:function(){this.setTitleErrors(!0),this.portfolio.title=this.titleInput.val()}},{key:"updateCategory",value:function(){var e=this.block.find("."+this.classes.selectCategories);this.portfolio.kwork_id&&this.portfolio.category_id&&0===e.children("option").length||(this.portfolio.category_id=+e.val(),this.updateResolutionForSelection())}},{key:"updateResolutionForSelection",value:function(){var e=this;this.minResolutionForSelection=this.defaultImageUploadResolution,(this.page===this.PAGE_KWORK?$(".js-attribute-section-block"):this.block.find("."+this.classes.attributes)).find(":checked").each((function(t,n){var o=e.attributeResolutions[+n.value];!o||o.width===e.defaultImageUploadResolution.width&&o.height===e.defaultImageUploadResolution.height||(e.minResolutionForSelection=o)})),this.setMinResolutionForUploaders()}},{key:"validateImagesResolution",value:function(){var e,t,n,o,i=this;this.isResolutionValid=!0;var r=!1,a=null===(e=this.portfolio)||void 0===e||null===(e=e.cover)||void 0===e?void 0:e.idPortfolioImage;if(a){var s=_.find(this.portfolio.images,{id:a});r=(null==s?void 0:s.type)===this.COVER_IMAGE_TYPE_VIDEO}var l=null===(t=this.portfolio)||void 0===t||null===(t=t.cover)||void 0===t?void 0:t.urlBig,u=null!==(n=this.portfolio)&&void 0!==n&&null!==(n=n.cover)&&void 0!==n&&n.idPortfolioImage&&null!==(o=this.portfolio)&&void 0!==o&&o.images?this.portfolio.images.find((function(e){return e.id===i.portfolio.cover.idPortfolioImage})):null;if(l&&this.portfolio.cover.hash&&!r&&!this.portfolio.cover.saved&&this.portfolio.cover.type!==this.COVER_IMAGE_TYPE_VIDEO&&(!u||!u.isFromPdf)){var c=new Image;c.src=l,this.isResolutionValid=this.coverUploader.validateImageResolution(c)}var d=_.filter(d,(function(e){return e.data.type===i.COVER_IMAGE_TYPE_IMAGE}));d&&_.forEach(d,(function(e){var t,n,o,r;if(null!==(t=e.data)&&void 0!==t&&t.urlBig&&e.fileUploader&&(null===(n=e.data)||void 0===n||!n.saved)&&(null===(o=e.data)||void 0===o?void 0:o.type)!==i.PORTFOLIO_TYPE_PDF){var a=new Image;a.src=null===(r=e.data)||void 0===r?void 0:r.urlBig,a.onload=function(){i.isResolutionValid=e.fileUploader.validateImageResolution(a)&&i.isResolutionValid}}}))}},{key:"setMinVideoResolution",value:function(){var e;null===(e=this.sortableContainer)||void 0===e||e.setMinVideoResolution(this.minVideoResolution)}},{key:"setMinResolutionForUploaders",value:function(){this.minResolutionForSelection&&(this.coverUploader&&(this.coverUploader.minImageWidth=this.minResolutionForSelection.width,this.coverUploader.minImageHeight=this.minResolutionForSelection.height),this.sortableContainer&&this.sortableContainer.setImageUploaderMinResolution(this.minResolutionForSelection,this.hasSavedVideoErrors))}},{key:"updateAttributes",value:function(){var e=this;this.portfolio.attributes_ids=[];var t="default";this.block.find("."+this.classes.attributes).find(":checked").each((function(n,o){var i=$(o),r=i.closest(".attribute-list"),a=r.data("multiple-max-count"),s=r.find('input[type="checkbox"]:checked').size();a>0&&(s>=a?r.find('input[type="checkbox"]').not(":checked").prop("disabled",!0).parent().css("opacity","0.5"):r.find('input[type="checkbox"]').not(":checked").prop("disabled",!1).parent().css("opacity","1")),e.portfolio.attributes_ids.push(+i.val());var l=i.data("portfolioType");l&&"default"!==l&&(t=_.includes(e.priorityTypes,l)?l:e.PORTFOLIO_TYPE_PHOTO)})),this.additionalData.attributeType=t}},{key:"updateKwork",value:function(){this.portfolio.kwork_id=null,this.fixedKworkId?this.portfolio.kwork_id=this.fixedKworkId:this.fieldKworks.is(":visible")&&(this.portfolio.kwork_id=+this.block.find("."+this.classes.selectKwork).val()||null)}},{key:"updateOrder",value:function(){this.portfolio.order_id=null,this.fieldOrders.is(":visible")&&(this.portfolio.order_id=+this.block.find("."+this.classes.selectOrder).val()||null)}},{key:"updateCoverCrop",value:function(){this.portfolio&&this.isChangedCrop()&&(this.portfolio.cover.crop=this.getCropperData())}},{key:"updateCoverUrl",value:function(e){this.portfolio.cover.url=e,this.portfolio.cover.urlBig=e}},{key:"updateCoverPortfolioHash",value:function(e){var t=this.portfolio.images.find((function(t){return t.urlBig===e}));t&&(this.portfolio.cover.hash=t.hash)}},{key:"updateCoverIdPortfolioImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.portfolio.cover.idPortfolioImage=e}},{key:"updateCoverHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.portfolio.cover.hash=e}},{key:"updateMedia",value:function(){var e=this,t=[];_.forOwn(this.sortableContainer.getPortfolioItems(),(function(n){n.data.type!==e.PORTFOLIO_TYPE_AUDIO||n.data.peaks||(n.data.peaks=n.getAudioPeaks()),t.push(n.data)})),this.portfolio.images=t,this.updateRequired()}},{key:"updateRequired",value:function(){var e=this,t=$(".".concat(this.classes.requiredMessage));this.isVideoTypePortfolio()?t.toggleClass(this.classes.requiredMessageNoRequired,this.portfolio.images.filter((function(t){return t.type===e.PORTFOLIO_TYPE_VIDEO})).length>0):this.isAudioTypePortfolio()?t.toggleClass(this.classes.requiredMessageNoRequired,this.portfolio.audios.length>0):t.toggleClass(this.classes.requiredMessageNoRequired,this.portfolio.images.filter((function(t){return t.type!==e.PORTFOLIO_TYPE_VIDEO})).length>0),this.setRequired(this.PORTFOLIO_TYPE_PHOTO,!0)}},{key:"updateVideos",value:function(){var e=[];this.block.find("."+this.classes.fieldYoutube).find("input").each((function(t,n){var o=$(n).val().trim();o.length>0&&e.push(o.replace(/&/g,"&amp;"))})),this.portfolio.videos=e}},{key:"setDefaultTitle",value:function(){this.portfolio.title||(this.portfolio.title=this.getPortfolioNumber())}},{key:"getPortfolioNumber",value:function(){return this.portfolio.workNum?l("srcLegacyJsPortfolioUploadPortfolioModalJs5","legacy-translations")+this.portfolio.workNum:!$.isEmptyObject(this.additionalData)&&this.additionalData.workNum?l("srcLegacyJsPortfolioUploadPortfolioModalJs5","legacy-translations")+this.additionalData.workNum:""}},{key:"selectMediaBlock",value:function(){this.portfolioType=this.getPortfolioType(),this.isVideoTypePortfolio()?(this.setRequired(this.PORTFOLIO_TYPE_VIDEO,!0),this.setRequired(this.PORTFOLIO_TYPE_PHOTO,!1),this.setRequired(this.PORTFOLIO_TYPE_AUDIO,!1),this.showBlockVideos()):this.isAudioTypePortfolio()?(this.setRequired(this.PORTFOLIO_TYPE_VIDEO,!1),this.setRequired(this.PORTFOLIO_TYPE_AUDIO,!0),this.setRequired(this.PORTFOLIO_TYPE_PHOTO,!1)):(this.setRequired(this.PORTFOLIO_TYPE_VIDEO,!1),this.setRequired(this.PORTFOLIO_TYPE_PHOTO,!0),this.setRequired(this.PORTFOLIO_TYPE_AUDIO,!1),this.validateVideos(),this.showBlockImages()),this.updateYoutubeCover(),this.updateRequired(),this.updateAvailability()}},{key:"isPdfTypePortfolio",value:function(){return this.getPortfolioType()===this.PORTFOLIO_TYPE_PDF}},{key:"isVideoTypePortfolio",value:function(){return this.getPortfolioType()===this.PORTFOLIO_TYPE_VIDEO}},{key:"isAudioTypePortfolio",value:function(){return this.getPortfolioType()===this.PORTFOLIO_TYPE_AUDIO}},{key:"getPortfolioType",value:function(){var e=+this.portfolio.category_id,t=this.PORTFOLIO_TYPE_PHOTO;return e&&$.each(this.additionalData.categories,(function(n,o){o.CATID==e&&(t=o.portfolio_type)})),this.additionalData.attributeType&&"default"!==this.additionalData.attributeType&&(t=_.includes(this.priorityTypes,this.additionalData.attributeType)?this.additionalData.attributeType:this.PORTFOLIO_TYPE_PHOTO),this.page!=this.PAGE_KWORK&&this.page!=this.PAGE_ORDER||!_.includes(this.priorityTypes,this.portfolioType)||(t=this.portfolioType),t}},{key:"showBlockImages",value:function(){this.block.find("."+this.classes.linkShowImages).removeClass("portfolio-images-videos-link"),this.block.find("."+this.classes.linkShowVideos).addClass("portfolio-images-videos-link"),this.block.find("."+this.classes.linkShowImages).parents("."+this.classes.field).find(".tooltipster").removeClass("hidden");var e=this.fieldImages.find(".draggable-block"),t=e.first().css("transition");e.css("transition","none"),this.sortableContainer.updateOffsets(),this.sortableContainer.updateAllBlockCoordinates(),setTimeout((function(){e.css("transition",t)}),0)}},{key:"showBlockVideos",value:function(){this.block.find("."+this.classes.linkShowImages).addClass("portfolio-images-videos-link"),this.block.find("."+this.classes.linkShowVideos).removeClass("portfolio-images-videos-link"),this.block.find("."+this.classes.linkShowImages).parents("."+this.classes.field).find(".tooltipster").addClass("hidden")}},{key:"concatErrors",value:function(e){var t=[];this.portfolioItem&&"backendErrors"in this.portfolioItem&&e in this.portfolioItem.backendErrors&&(t=t.concat(this.portfolioItem.backendErrors[e])),e in this.frontendErrors&&(t=t.concat(this.frontendErrors[e]));var n=[];return $.each(t,(function(e,t){-1==$.inArray(t,n)&&n.push(t)})),n.join("<br />")}},{key:"showError",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.html(t),(n||t.length>0)&&this.errorFields.push(e)}},{key:"hideError",value:function(e){e.html("");var t=this.errorFields.indexOf(e);-1!==t&&this.errorFields.splice(t,1)}},{key:"validateTitle",value:function(){this.frontendErrors.title=[];var e=this.concatErrors("title");e.length>0?this.titleInput.addClass("input-error-portfolio"):this.titleInput.removeClass("input-error-portfolio"),this.showError(this.block.find("."+this.classes.titleError),e)}},{key:"validateCategory",value:function(){this.frontendErrors.category=[];var e=this.concatErrors("category");this.showError(this.block.find("."+this.classes.categoryError),e),this.portfolioItem&&"backendErrors"in this.portfolioItem&&(this.portfolioItem.backendErrors.category=[])}},{key:"validateAttributes",value:function(){this.frontendErrors.attributes=[];var e=this.concatErrors("attributes");this.showError(this.block.find("."+this.classes.attributesError),e),this.portfolioItem&&"backendErrors"in this.portfolioItem&&(this.portfolioItem.backendErrors.attributes=[])}},{key:"validateKwork",value:function(){this.frontendErrors.kwork=[];var e=this.concatErrors("kwork");this.showError(this.block.find("."+this.classes.kworkError),e)}},{key:"validateCover",value:function(){this.frontendErrors.cover=[],this.portfolioItem.blank||this.page!=this.PAGE_KWORK||this.portfolio.cover.url||this.isVideoTypePortfolio()&&this.portfolio.cover.urlFromVideo&&!this.isAudioTypePortfolio()||this.frontendErrors.cover.push(l("srcLegacyJsPortfolioUploadPortfolioModalJs8","legacy-translations"));var e=this.concatErrors("cover");this.showError(this.block.find("."+this.classes.coverError),e),this.portfolioItem&&"backendErrors"in this.portfolioItem&&(this.portfolioItem.backendErrors.cover=[])}},{key:"checkSavedVideoErrors",value:function(){var e=this,t=[];_.forOwn(this.portfolioItem.data.images,(function(n){n.type===e.PORTFOLIO_TYPE_VIDEO&&n.error&&_.find(e.portfolio.images,{id:n.id})&&(e.frontendErrors.images.push(n.error),t.push(+n.id))})),this.hasSavedVideoErrors=t.length>0,this.hasSavedVideoErrors&&_.forOwn(this.sortableContainer.getPortfolioItems(),(function(e){if(!t.includes(+e.data.id))return!0;e.hasError=!0,e.updateErrorVisuals()}))}},{key:"validateImages",value:function(){var e=this;this.validateImagesFormat(),this.frontendErrors.images=[],this.portfolioItem.blank||this.page!=this.PAGE_KWORK||((this.portfolioType==this.PORTFOLIO_TYPE_PHOTO||this.portfolioType==this.PORTFOLIO_TYPE_PDF)&&this.portfolio.images.filter((function(t){return t.type!==e.PORTFOLIO_TYPE_VIDEO})).length<1?this.frontendErrors.images.push(l("requiredImage","components/portfolio-upload-modal/portfolio-modal")):this.portfolioType==this.PORTFOLIO_TYPE_VIDEO&&this.portfolio.images.filter((function(t){return t.type===e.PORTFOLIO_TYPE_VIDEO})).length<1&&this.portfolio.videos.length<1?this.frontendErrors.images.push(l("requiredVideo","components/portfolio-upload-modal/portfolio-modal")):this.portfolioType===this.PORTFOLIO_TYPE_AUDIO&&this.portfolio.images.filter((function(t){return t.type===e.PORTFOLIO_TYPE_AUDIO})).length<1&&this.portfolio.audios.length<1?this.frontendErrors.images.push(l("requiredAudio","components/portfolio-upload-modal/portfolio-modal")):this.portfolio.images.length<1&&this.portfolio.videos.length<1&&this.portfolio.audios.length<1&&this.frontendErrors.images.push(l("srcLegacyJsPortfolioUploadPortfolioModalJs9","legacy-translations"))),this.checkSavedVideoErrors();var t=this.portfolioItem.backendErrors.image,n=this.portfolioItem.backendErrors.video,o=this.portfolioItem.backendErrors.audio;t&&Object.keys(t).length>0&&("images"in this.portfolioItem.backendErrors||(this.portfolioItem.backendErrors.images=[]),$.each(this.sortableContainer.getPortfolioItems(),(function(n,o){o.hasError=n in t,o.updateErrorVisuals(),o.hasError&&e.portfolioItem.backendErrors.images.push(t[n])}))),n&&Object.keys(n).length>0&&("videos"in this.portfolioItem.backendErrors||(this.portfolioItem.backendErrors.videos=[]),$.each(this.sortableContainer.getPortfolioItems(),(function(t,o){o.hasError=t in n,o.updateErrorVisuals(),o.hasError&&e.portfolioItem.backendErrors.videos.push(n[t])}))),o&&Object.keys(o).length>0&&(this.portfolioItem.backendErrors.audios||(this.portfolioItem.backendErrors.audios=[]),_.forOwn(this.sortableContainer.getPortfolioItems(),(function(t,n){t.hasError=n in o,t.updateErrorVisuals(),t.hasError&&e.portfolioItem.backendErrors.audios.push(o[n])})));var i=this.concatErrors("images")+(this.concatErrors("videos")&&this.concatErrors("images")?"<br />"+this.concatErrors("videos"):this.concatErrors("videos"));(i=(i+="<br>"+this.concatErrors("audios")).replace(/^<br>/,"")).length>0&&this.showBlockImages(),this.showError(this.block.find("."+this.classes.imagesError),i),this.portfolioItem.backendErrors.images=[],this.portfolioItem.backendErrors.image=[],this.portfolioItem.backendErrors.videos=[],this.portfolioItem.backendErrors.video=[],this.portfolioItem.backendErrors.audios=[],this.portfolioItem.backendErrors.audio=[]}},{key:"validateImagesFormat",value:function(){var e=this,t=this.portfolio.images,n=this.sortableContainer.items;this.portfolioType===this.PORTFOLIO_TYPE_PHOTO&&_.forEach(t,(function(t){t.type===e.PORTFOLIO_TYPE_PDF&&t.id&&_.forEach(n,(function(e){var n;t.id===(null===(n=e.data)||void 0===n?void 0:n.id)&&e.onDelete()}))}))}},{key:"getVideoErrors",value:function(){if(this.portfolioType==this.PORTFOLIO_TYPE_VIDEO){var e=this.block.find("."+this.classes.videos).find("."+this.classes.fieldYoutube).find("input.input-error-portfolio");e.length?this.errorFields.push(e):this.frontendErrors.videos=[]}}},{key:"backendValidateVideos",value:function(t){var n=this;this.markYoutubeFieldAsNeedValidation(t);var o=$(t),i=o.closest(".".concat(this.classes.fieldYoutube)),r=o.val().trim(),a=o.parent().find(".portfolio-error");$.ajax({type:"POST",url:"/api/portfolio/youtubelinkvalidate?url="+r,data:{kwork_id:this.portfolio.kwork_id||null,portfolio_id:this.portfolio.id||null},success:function(t){t.success?(o.removeClass(n.classes.inputClassError),a.text(""),i.removeClass(n.classes.fieldYoutubeErrorClass)):(o.addClass(n.classes.inputClassError),a.html(t.data),n.frontendErrors.videos.push(""),i.addClass(n.classes.fieldYoutubeErrorClass),n.isNeedToSendAnalyticsErrors&&e.sendToAnalytics(t.data,n.backEndErrorAnalyticsCode.video))},error:function(e){},complete:function(){n.markYoutubeFieldAsNeedValidation(t,!1),n.getVideoErrors(),n.updateVideos(),n.updateYoutubeCover(!0)}})}},{key:"setVideoError",value:function(e){this.youtubeAddButtonIsActive||$(".".concat(this.classes.youtubeAdd)).trigger("click");var t=this.block.find("."+this.classes.videos).find("."+this.classes.fieldYoutube).children("input:first").parent().find(".portfolio-error"),n=t.closest(".".concat(this.classes.fieldYoutube));t.text(e),this.block.find("."+this.classes.videos).find("."+this.classes.fieldYoutube).children("input:first").addClass("input-error-portfolio"),n.addClass(this.classes.fieldYoutubeErrorClass)}},{key:"validateVideos",value:function(e,t){var n=this,o=0;if(!this.portfolioItem.blank){if(this.block.find("."+this.classes.fieldYoutube+" input").each((function(i,r){var a=$(r);t||n._youtubeValidation(a,i,e),a.val().trim().length>0&&(o+=1)})),t){var i=this.block.find("."+this.classes.fieldYoutube).index(t.parents("."+this.classes.fieldYoutube));this._youtubeValidation(t,i,e)?this.backendValidateVideos(t):this.youtubeRemoveEmptyFiels()}if((this.page==this.PAGE_KWORK||this.PAGE_MY_PORTFOLIO)&&(this.portfolioType==this.PORTFOLIO_TYPE_PHOTO||this.portfolioType==this.PORTFOLIO_TYPE_PDF)&&o<1){var r=this.block.find("."+this.classes.videos).find("."+this.classes.fieldYoutube).filter(":first-child input").parent().find(".portfolio-error"),a=r.closest(".".concat(this.classes.fieldYoutube));r.text(""),this.block.find("."+this.classes.videos).find("."+this.classes.fieldYoutube).filter(":first-child input").removeClass("input-error-portfolio"),a.removeClass(this.classes.fieldYoutubeErrorClass)}}var s=this.portfolioItem.backendErrors.video;s&&Object.keys(s).length>0&&("videos"in this.portfolioItem.backendErrors||(this.portfolioItem.backendErrors.videos=[]),$.each(this.sortableContainer.getPortfolioItems(),(function(e,t){t.hasError=e in s,t.updateErrorVisuals(),n.portfolioItem.backendErrors.videos.push(s[e])})));var l=this.concatErrors("videos");l.length>0&&this.showBlockVideos(),(this.page==this.PAGE_KWORK||this.PAGE_MY_PORTFOLIO)&&this.portfolioType==this.PORTFOLIO_TYPE_VIDEO&&o<1&&""!==l?this.setVideoError(l):this.showError(this.block.find("."+this.classes.videosError),l),this.getVideoErrors(),this.portfolioItem.backendErrors.videos=[],this.portfolioItem.backendErrors.video={}}},{key:"markYoutubeFieldAsNeedValidation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null!=e&&e.length&&(e.data(this.youtubeValidationDataName,t),t?this.addYoutubeCoverPreloader():this.removeYoutubeCoverPreloader())}},{key:"isYoutubeLinkValidationInProgress",value:function(e){return e.length&&e.data(this.youtubeValidationDataName)||!1}},{key:"addYoutubeCoverPreloader",value:function(){if(!(this.portfolio.cover.url&&this.portfolio.cover.url.length>0)){var e=this.block.find(".".concat(this.classes.cover));e.length<=0||e.find(".".concat(this.classes.preloader)).length>0||e.append(this.getPreloader())}}},{key:"removeYoutubeCoverPreloader",value:function(){var e=this.block.find(".".concat(this.classes.cover)).find(".".concat(this.classes.preloader));e.length<=0||e.remove()}},{key:"validateCountVideos",value:function(){var e=this,t=_.filter(this.portfolio.images,(function(t){return t.type==e.PORTFOLIO_TYPE_VIDEO})).length,n=this.block.find("."+this.classes.countVideosError);if(t>this.MAX_YOUTUBE){var o=l("videosCountExceeded","validator/portfolio",[this.MAX_YOUTUBE]);this.hideError(n),this.showError(n,o)}else this.hideError(n)}},{key:"updateAll",value:function(){this.updateTitle(),this.page==this.PAGE_MY_PORTFOLIO&&(this.updateCategory(),this.updateAttributes(),this.updateKwork(),this.updateOrder()),this.updateCoverCrop(),this.updateMedia(),this.updateVideos()}},{key:"moveToError",value:function(){var e=this.errorFields[0];if(e){var t=this.block.scrollTop()+e.offset().top-this.block.offset().top-$(window).height()/2;this.block.animate({scrollTop:t},200)}}},{key:"save",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.errorFields=[],this.updateAll();var n=!1;if(!1===t){this.validateAll(!0);var o=!this.isResolutionValid||!1;if($.each(this.errorFields,(function(t,i){i.length>0&&(!!i.selector.includes(e.classes.fieldYoutube)||(n=!0),o=!0)})),o)return this.portfolioType==this.PORTFOLIO_TYPE_PHOTO?n?this.showBlockImages():this.showBlockVideos():this.portfolioType==this.PORTFOLIO_TYPE_VIDEO&&this.showBlockVideos(),void this.moveToError()}this.errorFields.length||(this.portfolioItem.html.removeClass("error"),this.portfolioItem.html.find(".draggable-block_error").text(""));var i=this.getImgCropper();if(i&&(this.portfolio.cover.url=i),this.portfolio.cover.type!=this.COVER_IMAGE_TYPE_VIDEO&&delete this.portfolio.cover.urlFromVideo,this.page===this.PAGE_KWORK)this.saveSucess(t);else{this.setDefaultTitle(),this._lockSaveBtn(),this.coverUrlBig=this.portfolio.cover.urlBig;var r=this.portfolioItem.getData(this.portfolio);if(this.orderId&&(r.order_id=this.orderId),this.lastPortfolioData=r,delete r.coverUrlBig,this.xhr)return;this.xhr=!0,axios.post("/portfolio/add",{portfolio:r}).then((function(t){var n=t.data;if(n.success){if(1==e.reloadAfterSave)return void(window.location=window.location.href);e.page!=e.PAGE_ORDER||e.portfolio.id?e.page==e.PAGE_MY_PORTFOLIO?window.bus.$emit("update-portfolio-card",n.data.id,!e.portfolio.id):e.saveSucess():window.location=window.location.href,e.xhr=!1}else n.data.forEach((function(t){t.target===e.PORTFOLIO_TYPE_VIDEO&&e.portfolio.images.forEach((function(e,n){e.id===t.id&&(t.position=n)}))})),e.portfolioItem.applyErrors(n.data),e.validateAll(),e.moveToError(),e._unlockSaveBtn()})).catch((function(){})).finally((function(){e.xhr=!1}))}this.additionalData&&this.additionalData.workNum&&(this.additionalData.workNum+=1)}},{key:"saveSucess",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.portfolio.draftHash||this.portfolio.id||(this.portfolio.draftHash=Date.now()),!(!0!==t||this.portfolio.title||this.portfolio.images.length||this.portfolio.videos.length||this.portfolio.audios.length||null!==this.portfolio.cover.hash))return!1;!0!==t||this.portfolio.title?this.setDefaultTitle():this.portfolio.title=this.titleInput.attr("placeholder"),$.extend(this.portfolioItem.data,this.portfolio),this.onSave(this.additionalData),!1===t&&this.portfolioOnModalSave(),this.checkStateChange()&&e.emitEvent(t)}},{key:"afterImageSave",value:function(){var e=$(".js-portfolios-block"),t=$(".js-kwork-save-field-error"),n=$(".js-save-kwork");e.removeClass("kwork-save-step__field-value_error"),t.html("").addClass("hidden"),n.removeClass(this.classes.btnDisabled).prop("disabled",!1),window.bus.$emit("close-modal-portfolio-upload-confirm"),$("."+this.classes.deletePreviewBtn).removeClass("disabled pointer-en")}},{key:"portfolioOnModalSave",value:function(){$.extend(this.portfolioItem.data,this.portfolio),this.onSave(this.additionalData),this.confirmAtClose=!1,this._modalHide(),this._unlockSaveBtn(),this.destroyCropper(),e.destroyAudio()}},{key:"youtubeAdd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=this.block.find("."+this.classes.videos).find("input:focus");if(n.length){var o=n.val();if(0==Youtube.isUrl(o))return}var i=this.block.find("."+this.classes.videos),r=this.block.find("."+this.classes.videos).find("."+this.classes.fieldYoutube),a=i.find("."+this.classes.fieldYoutube+" input").filter((function(){return""===this.value}));if(r.length>=this.MAX_YOUTUBE||a.length>0)return!1;var s,u='<span class="'.concat(this.classes.youtubeRemove,' wrap-input-action__remove"></span>');u='\n\t\t\t<span class="'.concat(this.classes.youtubeRemove,'">\n\t\t\t\t<svg class="youtube-field__remove" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#a5a5a5">\n\t\t\t\t\t<path d="M14.4 6V4.4H9.6V6H4.8v1.6h14.4V6h-4.8zm-8 2.4V18c0 .882.718 1.6 1.6 1.6h8c.882 0 1.6-.718 1.6-1.6V8.4H6.4zm4.8 8.001H9.6v-4.8h1.6v4.8zm3.2 0h-1.6v-4.8h1.6v4.8z"/>\n\t\t\t\t</svg>\n\t\t\t</span>'),s='\n\t\t\t<div class="youtube-field__confirm-remove '.concat(this.classes.youtubeConfirmRemove,'">\n\t\t\t\t<div class="youtube-field__confirm-controls">\n\t\t\t\t\t<span class="').concat(this.classes.youtubeConfirmOk,'">\n\t\t\t\t\t\t').concat(l("youtubeConfirmOk","components/portfolio-upload-modal"),'\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="').concat(this.classes.youtubeConfirmCancel,'">\n\t\t\t\t\t\t').concat(l("youtubeConfirmCancel","components/portfolio-upload-modal"),"\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t");var c='\n\t\t\t<div class="wrap-input-action youtube-field '.concat("youtube-field--only-delete",'">\n\t\t\t\t<input\n\t\t\t\t\tclass="js-field-input input-style w100p text-counter-init keep-placeholder"\n\t\t\t\t\ttype="text"\n\t\t\t\t\tname="title"\n\t\t\t\t\tplaceholder="').concat(l("srcLegacyJsPortfolioUploadPortfolioModalJs11","legacy-translations"),'"\n\t\t\t\t\tvalue="').concat(e,'"\n\t\t\t\t\t').concat("disabled","\n\t\t\t\t/>\n\t\t\t\t").concat(u,'\n\t\t\t\t<div class="form-item__after-input">\n\t\t\t\t\t<div class="form-item__error portfolio-error"></div>\n\t\t\t\t</div>\n\t\t\t\t').concat(s,"\n\t\t\t</div>\n\t\t"),d=$("<div/>",{class:"form-item",html:c});i.append(d),this.youtubeVisibleRemoveBtn(),t&&t(d)}},{key:"youtubeRemove",value:function(e,t){var n=$(e),o=n.closest(".form-item").index();if(n.closest(".".concat(this.classes.fieldYoutube)),!e)return!1;this.block.find("."+this.classes.fieldYoutube).length>1?n.closest(".form-item").remove():(n.closest(".form-item").remove(),this.$formItemVideos.addClass("hidden")),this.youtubeVisibleRemoveBtn(),this.isVideoTypePortfolio()&&0===o&&this.portfolio.cover.type&&this.portfolio.cover.type===this.COVER_IMAGE_TYPE_VIDEO&&(this.updateYoutubeCover(),this.selectRandomCover())}},{key:"youtubeEvents",value:function(e){this.youtubeRemoveDuplicate(e),this.youtubeVisibleRemoveBtn(),this.validateVideos(null,e),this.isYoutubeLinkValidationInProgress(e)||this.updateYoutubeCover(!0)}},{key:"updateYoutubeCover",value:function(e){if(!(e&&this.portfolio.cover.url&&this.portfolio.cover.url.length>0))if(delete this.portfolio.cover.urlFromVideo,this.isVideoTypePortfolio()&&!this.frontendErrors.videos.length){var t=this.block.find("."+this.classes.fieldYoutube+" input");if(1!==t.length||t.val()){var n=$(t[0]).val();if(n){var o=Youtube.thumb(n,"max");this.setYoutubeThumb(o)}}else this.selectRandomCover()}else this.selectRandomCover()}},{key:"setYoutubeThumb",value:function(e){var t=this,n=new Image;n.onload=function(){var e;n.width>t.MIN_WIDTH_CROP_BOX&&n.height>t.MIN_HEIGHT_CROP_BOX&&(e=n.src),t.showYoutubeCoverThumb(e)},n.src=e}},{key:"showYoutubeCoverThumb",value:function(e){if(e){this.portfolio.cover.urlFromVideo=e,this.portfolioItem.backendErrors.cover=[],this.updateCoverMini();var t=this.getCoverPortfolioImage(),n=this.getCover(t);n.url&&this.portfolio.cover.urlDefault?(this.updateCoverUrl(n.url),this.updateCoverIdPortfolioImage(n.id)):this.portfolio.cover.urlDefault||(this.updateCoverUrl(e),this.updateCoverIdPortfolioImage(),this.portfolio.cover.type=this.COVER_IMAGE_TYPE_VIDEO),this.updateCoverBlock()}else this.selectRandomCover()}},{key:"youtubeRemoveDuplicate",value:function(e){if(!e||0===e.length)return!1;var t=e.val(),n=[];if(""===t)return null;this.block.find("."+this.classes.fieldYoutube+" input").not(e).each((function(e,t){var o=$(t).val();""!==o&&n.push(o)})),n.length>0&&$.inArray(t,n)>=0&&this.youtubeRemove(e,window.l("srcLegacyJsPortfolioUploadPortfolioModalJs12","legacy-translations"))}},{key:"youtubeVisibleRemoveBtn",value:function(){var e=this;$("."+this.classes.videos+" ."+this.classes.fieldYoutube+" input").each((function(t,n){var o=$(n).val(),i=$(n).closest("."+e.classes.fieldYoutube).find("."+e.classes.youtubeRemove);o.length<=0?i.hide():i.show()}))}},{key:"youtubeRemoveEmptyFiels",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];$(".".concat(this.classes.fieldYoutube)).not(".".concat(this.classes.fieldYoutubeErrorClass)).find("input").each((function(t,n){var o=$(n),i=o.val(),r=o.closest("."+e.classes.fieldYoutube),a=o.is(":focus");0!=i.length||a||r.closest(".form-item").remove()})),t||this.youtubeAdd()}},{key:"_youtubeValidation",value:function(t,n,o){if(t){if(window.Youtube){var i=$(t),r=i.val().trim(),a=i.closest(".".concat(this.classes.fieldYoutube)),s=i.parent().find(".portfolio-error");if(!r.length>0)return i.removeClass(this.classes.inputClassError),a.removeClass(this.classes.fieldYoutubeErrorClass),this.frontendErrors.videos=[],void s.text("");var u=!1;if(this.checkVideoUrl&&(u=!this.checkVideoUrl(r,n)),n in(this.portfolioItem.backendErrors.video||{}))return i.addClass(this.classes.inputClassError),a.addClass(this.classes.fieldYoutubeErrorClass),s.html(this.portfolioItem.backendErrors.video[n]),!1;if(u){i.addClass(this.classes.inputClassError),a.addClass(this.classes.fieldYoutubeErrorClass);var c=l("videoAlreadyUploaded","components/portfolio-upload-modal/portfolio-modal");return s.text(c),c&&this.isNeedToSendAnalyticsErrors&&e.sendToAnalytics(c,"videos[]"),!1}if(r&&!Youtube.isUrl(r)){i.addClass(this.classes.inputClassError),a.addClass(this.classes.fieldYoutubeErrorClass);var d=l("wrongYoutubeLink","components/portfolio-upload-modal/portfolio-modal");return s.text(d),d&&this.isNeedToSendAnalyticsErrors&&e.sendToAnalytics(d,"videos[]"),!1}return!0}console.error('Youtube is not defined ("youtube-thumbnail.js")')}}},{key:"validateAll",value:function(e){this.validateTitle(),this.validateCategory(),this.validateAttributes(),this.validateKwork(),this.validateCover(),this.validateCountVideos(),this.validateImages(),this.validateImagesResolution(),this.validateVideos(e),this.sendErrorsToAnalytics()}},{key:"updateSaveButton",value:function(){this.setActiveSaveButton(),this.isFormValid()?this._unlockSaveBtn():this._lockSaveBtn()}},{key:"isFormValid",value:function(){return!!this.sortableContainer.isReady()}},{key:"_lockSaveBtn",value:function(){this.isPortfolioLoading=!0,this.block.find("."+this.classes.btnSave).attr("disabled","disabled").addClass(this.classes.btnLoading)}},{key:"_unlockSaveBtn",value:function(){this.isPortfolioLoading=!1,this.block.find("."+this.classes.btnSave).removeAttr("disabled").removeClass(this.classes.btnLoading)}},{key:"setActiveSaveButton",value:function(){if(this.portfolio){var e=this.portfolio,t=e.images,n=e.audios,o=e.videos,i=this.block.find("."+this.classes.btnSave);null!=t&&t.length||null!=n&&n.length||null!=o&&o.length?i.removeClass(this.classes.btnDisabled):i.addClass(this.classes.btnDisabled)}}},{key:"_modalShow",value:function(){var e=this;this.confirmAtClose=!0,this.setTitleErrors(),this.setIgnoredHashes(),this.page!==this.PAGE_ORDER?this.block.modal("show"):window.defferScripts.on("bootstrapModal",(function(){e.block.modal("show")}))}},{key:"_modalHide",value:function(){this.confirmAtClose=!1,this.block.modal("hide"),this.destroyCropper(),this.clearCover(),this.youtubeAddButtonIsActive=!1}},{key:"_cropImgTpl",value:function(){return'<div class="cover-image__cropper"><img src="'.concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",'"></div>')}},{key:"renderParentCategories",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.block.find("."+this.classes.selectParentCategories);t.html("");var n=this.additionalData.parentCategories;t.append('<option disabled="" selected="selected" hidden="">'+l("srcLegacyJsPortfolioUploadPortfolioModalJs15","legacy-translations")+"</option>");var o=d.getSortedCategories(n);$.each(o,(function(e,n){t.append('<option value="'+n.CATID+'" data-parent="'+n.parent+'">'+n.name+"</option>")})),this.selectOption(t,e),t.trigger("chosen:updated")}},{key:"renderCategories",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.block.find("."+this.classes.selectCategories),n=this.block.find("."+this.classes.selectParentCategories).find("option:selected").val();t.html("");var o=this.additionalData.categories,i=0,r=d.getSortedCategories(o);$.each(r,(function(e,o){if(o.parent!=n)return!0;t.append('<option value="'+o.CATID+'" data-parent="'+o.parent+'">'+o.name+"</option>"),i++})),i<1?t.parent().addClass("empty-list"):t.parent().removeClass("empty-list"),this.selectOption(t,e),t.trigger("chosen:updated")}},{key:"renderKworks",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=this.block.find("."+this.classes.selectKwork);o.html('<option value="null">'+l("srcLegacyJsPortfolioUploadPortfolioModalJs16","legacy-translations")+"</option>"),$.isEmptyObject(t)?this.fieldKworks.hide():(this.fieldKworks.show(),$.each(t,(function(t,n){e.kworksList[+n.PID]=n,o.append('<option value="'+n.PID+'">'+n.gtitle+"</option>")}))),this.selectOption(o,n),o.trigger("chosen:updated")}},{key:"renderOrders",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.block.find("."+this.classes.selectOrder);o?this.block.find("."+this.classes.selectOrder).parent().addClass("loaded"):this.block.find("."+this.classes.selectOrder).parent().removeClass("loaded"),r.html('<option value="null">'+l("srcLegacyJsPortfolioUploadPortfolioModalJs16","legacy-translations")+"</option>"),this.additionalData.order&&this.additionalData.order.OID&&(!this.portfolio.kwork_id||+this.additionalData.order.PID==+this.portfolio.kwork_id)&&+this.savedPortfolioData.categoryId==+this.portfolio.category_id&&(_.isEmpty(this.savedPortfolioData.attributesIds)||_.isEmpty(this.portfolio.attributes_ids)||this.savedPortfolioData.attributesIds.some((function(t){return e.portfolio.attributes_ids.includes(t)})))&&t.unshift(this.additionalData.order),$.isEmptyObject(t)||(i=!0),i?(this.fieldOrders.show(),$.isEmptyObject(t)||$.each(t,(function(t,n){e.ordersList[+n.OID]=n;var o=new Date(n.date_done).toLocaleString()||null;o=o?l("srcLegacyJsPortfolioUploadPortfolioModalJs17","legacy-translations")+" "+o:"";var i=n.payerUsername||null;i=i?l("srcLegacyJsPortfolioUploadPortfolioModalJs18","legacy-translations")+" "+i:"";var a=o&&i?"; ":"",s=n.kwork_title+" ("+o+a+i+")";r.append('<option value="'+n.OID+'">'+s+"</option>")}))):this.fieldOrders.hide(),this.selectOption(r,n),r.trigger("chosen:updated")}},{key:"selectOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||!t)return!1;e.find("option").prop("selected",!1).removeAttr("selected"),e.find('option[value="'+t+'"]').prop("selected",!0)}},{key:"getOrders",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,o=this.block.find("."+this.classes.selectOrder);this.startSelectLoader(o),this.getOrdersXhr&&this.getOrdersXhr.abort(),this.getOrdersXhr=$.ajax({type:"POST",url:"/portfolio/load_form_orders",data:{kworkId:t},dataType:"json",success:function(t){e.stopSelectLoader(o),t.success&&n&&n(t.data)}})}},{key:"getFullOrders",value:function(e){var t=this;if(!_.isNull(this.kworksIds)&&_.isEmpty(this.kworksIds)){var n=this.block.find("."+this.classes.selectOrder);return n.parent().addClass("loaded"),void setTimeout((function(){n.trigger("mousedown").trigger("chosen:open")}))}var o,i=this.block.find("."+this.classes.selectOrder);o=!this.portfolio.category_id&&_.isEmpty(this.portfolio.attributes_ids)?"":_.isNull(this.kworksIds)?this.portfolio.kwork_id:this.kworksIds.join(","),this.startSelectLoader(i),this.getOrdersXhr&&this.getOrdersXhr.abort(),this.getOrdersXhr=$.ajax({type:"POST",url:"/portfolio/load_form_orders_full",data:{kworkIds:o},dataType:"json",success:function(n){t.stopSelectLoader(i),n.success&&e&&e(n.data)}})}},{key:"getKworksIds",value:function(e){var t=this;this.kworksIds=[],_.forEach(e,(function(e){t.kworksIds.push(e.PID)}))}},{key:"getKworks",value:function(e){var t=this;this.kworksOrdersXhr&&this.kworksOrdersXhr.abort();var n=this.portfolio.category_id,o=this.portfolio.attributes_ids;if(this.portfolio.kwork_id=null,!n)return!1;var i=this.block.find("."+this.classes.selectKwork),r=this.block.find("."+this.classes.selectOrder);this.startSelectLoader(i),this.startSelectLoader(r),this.kworksOrdersXhr=$.ajax({type:"POST",url:"/portfolio/load_form_kworks",data:{categoryId:n,attributesId:o},dataType:"json",success:function(n){t.stopSelectLoader(i),t.stopSelectLoader(r),n.success&&e&&e(n.data)}})}},{key:"startSelectLoader",value:function(e){this.stopSelectLoader(e);var t=e.parent();t.addClass("empty-list"),t.append('<div class="js-loader select-loader"><img src="'+Utils.cdnImageUrl("/ajax-loader.gif")+'">'+l("srcLegacyJsPortfolioUploadPortfolioModalJs19","legacy-translations")+"</div>")}},{key:"stopSelectLoader",value:function(e){var t=e.parent();t.find(".js-loader").remove(),t.removeClass("empty-list")}},{key:"requestAttributes",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.length<=0||this.block.find("."+this.classes.attributes+" .kwork-save-step__field-label").length>=1)t();else{var i,r=this.block.find("."+this.classes.attributes+" input");if($(r).each((function(){var t=parseInt($(this).attr("value")),n=e.indexOf(t);if(-1!=n)return i=e.splice(n,1)[0],!1})),i||(i=e.shift()),i||this.portfolio.category_id){var a={categoryId:this.portfolio.category_id,lang:window.lang,onlyPortfolioAllowed:1,groupByCustom:!0};o&&(a.kworkId=o),i&&(a.attributeId=i),this.attrXhr&&this.attrXhr.abort(),this.attrXhr=$.ajax({type:"GET",url:"/api/attribute/loadclassification",data:a,dataType:"json",success:function(r){if(r.success){var a=n.block.find("."+n.classes.attributes+" input[value="+i+"]").closest(".js-field-block").children(".js-attribute-section-block");a.length||(a=n.block.find("."+n.classes.attributes)),a.append(r.html),r.attributeResolutions&&(n.attributeResolutions=Q(Q({},n.attributeResolutions),r.attributeResolutions)),n.updateResolutionForSelection(),n.requestAttributes(e,t,o)}}})}else t()}}},{key:"renderAttributes",value:function(e,t){var n,o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.attributesLoaded=!1,n=e?[this.portfolio.attributes_ids[this.portfolio.attributes_ids.length-1]]:[null].concat(this.portfolio.attributes_ids||[]),t&&(n=[t]),this.requestAttributes(n,(function(){o.block.find(".js-field-block").each((function(e,t){$(t).attr("data-level",e+1)})),o.portfolio.attributes_ids&&$.each(o.portfolio.attributes_ids,(function(e,t){o.block.find('.js-field-block input[value="'+t+'"]').prop("checked",!0)})),o.updateAttributes(),o.validateAttributes(),o.attributesLoaded=!0,o.updateResolutionForSelection(),null!==o.portfolio.id&&o.selectMediaBlock()}),i)}},{key:"getObjectChanges",value:function(e,t){var n=this,o={},i=["isVideoThumb","peaks"],r=function(r){if(i.indexOf(r)>-1)return 0;if("attributes_ids"===r&&e.kwork_id)return e[r]&&t[r]&&!_.isEmpty(e[r])&&!_.isEmpty(t[r])&&-1===_.findIndex(e[r],(function(e){return e==t[r][0]}))&&(o[r]=t[r]),0;if(!e||e[r]!=t[r])if(_.isArray(t[r])&&_.isArray(e[r])&&t[r].length!==e[r].length&&(o[r]=t[r]),"object"==Z(t[r])){var a=e||{},s=n.getObjectChanges(a[r],t[r]);$.isEmptyObject(s)||(o[r]=s)}else o[r]=t[r]};for(var a in t)r(a);return o}},{key:"sortInArray",value:function(e){var t={};for(var n in e){var o=Object.prototype.toString.call(e[n]);t[n]="[object Array]"===o?e[n].sort():"[object Object]"===o?this.sortInArray(e[n]):e[n]}return t}},{key:"isChangedPortfolio",value:function(){var e=Q({},this.portfolioItem.data),t=Q({},this.portfolio),n=this.isChangedCrop(t.cover.crop,e.cover.crop);e.coverHash=e.cover.hash,t.coverHash=t.cover.hash,delete e.cover,delete t.cover,_.forEach(e.images,(function(e){return delete e.crop})),_.forEach(t.images,(function(e){return delete e.crop})),void 0===e.category_id&&0===t.category_id&&(e.category_id=0),void 0===e.attributes_ids&&t.attributes_ids===[]&&(e.attributes_ids=[]),e=this.sortInArray(e),t=this.sortInArray(t);var o=this.getObjectChanges(e,t);return!($.isEmptyObject(o)&&!n)}},{key:"allowableRangeForCrop",value:function(e,t){if(e&&t)return Math.abs(e-t)<1e-4}},{key:"setCropPortfolioCard",value:function(e){var t=this;if(this.lastPortfolioData||this.lastPortfolioData.cover.crop||window.portfolioCover||this.lastPortfolioData.id===window.portfolioCover.portfolioId){var n=$('.portfolio-list-collage .portfolio-card-collage[data-id="'+e+'"]'),o=n.find("img:not(.audio-wavesurfer__icon)"),i=this.lastPortfolioData.cover.crop,r=n.find(".thumbnail-img-link");n.addClass(this.classes.cropped),o.parent().html('<img src="'.concat(this.coverUrlBig,'">')),(o=n.find("img:not(.audio-wavesurfer__icon)")).length>0?o.one("load",(function(){o.css({transform:"",width:"",height:""});var e=r.width(),n=o.get(0).naturalWidth,a=o.get(0).naturalHeight,s=e/(i.w*n),l=s*n,u=s*a,c=i.x*l,d=i.y*u;o.css({transform:"translateX(-".concat(c,"px) translateY(-").concat(d,"px)"),width:"".concat(l,"px"),height:"".concat(u,"px")}),t.lastPortfolioData=null,t.saveSucess()})):this.saveSucess()}}},{key:"generateExampleCardCnt",value:function(){var e=Math.round(99.5+900*Math.random()),t=Math.round(.6*e),n=Math.round(.25*t);this.exampleCardCntViews.text(e),this.exampleCardCntLikes.text(t),this.exampleCardCntComments.text(n)}},{key:"setExampleCardName",value:function(){var e=this.exampleCardName.data("isEmpty"),t=this.portfolio.title||this.getPortfolioNumber()||e;this.exampleCardName.html(t)}},{key:"setExampleCardCategory",value:function(){var e=this.exampleCardCategory.data("isEmpty"),t=+this.portfolio.category_id,n="";t&&$.each(this.additionalData.categories,(function(e,o){o.CATID==t&&(n=o.name)})),this.exampleCardCategory.text(n||e)}},{key:"clearExampleCardPreview",value:function(){this.exampleCardThumbnail.find("img").remove(),this.exampleCardThumbnail.css({overflow:"hidden"})}},{key:"getCover",value:function(e){var t=this,n={};if(this.portfolio.cover&&e&&this.portfolio.cover.hash===e.hash)n.url=e.urlBig,n.id=e.id;else if(this.portfolio.cover&&_.includes([this.COVER_IMAGE_TYPE_VIDEO,this.COVER_IMAGE_TYPE_UPLOAD,this.COVER_IMAGE_TYPE_DEFAULT_AUDIO],this.portfolio.cover.type))n.url=this.portfolio.cover.urlBig;else if(this.portfolio.images.length)if(e)n.url=e.urlBig,n.id=e.id;else{var o=this.portfolio.images.filter((function(e){return e.type!==t.COVER_IMAGE_TYPE_VIDEO||e.type===t.COVER_IMAGE_TYPE_VIDEO&&e.isVideoThumb}))[0];o&&(n.url=o.urlBig,n.id=o.id)}else e&&(n.url=e.urlBig,n.id=e.id);return n}},{key:"setRequired",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e===this.PORTFOLIO_TYPE_PHOTO&&(this.isVideoTypePortfolio()||this.isAudioTypePortfolio())||n;t=this.isVideoTypePortfolio()?window.l("requiredVideo","components/portfolio-upload-modal/portfolio-modal"):this.isAudioTypePortfolio()?window.l("requiredAudio","components/portfolio-upload-modal/portfolio-modal"):window.l("requiredImage","components/portfolio-upload-modal/portfolio-modal"),$(".".concat(this.classes.requiredMessage)).filter('[data-type="'.concat(e,'"]')).toggleClass(this.classes.requiredMessageIsRequired,o).html(t)}},{key:"sendErrorsToAnalytics",value:function(){var t=this;this.isNeedToSendAnalyticsErrors&&_.forEach(this.frontendErrors,(function(n,o){!_.isArray(n)||n.length<=0||e.sendToAnalytics(n.join(", "),t.getFrontAnalyticsFieldCode(o))}))}},{key:"getFrontAnalyticsFieldCode",value:function(e){return this.frontendErrorAnalyticsCodeAlias[e]||e}},{key:"setDefaultAudioCover",value:function(){this.coverUploader.onLoad(Utils.cdnImageUrl("/audio-cover.jpg")),this.coverUploader.onSuccess({type:this.COVER_IMAGE_TYPE_DEFAULT_AUDIO})}},{key:"videoExceededMaxBound",value:function(t){var n=e.abortMediaUploadOnError(t);n&&n.fileUploader.onError(e.getMediaErrorHtml(l("videoMaxBoundExceeded","validator/portfolio",{width:this.MAX_VIDEO_WIDTH,height:this.MAX_VIDEO_HEIGHT})))}},{key:"videoExceededMaxDuration",value:function(t){var n=e.abortMediaUploadOnError(t);n&&n.fileUploader.onError(e.getMediaErrorHtml(l("videoMaxDurationExceeded","validator/portfolio",[this.MAX_VIDEO_DURATION])))}},{key:"audioDurationFailed",value:function(t){var n=e.abortMediaUploadOnError(t);n&&n.fileUploader.onError(e.getMediaErrorHtml(l("audioDurationFailed","validator/portfolio",{minDuration:this.minAudioDuration,maxDuration:this.maxAudioDuration})))}},{key:"stopVideos",value:function(){$(".js-portfolio-modal-video:visible").each((function(e,t){t.pause(),t.currentTime=0}))}},{key:"getPreloader",value:function(){var e=document.createElement("div");return e.classList.add(this.classes.preloader),e}},{key:"setIgnoredHashes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_.isEmpty(e))return this.ignoredHashes=[],void this.sortableContainer.updateIgnoredHashes();var t=this.getCoverPortfolioImage(),n=this.getCover(t);e.hash&&(this.ignoredHashes=_.union(this.ignoredHashes,[e.hash])),n&&+n.id==+e.id&&this.portfolio.cover.hash&&(this.ignoredHashes=_.union(this.ignoredHashes,[this.portfolio.cover.hash])),this.sortableContainer.updateIgnoredHashes(this.ignoredHashes)}},{key:"getMediaHashValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[],o=0;if(this.page===this.PAGE_KWORK){var i=window.portfolioList;null!=i&&i.items&&_.forEach(i.items,(function(i){var r;null!==(r=i.data)&&void 0!==r&&r.images&&_.forEach(i.data.images,(function(i){t&&i.type===e.PORTFOLIO_TYPE_AUDIO&&i.hashValue?(n["hashValues[".concat(o,"][audioHash]")]=i.hashValue,o+=1):!t&&i.isVideoThumb&&i.hashValue&&(n["hashValues[".concat(o,"][audioHash]")]=i.audioHash||null,n["hashValues[".concat(o,"][videoHash]")]=i.hashValue,o+=1)}))}))}var r=this.sortableContainer;return r.items&&_.forEach(r.items,(function(i){var r,a;t&&(null===(r=i.data)||void 0===r?void 0:r.type)===e.PORTFOLIO_TYPE_AUDIO&&i.data.hashValue&&!_.findKey(n,{audioHash:i.data.hashValue})?(n["hashValues[".concat(o,"][audioHash]")]=i.data.hashValue,o+=1):!t&&null!==(a=i.data)&&void 0!==a&&a.isVideoThumb&&i.data.hashValue&&!_.findKey(n,{audioHash:i.data.audioHash,videoHash:i.data.hashValue})&&(n["hashValues[".concat(o,"][audioHash]")]=i.data.audioHash||null,n["hashValues[".concat(o,"][videoHash]")]=i.data.hashValue,o+=1)})),n}}],o=[{key:"getImageFormatHelpText",value:function(){var e=[l("imageUploadFormatFirst","components/portfolio-upload-modal"),l("imageUploadFormatSecond","components/portfolio-upload-modal"),l("imageUploadFormatThird","components/portfolio-upload-modal"),l("imageUploadFormatFourth","components/portfolio-upload-modal"),l("videoUploadFormatFirst","components/portfolio-upload-modal")];return'<ul class="portfolio-upload-modal__format-list kw-list kw-list--unordered"><li>'.concat(e.join("</li><li>"),"</li></ul>")}},{key:"getImageFormatPdfHelpText",value:function(){var e=[l("imageUploadFormatPdfFirst","components/portfolio-upload-modal"),l("imageUploadFormatPdfSecond","components/portfolio-upload-modal"),l("imageUploadFormatPdfThird","components/portfolio-upload-modal"),l("imageUploadFormatPdfFourth","components/portfolio-upload-modal"),l("videoUploadFormatFirst","components/portfolio-upload-modal")];return'<ul class="portfolio-upload-modal__format-list kw-list kw-list--unordered"><li>'.concat(e.join("</li><li>"),"</li></ul>")}},{key:"destroyAudio",value:function(){window.bus.$emit("destroy-audio-wavesurfer","addPortfolio")}},{key:"emitEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];$(document).trigger("portfolio-change",e)}},{key:"sendToAnalytics",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o={event:"ErrorMessage",eventCategory:"ErrorMessage",eventAction:"Создание Кворка - Портфолио",eventLabel:e+(t?" | "+t:"")};if(!n&&window.pendingDataLayer&&window.pendingDataLayer["portfolio-modal"]&&(GTM.pushDataLayer(window.pendingDataLayer["portfolio-modal"]),GTM.deletePendingDataLayer("portfolio-modal")),n){var i=Q({},o);i.eventLabel="<Кнопка> ".concat(o.eventLabel),GTM.pushPendingDataLayer("portfolio-modal",i)}o.eventLabel=(n?"":"<Кнопка> ")+o.eventLabel,GTM.pushDataLayer(o)}},{key:"updatePortfolioVideoCover",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null!=e&&e.urlThumbnail&&window.portfolioList.modal.portfolio){var n=_.find(window.portfolioList.modal.portfolio.images,(function(t){return t.id===e.id}));if(n){if(!window.portfolioList.modal.isModalOpened)return;n.urlBig=e.urlThumbnail,n.isVideoThumb=!0,n.hashValue=e.hashValue||"",n.audioHash=e.audioHash||"";var o={data:{id:e.id,url:e.urlThumbnail,urlBig:e.urlThumbnail,type:"video-cover"}};window.portfolioList.modal.sortableContainer.onSuccess(o,!!e.forceCoverUpdate);var i=_.find(window.portfolioList.modal.sortableContainer.items,(function(t){return t.data.id===e.id}));if(i.toLastStepProgress(),!t)return;e.convertStart?i.updateVideoData(e.urlThumbnail):e.forceCoverUpdate&&e.url&&i.updateVideoData(e.urlThumbnail,e.url)}}}},{key:"setAudioReady",value:function(e){if(window.portfolioList.modal.portfolio){var t=_.find(window.portfolioList.modal.portfolio.images,{id:e.id});if(t){t.hashValue=e.audioHash||"";var n=_.find(window.portfolioList.modal.sortableContainer.items,(function(t){return t.data.id===e.id}));n&&n.stopProgress(),_.filter(window.portfolioList.modal.portfolio.images,{type:"audio"}).length<2&&!_.find(window.portfolioList.modal.coverMini,{type:window.portfolioList.modal.COVER_IMAGE_TYPE_UPLOAD})&&window.portfolioList.modal.setDefaultAudioCover()}}}},{key:"abortMediaUploadOnError",value:function(e){var t;if(!e.id||!window.portfolioList.modal.sortableContainer)return null;var n=_.find(window.portfolioList.modal.sortableContainer.items,(function(t){var n;return(null===(n=t.data)||void 0===n?void 0:n.id)===e.id}));return n?(null!==(t=n.data)&&void 0!==t&&t.url&&(n.data.url=null),n.fileUploader&&(n.fileUploader.file=null,n.fileUploader.abort()),n):null}},{key:"audioWrongCodec",value:function(t){e.mediaWrongCodec(t,!0)}},{key:"mediaWrongCodec",value:function(t){var n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.abortMediaUploadOnError(t);i&&t.codec&&(n=o?l("wrongAudioCodec","validator/portfolio",{codec:t.codec}):l("wrongVideoCodec","validator/portfolio",{codec:t.codec}),i.fileUploader.onError(e.getMediaErrorHtml(n)))}},{key:"videoConvertFailed",value:function(t){var n=e.abortMediaUploadOnError(t);n&&n.fileUploader.onError(e.getMediaErrorHtml(l("convertFailed","validator/portfolio")))}},{key:"audioHasDuplicate",value:function(t){e.mediaHasDuplicate(t,!0)}},{key:"mediaHasDuplicate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.abortMediaUploadOnError(t);if(o){var i,r,a,s,u,c="",d="",f="";n?(i=t.duplicate_audio_kwork_id,r=t.duplicate_audio_kwork_title,a=t.duplicate_audio_kwork_url,s=t.duplicate_audio_portfolio_id,u=t.duplicate_audio_portfolio_title):(i=t.duplicate_video_kwork_id,r=t.duplicate_video_kwork_title,a=t.duplicate_video_kwork_url,s=t.duplicate_video_portfolio_id,u=t.duplicate_video_portfolio_title),i&&t.kwork_draft_id&&+i==+t.kwork_draft_id?f=n?l("audioAlreadyExistsInKworkPortfolio","validator/portfolio"):l("videoAlreadyExistsInKworkPortfolio","validator/portfolio"):i?(c=r.trim(),d=window.base_url+a,f=n?l("audioAlreadyExistsInKworkPortfolio","validator/portfolio"):l("videoAlreadyExistsInKworkPortfolio","validator/portfolio")):s&&(c=u.trim(),d="".concat(window.base_url,"/portfolio/").concat(s),f=n?l("audioAlreadyExistsInPortfolio","validator/portfolio"):l("videoAlreadyExistsInPortfolio","validator/portfolio")),f||(f=n?l("audioAlreadyExistsInPortfolio","validator/portfolio"):l("videoAlreadyExistsInPortfolio","validator/portfolio")),o.fileUploader.onError(e.getMediaErrorHtml(f,c,d))}}},{key:"videoLowResolution",value:function(t){var n=e.abortMediaUploadOnError(t);n&&n.fileUploader.onError(e.getMediaErrorHtml(n.fileUploader.getVideoResolutionError(t)))}},{key:"mediaBroken",value:function(t){var n=e.abortMediaUploadOnError(t);n&&n.fileUploader.onError(e.getMediaErrorHtml(l("mediaBroken","validator/portfolio")))}},{key:"getMediaErrorHtml",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.stopCheckVideoThumbnailReady(),n&&o?'<div><span class="mr3">'.concat(t,'</span>(<a target="_blank" href="').concat(o,'">').concat(n,"</a>).</div>"):'<div><span class="mr3">'.concat(t,"</span></div>")}},{key:"stopCheckVideoThumbnailReady",value:function(){window.portfolioList.modal.sortableContainer&&_.forOwn(window.portfolioList.modal.sortableContainer.items,(function(e){var t;null===(t=e.fileUploader)||void 0===t||t.clearCheckVideoThumbnailReadyInterval()}))}}],n&&te(t.prototype,n),o&&te(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ie(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ie=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,o){var r=t&&t.prototype instanceof g?t:g,a=Object.create(r.prototype),s=new A(o||[]);return i(a,"_invoke",{value:P(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var f="suspendedStart",h="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(x([])));C&&C!==n&&o.call(C,a)&&(w=C);var E=b.prototype=g.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(i,r,a,s){var l=d(e[i],e,r);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==ae(c)&&o.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var r;i(this,"_invoke",{value:function(e,o){function i(){return new t((function(t,i){n(e,o,t,i)}))}return r=r?r.then(i,i):i()}})}function P(t,n,o){var i=f;return function(r,a){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===r)throw a;return{value:e,done:!0}}for(o.method=r,o.arg=a;;){var s=o.delegate;if(s){var l=_(s,o);if(l){if(l===v)continue;return l}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(i===f)throw i=m,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=p;var u=d(t,n,o);if("normal"===u.type){if(i=o.done?m:h,u.arg===v)continue;return{value:u.arg,done:o.done}}"throw"===u.type&&(i=m,o.method="throw",o.arg=u.arg)}}}function _(t,n){var o=n.method,i=t.iterator[o];if(i===e)return n.delegate=null,"throw"===o&&t.iterator.return&&(n.method="return",n.arg=e,_(t,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),v;var r=d(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var a=r.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}throw new TypeError(ae(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},O(T.prototype),u(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,o,i,r){void 0===r&&(r=Promise);var a=new T(c(e,n,o,i),r);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(E),u(E,l,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},t.values=x,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(o,i){return s.type="throw",s.arg=t,n.next=o,i&&(n.method="next",n.arg=e),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={iterator:x(t),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=e),v}},t}function re(e,t,n,o,i,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,i)}function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function se(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,le(o.key),o)}}function le(e){var t=function(e,t){if("object"!=ae(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ae(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ae(t)?t:String(t)}var ue=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.classes={loadingSpinner:".loading-spinner",portfolioCardCollage:".portfolio-card-collage"},this.body=$("body"),this.ModalLoader=new a,this.modal=new oe,this.modal.onSave=function(){t.savePortfolio(t.modal.portfolioItem)},this.modal.getImagesHashes=function(e){return t.getImagesHashes(e)},this.modal.getCoverHashes=function(e){return t.getCoverHashes(e)},this.modal.checkCoverHash=function(e){return t.checkCoverHash(e)},this.modal.checkImageHash=function(e){return t.checkImageHash(e)},this.modal.checkVideoUrl=function(e,n){return t.checkVideoUrl(e,n)},this.events()}var t,n,o;return t=e,n=[{key:"events",value:function(){var e=this;this.body.on("click",".portfolio-card .js-edit-portfolio, .portfolio-card-collage .js-edit-portfolio",(function(t){var n=$(t.target).closest(".portfolio-card, .portfolio-card-collage").data("id");e.openPortfolioModal(n,!0)})),this.body.on("click",".portfolio-card .js-delete-portfolio, .portfolio-card-collage .js-delete-portfolio",(function(t){var n=$(t.target).closest(".portfolio-card, .portfolio-card-collage").data("id"),o=$(t.currentTarget).data("name"),i=$(t.currentTarget).data("url");e.deletePortfolioCardModal(n,o,i)})),this.body.on("click",".portfolio-large .js-edit-portfolio",(function(t){window.portfolioCard.close(),setTimeout((function(){var n=$(t.target).closest(".portfolio-large").data("portfolioId");e.openPortfolioModal(n)}),100)})),this.body.on("click",".js-new-portfolio",(function(){window.defferScripts.on("chosenJquery",(function(){window.defferScripts.on("heJs",(function(){e.openPortfolioModal(null)}),window.isPageProfile)}),window.isPageProfile)})),$((function(){window.defferScripts.on("chosenJquery",(function(){window.defferScripts.on("heJs",(function(){$(e.classes.portfolioCardCollage).find(e.classes.loadingSpinner).removeClass("loading-spinner")}),window.isPageProfile)}),window.isPageProfile)}))}},{key:"openPortfolioModal",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.getPortfolioData(e,(function(i){n&&(window.portfolioCover={portfolioId:e,cover:i.portfolio.cover}),_.isEmpty(o)||i.portfolio||(i.portfolio={},i.portfolio.category_id=o.categoryId,i.portfolio.attributes_ids=[],i.portfolio.attributes_ids.push(o.classificationId),i.portfolio.isOnlyCategory=!0);var r=new U(i.portfolio);t.modal.edit(r,i.additional)}))}},{key:"deletePortfolioCardModal",value:function(e,t,n){var o=this;this.startLoader(),$.ajax({type:"GET",url:"/portfolio/can_delete/"+e,dataType:"json",success:function(o){if(o.success){var i={cancel:l("btnCancel","legacy-js/ajax-portfolio-modal"),delete:l("btnRemove","legacy-js/ajax-portfolio-modal"),header:l("header","legacy-js/ajax-portfolio-modal")};if(o.data.canDeletePortfolio)i.description=l("desc","legacy-js/ajax-portfolio-modal"),i.portfolioId=e;else{var r="",a=o.data.neededPortfolioCount?o.data.neededPortfolioCount:"";a&&(a=" ("+l("srcLegacyJsPortfolioUploadAjaxPortfolioModalJs1","legacy-translations")+" "+a+")"),r+=t&&""!=t?"<p>"+l("srcLegacyJsPortfolioUploadAjaxPortfolioModalJs4","legacy-translations",[t])+a+".</p>":"<p>"+l("srcLegacyJsPortfolioUploadAjaxPortfolioModalJs2","legacy-translations")+a+".</p>",r+='<p class="mt10">'+l("srcLegacyJsPortfolioUploadAjaxPortfolioModalJs5","legacy-translations",[n])+"</p>",i.canDelete=!1,i.description=r}window.bus.$emit("open-modal-portfolio-delete-confirm",{data:i})}},complete:function(){o.stopLoader()}})}},{key:"checkCoverHash",value:function(e){var t=this.getCoverHashes();return-1==$.inArray(e,t)}},{key:"checkImageHash",value:function(e){var t=this.getImagesHashes();return-1==$.inArray(e,t)}},{key:"checkVideoUrl",value:function(e,t){var n=this.getVideoUrls(t);return-1==$.inArray(e,n)}},{key:"getCoverHashes",value:function(){return this.modal.additionalData.coverHashes||[]}},{key:"getImagesHashes",value:function(){var e=[];return $.each(this.modal.portfolio.images,(function(t,n){e.push(n.hash)})),e=e.concat(this.modal.additionalData.imagesHashes||[])}},{key:"getVideoUrls",value:function(e){var t=[];return $.each(this.modal.portfolio.videos,(function(n,o){if(n==e)return!0;t.push(o)})),t=t.concat(this.modal.additionalData.anotherVideos||[])}},{key:"savePortfolio",value:function(){return this.modal.coverHashes}},{key:"getPortfolioData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;this.startLoader(),$.ajax({cache:!1,dataType:"json",async:!0,crossDomain:!0,url:"/portfolio/get_popup",type:"POST",headers:{accept:"application/json","Access-Control-Allow-Origin":"*"},data:{portfolioId:t},success:function(t){e.stopLoader(),t.success&&n&&n(t.data)}})}},{key:"startLoader",value:function(){this.ModalLoader.add()}},{key:"stopLoader",value:function(){this.ModalLoader.remove()}}],n&&se(t.prototype,n),o&&se(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function de(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,fe(o.key),o)}}function fe(e){var t=function(e,t){if("object"!=ce(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ce(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ce(t)?t:String(t)}$((function(){setTimeout((function(){var e;(e=ie().mark((function e(){return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,defferScripts.wait("localization");case 2:window.portfolioList=new ue;case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,i){var r=e.apply(t,n);function a(e){re(r,o,i,a,s,"next",e)}function s(e){re(r,o,i,a,s,"throw",e)}a(void 0)}))})()}))}));var pe,me=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t||null,this.$el=$(t)||null,this.type="contenteditable",this.oldValue="",this.events=[],this.config={min:this.$el.data("text-counter-min")||0,max:this.$el.data("text-counter-max")||0,bottomOffset:this.$el.data("text-counter-bottom-offset")||15,outputPattern:this.$el.data("text-counter-output-pattern")||!1,outputEl:this.$el.data("text-counter-output-element")||null,isTrumboWYG:this.$el.data("text-counter-trumbo")||!1,contentStorage:this.$el.data("text-counter-storage")||this.$el.siblings(".js-content-storage")||null,trim:this.$el.data("text-counter-trim")||!1},this.config.isTrumboWYG||this.prepareCounter()}var t,n,o;return t=e,n=[{key:"init",value:function(e,t){this.el=e||null,this.$el=$(e)||null,this.config={min:t.data("text-counter-min")||0,max:t.data("text-counter-max")||0,bottomOffset:t.data("text-counter-bottom-offset")||15,outputPattern:this.$el.data("text-counter-output-pattern")||!1,outputEl:t.data("text-counter-output-element")||null,isTrumboWYG:t.data("text-counter-trumbo")||!1,contentStorage:t.data("text-counter-storage")||t.siblings(".js-content-storage")||null,trim:t.data("text-counter-trim")||!1},this.prepareCounter()}},{key:"on",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}},{key:"off",value:function(e,t){this.events[e]=this.events[e].filter((function(e){return t!==e}))}},{key:"emit",value:function(e,t){var n=this.events[e];n&&n.forEach((function(e){return e.call(null,t)}))}},{key:"prepareCounter",value:function(){this.$counter=$(this.config.outputEl),this.hasError=!1,this.hasWarning=!1,this.el&&this.el.type&&(this.type=this.el.type),this.setLength(),this.checkMax(),this.printHint(),this.initListeners(),this.checkEmpty(),this.$el.addClass("text-counter-init")}},{key:"getText",value:function(){var e=this.$el.get(0).value;return""!==e||"contenteditable"===this.type||this.config.isTrumboWYG?e&&""!==e||this.config.isTrumboWYG?this.config.isTrumboWYG&&(e=this.$el.html()):e=this.$el.html():e="",e||""}},{key:"getTextLength",value:function(){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(t=t.replace(/<\/?[^>]*>/gi,"")),t=t.replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),this.config.trim&&(t=t.trim()),e||(t=t.replace(/\s\s+/g," ")),t=t.replace(/(\s+)?\n/g,""),window.emojiReplacements?emojiReplacements.fancyCount(t):t.length||0}},{key:"checkMin",value:function(){var e=this.config.min>0&&this.length<this.config.min;return e&&(this.hasError=!0,this.hasWarning=!0),e}},{key:"checkMax",value:function(){var e=this.config.max>0&&this.length>this.config.max,t=this.config.max>0&&this.length>this.config.max;return e&&(this.hasError=!0),t&&(this.hasWarning=!0),e}},{key:"updateContentStorage",value:function(e){var t=$(this.config.contentStorage),n=this.getText(),o=n,i=o!=n,r=t.val(),a=this.config.max,s=this.getTextLength(o,!0,!0),l=s-this.getTextLength(r,!0,!0),u=null;if(a&&s>a&&l>=0||i&&(u=o),u){var c=this.getTextLength(n,!0,!0)-this.getTextLength(u,!0,!0),d=window.saveSelection(this.$el.get(0));d.end-=c,d.start-=c,this.$el.html(u),window.restoreSelection(this.$el.get(0),d)}this.setValue(),this.oldValue=this.el.innerHTML;var f=this.$el.data("after-input");f&&f.bind(this.el)(t,o),t.trigger("updated",{$contentStorage:t,editor:this.$el,string:o,editorLength:s})}},{key:"checkEmpty",value:function(){var e=$(this.config.contentStorage);e.length>0&&0===e.val().replace(/\s/g,"").length&&(this.el.innerHTML="")}},{key:"clearSpaces",value:function(){var e=this.getText();return e=e.replace(/( |&nbsp;)( |&nbsp;)+/g," ")}},{key:"setValue",value:function(){var e=$(this.config.contentStorage),t=this.el.innerText;t=(t=(t=t.replace(/(\n\n)\n+/gm,"$1")).replace(/\n$/,"")).replace(/\n\n/gm,"\n"),e.val(t),this.setLength()}},{key:"setLength",value:function(){var e=$(this.config.contentStorage),t=this.config.isTrumboWYG||"contenteditable"===this.type,n=t&&e.length>0?e.val():this.getText();this.length=this.getTextLength(n,t,!0)}},{key:"changeState",value:function(e){this.$el.data("textCounterHasError",!e),this.$counter.toggleClass("has-error",!e);var t=this.$el.data("textCounterChangeStateCallback");t&&t(e)}},{key:"printHint",value:function(){var e="";this.config.max>0&&this.config.min>0?e=l("srcLegacyJsTextCounterTextCounterJs1","legacy-translations",[this.length,this.config.max,this.config.min]):this.config.max>0?e=l("srcLegacyJsTextCounterTextCounterJs2","legacy-translations",[this.length,this.config.max]):this.config.min>0&&(e=l("srcLegacyJsTextCounterTextCounterJs3","legacy-translations",[this.length,this.config.min]));var t=this.$counter.siblings(".js-target-error");this.hasWarning?(this.$el.addClass("textarea-style--error"),this.changeState(!1)):(t.length&&t.text()||this.$el.removeClass("textarea-style--error"),this.changeState(!0)),this.config.outputPattern&&(e=this.config.outputPattern.replace("[min]",this.length).replace("[max]",this.config.max)),this.$counter.html(e)}},{key:"initListeners",value:function(){var e=/Trident/.test(navigator.userAgent)?"textinput":"input";this.$el.on(e,_.debounce(this.handleInput,20).bind(this)),this.$el.on("blur",_.debounce(this.handleBlur,20).bind(this)),this.$el.on("paste",_.debounce(this.handlePaste,20).bind(this))}},{key:"handleInput",value:function(e){this.hasError=!1,this.hasWarning=!1,this.config.isTrumboWYG||"contenteditable"!==this.type||this.updateContentStorage(e),this.setLength(),this.checkMax(),this.printHint(),this.emit("counter:input",this)}},{key:"handleBlur",value:function(e){var t=$(this.config.contentStorage);this.config.isTrumboWYG||"contenteditable"!==this.type||this.setValue(),this.hasError=!1,this.hasWarning=!1,this.setLength(),this.checkMin(),this.checkMax(),this.printHint(),this.checkEmpty(),"contenteditable"===this.type&&t.is("input")?this.scrollToStart():void 0!==$.browser&&$.browser.mozilla&&this.$el.is("input")&&(this.el.selectionStart=0,this.el.selectionEnd=0)}},{key:"handlePaste",value:function(e){var t=this,n=""===this.oldValue||"<br>"===this.oldValue;if("contenteditable"===this.type){var o=window.saveSelection(this.el),i=o.start===o.end&&o.end===this.el.textContent.length;(n||i)&&setTimeout((function(){t.scrollToEnd()}),20)}}},{key:"scrollToEnd",value:function(){this.el.scrollTop=this.el.scrollHeight,this.el.scrollLeft=this.el.scrollWidth}},{key:"scrollToStart",value:function(){this.el.scrollTop=0,this.el.scrollLeft=0}}],n&&de(t.prototype,n),o&&de(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function ge(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ge=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,o){var r=t&&t.prototype instanceof g?t:g,a=Object.create(r.prototype),s=new A(o||[]);return i(a,"_invoke",{value:P(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var f="suspendedStart",h="suspendedYield",p="executing",m="completed",v={};function g(){}function y(){}function b(){}var w={};u(w,a,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(x([])));C&&C!==n&&o.call(C,a)&&(w=C);var E=b.prototype=g.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(i,r,a,s){var l=d(e[i],e,r);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==ve(c)&&o.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var r;i(this,"_invoke",{value:function(e,o){function i(){return new t((function(t,i){n(e,o,t,i)}))}return r=r?r.then(i,i):i()}})}function P(t,n,o){var i=f;return function(r,a){if(i===p)throw new Error("Generator is already running");if(i===m){if("throw"===r)throw a;return{value:e,done:!0}}for(o.method=r,o.arg=a;;){var s=o.delegate;if(s){var l=_(s,o);if(l){if(l===v)continue;return l}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(i===f)throw i=m,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i=p;var u=d(t,n,o);if("normal"===u.type){if(i=o.done?m:h,u.arg===v)continue;return{value:u.arg,done:o.done}}"throw"===u.type&&(i=m,o.method="throw",o.arg=u.arg)}}}function _(t,n){var o=n.method,i=t.iterator[o];if(i===e)return n.delegate=null,"throw"===o&&t.iterator.return&&(n.method="return",n.arg=e,_(t,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),v;var r=d(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var a=r.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}throw new TypeError(ve(t)+" is not iterable")}return y.prototype=b,i(E,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},O(T.prototype),u(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,o,i,r){void 0===r&&(r=Promise);var a=new T(c(e,n,o,i),r);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(E),u(E,l,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},t.values=x,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(o,i){return s.type="throw",s.arg=t,n.next=o,i&&(n.method="next",n.arg=e),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={iterator:x(t),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=e),v}},t}function ye(e,t,n,o,i,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,i)}var be=function(){var e;(e=ge().mark((function e(){var t;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.defferScripts.wait("localization");case 2:(t=$("[data-text-counter]")).length>0&&_.forEach(t,(function(e){var t=new me(e);$(e).get(0).textCounter=t}));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,i){var r=e.apply(t,n);function a(e){ye(r,o,i,a,s,"next",e)}function s(e){ye(r,o,i,a,s,"throw",e)}a(void 0)}))})()};null!==(pe=window.stateData)&&void 0!==pe&&pe.isVuePage?window.bus.$on("app-ready",be):$(be)}()}();